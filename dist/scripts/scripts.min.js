function geoJelly(t,e,n){for(var i=document.querySelector(n),r=i.getContext("2d"),a=i.width,o=i.height,s=1,c=20,l=100,h=c*c,u=l*l,d=2*Math.PI,p=50,f=new Array(p),m=0;m<p;++m)f[m]={x:a*Math.random(),y0:o*Math.random(),v:.1*(Math.random()-.5)};timer.timer(function(n){r.clearRect(0,0,a,o);for(var i=0;i<p;++i)for(var c=i+1;c<p;++c){var m=f[i],g=f[c],v=m.x-g.x,y=m.y-g.y,x=v*v+y*y;x<u&&(r.globalAlpha=x>h?(u-x)/(u-h):1,r.beginPath(),r.moveTo(m.x,m.y),r.lineTo(g.x,g.y),r.stroke(),r.strokeStyle=t)}r.globalAlpha=1;for(var i=0;i<p;++i){var b=f[i];b.y=b.y0+.2*n*b.v,b.y>o+l?(b.x=a*Math.random(),b.y0-=o+2*l):b.y<-l&&(b.x=a*Math.random(),b.y0+=o+2*l),r.beginPath(),r.arc(b.x,b.y,s,0,d),r.fill(),r.fillStyle=e}})}function nextFrame(t,e,n){return n>=e.length?void activateMenuItems():void t.animate(e[n].animation,e[n].dur,nextFrame.bind(null,t,e,n+1))}function lastFrame(t,e,n){n<0||t.animate(e[n].animation,e[n].dur,lastFrame.bind(null,t,e,n-1))}function menuInProgress(t){t?document.body.classList.add("animating"):document.body.classList.remove("animating")}function activateMenuItems(){document.body.classList.toggle("activated")}function onMenuPress(t){t.preventDefault(),t=t?t:window.e;var e="home";t.target.hash?e=t.target.hash.slice(1):(console.log(this.getAttribute("data-target")||this.getAttribute("href")),e=this.getAttribute("data-target")||this.getAttribute("href"),window.open(e,"_blank")),"home"!=e?(document.body.classList="loaded activated active-"+e,"portfolio"==e?(document.addEventListener("mousemove",onDocumentMouseMove,!1),window.addEventListener("resize",onWindowResize,!1),activePage="portfolio"):(activePage="home",document.getElementById("homepage-scroller").classList=e)):(document.body.classList="loaded activated",activePage="home",document.getElementById("homepage-scroller").classList="homepage-0"),menuInProgress(!0),lastFrame(poly,frames,5),activateMenuItems(),setTimeout(function(){menuInProgress(!1)},10*dur)}function gotoHomepage(t){3==homepage?blimpContainer.classList.add("hidden"):blimpContainer.classList.remove("hidden"),console.log(t),homepageScroller.classList="homepage-"+t,setHomepageControls(t)}function setHomepageControls(t){console.log("n: "+t),0==t?(homepagePrev.classList.add("hidden"),homepageNext.classList.remove("hidden")):t==homepageCount-1?(homepagePrev.classList.remove("hidden"),homepageNext.classList.add("hidden")):(homepagePrev.classList.remove("hidden"),homepageNext.classList.remove("hidden"))}function initBlimp(){blimpContainer=document.createElement("div"),blimpContainer.id="blimpContainer",document.body.appendChild(blimpContainer),cameraBlimp=new THREE.PerspectiveCamera(45,500/window.innerHeight,1,2e3),cameraBlimp.position.z=100,cameraBlimp.lookAt(0,0,0),sceneBlimp=new THREE.Scene;var t=new THREE.AmbientLight(6710886);sceneBlimp.add(t);var e=new THREE.DirectionalLight(16764108,.5);e.position.set(50,200,100),sceneBlimp.add(e);var n=new THREE.DirectionalLight(16772829,.3);n.position.set(-100,-100,100),sceneBlimp.add(n),rendererBlimp=new THREE.WebGLRenderer({alpha:!0}),rendererBlimp.setPixelRatio(window.devicePixelRatio),rendererBlimp.setSize(500,window.innerHeight),rendererBlimp.setClearColor(16777215,0),blimpContainer.appendChild(rendererBlimp.domElement),document.addEventListener("mousemove",onBlimpMouseMove,!1),window.addEventListener("resize",onWindowResize,!1);var i=new THREE.LineBasicMaterial({linewidth:2,color:11184810});root=new THREE.Group;var r=.1;root.position.y=a,sceneBlimp.add(root);var a=0,o=new THREE.OBJLoader,s=new THREE.TextureLoader;s.load("assets/images/gg_logo_grey.png",function(t){t.offset.set(-.1,-1.8),t.repeat.set(1.5,3.5);var e=new THREE.MeshPhongMaterial({shading:THREE.SmoothShading,shininess:20,specular:new THREE.Color(16777215),color:new THREE.Color(16777215),map:t,lightMapIntensity:.9,depthWrite:!1,transparent:!0});o.load("./assets/blimp.obj",function(t){t.traverse(function(t){t instanceof THREE.Mesh&&(t.material=e,t.geometry.applyMatrix((new THREE.Matrix4).makeTranslation(30,0,0)),root.add(t),e.needsUpdate=!0)});var n=new THREE.Vector3(30,40,0),o=new THREE.Vector3(0,(-500),0),s=new THREE.Geometry;s.vertices.push(n),s.vertices.push(o);var c=new THREE.Line(s,i);root.add(c),root.position.y=a,root.scale.set(r,r,r),root.rotation.y=Math.PI/2},function(){animateBlimp()})})}function onWindowResize(){windowHalfX=window.innerWidth/2,windowHalfY=window.innerHeight/2,cameraBlimp.aspect=500/window.innerHeight,cameraBlimp.updateProjectionMatrix(),rendererBlimp.setSize(500,window.innerHeight)}function onBlimpMouseMove(t){blimpMouseX=(t.clientX-windowHalfX)/50,blimpMouseY=(t.clientY-windowHalfY)/50}function floatAway(){animation="floatAway",now=.001*new Date(Date.now()),document.querySelector("header").classList.add("activated")}function animateBlimp(){"home"==activePage&&(requestAnimationFrame(animateBlimp),renderBlimp())}function renderBlimp(){var t=.001*Date.now();cameraBlimp.position.x+=.1*(blimpMouseX-cameraBlimp.position.x),cameraBlimp.lookAt(sceneBlimp.position),root.position.x=5*Math.cos(.75*t),root.rotation.y=Math.PI/1.9+.1*Math.cos(t),rendererBlimp.render(sceneBlimp,cameraBlimp),"floatAway"==animation&&(root.position.y=10*(t-now),root.position.y>100&&(root.position.y=101))}function setNavControls(t){console.log("n: "+t),0==t?(nav[0].classList="nav hidden",nav[1].classList="nav"):t==slideCount-1?(nav[0].classList="nav",nav[1].classList="nav hidden"):nav[0].classList=nav[1].classList="nav"}function onNavPress(t){t=t?t:window.e,console.log("press");var e=t.target.id;e=e?"":t.target.parentElement.id,"nav-prev"==e&currentSlide>0?prevSlide():"nav-next"==e&currentSlide<slideCount-1&&nextSlide()}function gotoSlide(t){currentSlide=t,slider.classList="slide-"+currentSlide,setNavControls(currentSlide);for(var e=0;e<slides.length;e++)slides[e].classList="slide";document.getElementById("slide-"+currentSlide).classList.add("active-slide")}function prevSlide(){currentSlide--,gotoSlide(currentSlide)}function nextSlide(){currentSlide++,gotoSlide(currentSlide)}function toggleGallery(t,e){if(console.log("toggle "+t),1==t)document.body.classList.add("gallery-active"),console.log("selectedSlide: "+e),gotoSlide(e);else if(0==t){for(var n=0;n<slides.length;n++)slides[n].classList="slide";document.body.classList.remove("gallery-active"),document.addEventListener("mousemove",onDocumentMouseMove,!1),slider.classList="slide-0"}}function load(){var t=new THREE.TextureLoader;t.load("assets/images/clouds.png",function(t){t.wrapS=t.wrapT=THREE.RepeatWrapping,t.offset.set(.25,.25),t.repeat.set(4,4),t.needsUpdate=!0,cloudTexture=t,checkLoading()}),t.load("assets/images/gg_logo_grey.png",function(t){t.offset.set(-.1,-1.8),t.repeat.set(1.5,3.5),logoTexture=t,checkLoading()}),t.load("assets/images/land-alpha.png"),function(t){t.repeat.set(5,1),t.wrapS=t.wrapT=THREE.RepeatWrapping,landAlpha=t,checkLoading()},t.load("assets/images/waternormals.jpg",function(t){t.wrapS=t.wrapT=THREE.RepeatWrapping,waterNormals=t,checkLoading()});var e=new THREE.OBJLoader;e.load("assets/biplane-simple.obj",function(t){biplaneObj=t,checkLoading()}),e.load("./assets/blimp.obj",function(t){blimp=t,checkLoading()}),e.load("./assets/ship/cargo-ship.obj",function(t){ship=t,checkLoading()});(new THREE.FontLoader).load("assets/fonts/EB_Garamond_Regular-full.json",function(t){console.log(t),font=t,checkLoading()})}function checkLoading(){console.log(loadedItems),loadedItems++,loadedItems>6&&init()}function init(){function t(){var t=document.getElementById("heightmap"),e=document.createElement("canvas");e.id="heightmapCanvas",document.body.appendChild(e),e.width=t.width,e.height=t.height,e.getContext("2d").drawImage(t,0,0,t.width,t.height);for(var n=e.getContext("2d").getImageData(0,0,t.width,t.height).data,i=[],r=(new Array(n),0),a=n.length;r<a;r+=4)i.push((n[r]+n[r+1]+n[r+2])/3);return i}function e(){for(var e=63,n=new THREE.PlaneGeometry(500,500,e,e+1),i=t(),r=0,a=n.vertices.length;r<a;r++){var o=i[r]/255;n.vertices[r].z=n.vertices[r].z+100*o}n.computeFaceNormals(),n.computeVertexNormals(),rocks=new THREE.Object3D;for(var r=0;r<10;r++){var s=new THREE.Mesh(n.clone(),g),c=4e3*(Math.random()-.5)+0,l=4e3*(Math.random()-.5)+4e3;s.position.set(c,-220,l),s.rotation.set(-Math.PI/2,0,Math.random()*Math.PI),s.scale.set(3*Math.random(),3*Math.random(),1),rocks.add(s)}scene.add(rocks)}function n(){var t="assets/images/skybox/",e=(new THREE.CubeTextureLoader).load([t+"3.jpg",t+"1.jpg",t+"roof.jpg",t+"roof.jpg",t+"2.jpg",t+"4.jpg"]);e.format=THREE.RGBFormat;var n=THREE.ShaderLib.cube;n.uniforms.tCube.value=e;var i=new THREE.ShaderMaterial({fragmentShader:n.fragmentShader,vertexShader:n.vertexShader,uniforms:n.uniforms,depthWrite:!1,side:THREE.BackSide}),r=new THREE.Mesh(new THREE.BoxGeometry(1e4,1e4,1e4),i);r.rotation.set(0,Math.PI/2,0),r.position.set(0,1400,0),scene.add(r);var a=new THREE.PlaneBufferGeometry(1e4,1e4,1,1),o=new THREE.Mesh(a,new THREE.MeshBasicMaterial({color:8947848}));o.material.side=THREE.DoubleSide,o.rotation.set(-Math.PI/2,0,0),o.position.set(0,200,0),o.receiveShadow=!0}var i=document.getElementById("portfolio"),r=document.createElement("div");container=i.appendChild(r),camera=new THREE.PerspectiveCamera(85,window.innerWidth/window.innerHeight,1,12e3),camera.position.z=-100,camera.position.y=300,camera.position.x=30,camera.lookAt(0,0,0),scene=new THREE.Scene;var a=new THREE.AmbientLight(13421772);scene.add(a);var o=new THREE.DirectionalLight(14601935);o.position.set(0,-30,100),scene.add(o);var s=new THREE.DirectionalLight(14601935,1);s.shadow.camera.left=-200,s.shadow.camera.right=200,s.shadow.camera.top=200,s.shadow.camera.bottom=-200,s.shadow.camera.near=1,s.shadow.camera.far=1500,s.shadow.camera.fov=130,s.shadow.camera.position.x=0,s.shadow.mapSize.width=2048,s.shadow.mapSize.height=2048,s.castShadow=!0,s.shadow.darkness=.5,s.position.set(50,100,0),s.target.position.set(0,0,0),scene.add(s.target),scene.add(s);new THREE.CameraHelper(s.shadow.camera);renderer=new THREE.WebGLRenderer({alpha:!0}),renderer.setPixelRatio(window.devicePixelRatio),renderer.setSize(window.innerWidth,window.innerHeight),renderer.setClearColor(16777215,0),container.appendChild(renderer.domElement),renderer.shadowMap.enabled=!0;for(var c=new THREE.MeshPhongMaterial({shininess:20,specular:new THREE.Color(14601935),color:new THREE.Color(14601935),map:logoTexture,lightMapIntensity:.9,transparent:!1}),l=[],h=0;h<galleryCount;h++){var u=new THREE.MeshLambertMaterial({shading:THREE.FlatShading,color:new THREE.Color(16777215),map:(new THREE.TextureLoader).load("assets/images/portfolio/thumbnail-"+h+".jpg",function(t){t.offset.set(0,.25),t.repeat.set(1,.75)}),transparent:!1});l.push(u)}var d=new THREE.MeshLambertMaterial({shading:THREE.FlatShading,color:new THREE.Color(16777215)}),p=(new THREE.MeshPhongMaterial({color:new THREE.Color(8962046)}),new THREE.LineBasicMaterial({color:16777215,linewidth:2}),new THREE.LineBasicMaterial({color:12303291,linewidth:1})),f=new THREE.MeshLambertMaterial({color:11184810,transparent:!0,alphaMap:landAlpha,refractionRatio:0,reflectivity:0}),m=new THREE.MeshPhongMaterial({color:16733525,shininess:50}),g=(new THREE.PointsMaterial({color:16777215,size:.5}),new THREE.MeshPhongMaterial({color:3355443,shading:THREE.FlatShading,shininess:0})),v=new THREE.MeshPhongMaterial({shading:THREE.FlatShading,shininess:0,map:cloudTexture,transparent:!0}),y=new THREE.PlaneBufferGeometry(5e3,500,1,1);plane=new THREE.Mesh(y,f),plane.material.side=THREE.DoubleSide,plane.position.set(-2e3,-190,2e3),plane.rotation.set(0,-Math.PI/4,0),e();var y=new THREE.PlaneBufferGeometry(7e3,7e3,1,1);clouds=new THREE.Mesh(y,v),clouds.material.side=THREE.DoubleSide,clouds.position.set(0,500,0),clouds.rotation.set(-Math.PI/2,0,0),scene.add(clouds),n(),water=new THREE.Water(renderer,camera,scene,{textureWidth:256,textureHeight:256,waterNormals:waterNormals,alpha:1,sunDirection:s.position.normalize(),sunColor:16777198,waterColor:7695,waterColor:9823,betaVersion:0,side:THREE.DoubleSide});var x=new THREE.Mesh(new THREE.PlaneBufferGeometry(9e3,9e3,1,1),water.material);x.add(water),x.rotation.x=.5*-Math.PI,x.rotation.y=Math.PI,x.position.y=-200,scene.add(x);var b=.4,w=10;blimp.traverse(function(t){t instanceof THREE.Mesh&&(t.material=c,t.material.side=THREE.Frontside,t.castShadow=!0)}),blimp.position.y=w,blimp.rotation.y=3*-Math.PI/4,blimp.scale.set(b,b,b),blimp.castShadow=!0,blimp.receiveShadow=!0,scene.add(blimp);for(var _=biplaneObj.children[0].geometry,h=0;h<galleryCount;h++){var M=new THREE.Mesh(_,m);M.position.set(50*-h+230,w-50,100),M.rotation.y=3*Math.PI/4,M.scale.set(10,10,10),M.castShadow=!0,biplanes.push(M),scene.add(M);var E=new THREE.BoxGeometry(50,37.5,.01),T=new THREE.Mesh(E,l[h]);T.material.side=THREE.DoubleSide,T.position.set(50*-h+100,w-50,-30),T.rotation.set(0,3*Math.PI/4,0),T.receiveShadow=!0,T.castShadow=!0,T.name="banner-"+h,T.index=h,banners.push(T),targetList.push(T),scene.add(T);var S=new THREE.MeshBasicMaterial({color:16777215,side:THREE.BackSide}),A=new THREE.Mesh(E,S);A.position.set(T.position.x,T.position.y,T.position.z),A.rotation.set(T.rotation.x,T.rotation.y,T.rotation.z),A.scale.set(1,1,.5),A.name="banner-"+h,outlineList.push(A),scene.add(A);var R=new THREE.Geometry;R.vertices.push(new THREE.Vector3(M.position.x,M.position.y+6,M.position.z)),R.vertices.push(new THREE.Vector3(T.position.x-1,T.position.y,T.position.z));var L=new THREE.Line(R,p);L.geometry.verticesNeedUpdate=!0,lines.push(L),scene.add(L);var C=galleryNames[h],P=new THREE.TextGeometry(C,{font:font,weight:"normal",size:6,height:.1});P.name=C;var I=new THREE.Mesh(P,d);I.position.set(T.position.x,T.position.y-30,T.position.z),I.rotation.set(T.rotation.x,T.rotation.y,T.rotation.z),texts.push(I),scene.add(I)}ship.traverse(function(t){t instanceof THREE.Mesh&&(t.material=m,t.material.side=THREE.Frontside)}),scene.add(ship),ship.position.set(0,-185,0),ship.rotation.set(0,5*Math.PI/4,0),ships.push(ship),document.addEventListener("mousemove",onDocumentMouseMove,!1),window.addEventListener("resize",onWindowResize,!1),postprocess&&(initPostprocessing(),renderer.autoClear=!1,renderer.setClearColor(10079487,1)),raycaster=new THREE.Raycaster,mouse=new THREE.Vector2,animate()}function onWindowResize(){windowHalfX=window.innerWidth/2,windowHalfY=window.innerHeight/2,camera.aspect=window.innerWidth/window.innerHeight,camera.updateProjectionMatrix(),renderer.setSize(window.innerWidth,window.innerHeight)}function onDocumentMouseMove(t){mouseX=(t.clientX-windowHalfX)/2,mouseY=(t.clientY-windowHalfY)/2,mouse.x=t.clientX/window.innerWidth*2-1,mouse.y=2*-(t.clientY/window.innerHeight)+1}function animate(){requestAnimationFrame(animate),water.render(),render()}function render(){var t=(.001*Date.now(),clock.getElapsedTime());camera.position.x=-mouseX+100,camera.position.y=-mouseY+200,camera.position.z=-200,rocks.position.x-=.1*t,rocks.position.z-=.1*t,cloudTexture.offset.x+=5e-4,cloudTexture.offset.y-=5e-4,blimp.position.x-=.2*Math.cos(t),blimp.position.z-=.15*Math.cos(t/2),lines[4].geometry.vertices[0].x-=.2*Math.cos(t),lines[4].geometry.vertices[1].x+=.2*Math.cos(t),lines[4].geometry.verticesNeedUpdate=!0,ships[0].position.x=ships[0].position.z=1e3-50*t,camera.lookAt(scene.position),camera.updateMatrixWorld(),raycaster.setFromCamera(mouse,camera),intersects=raycaster.intersectObjects(targetList),intersects.length>0?(INTERSECTED=intersects[0].object.index,null==INTERSECTED&&0==INTERSECTED||(console.log(INTERSECTED),document.body.style.cursor="pointer",outlineList[INTERSECTED].scale.set(1.1,1.1,1),texts[INTERSECTED].visible=!0,container.addEventListener("click",function t(){console.log("INTERSECTED: "+INTERSECTED),null!=INTERSECTED&&(container.removeEventListener("click",t),toggleGallery(!0,INTERSECTED))}))):(document.body.style.cursor="all-scroll",outlineList.forEach(function(t){t.scale.set(1.025,1.025,1)}),texts.forEach(function(t){t.visible=!1}),INTERSECTED=null),postprocess?postprocessing.composer.render(.1):renderer.render(scene,camera),water.material.uniforms.time.value+=1/60}function randomPoint(){return new THREE.Vector3(THREE.Math.randFloat(-1,1),THREE.Math.randFloat(-1,1),THREE.Math.randFloat(-1,1))}function debounce(t,e,n){var i;return function(){var r=this,a=arguments,o=function(){i=null,n||t.apply(r,a)},s=n&&!i;clearTimeout(i),i=setTimeout(o,e),s&&t.apply(r,a)}}function sendMail(){var t="//api.sendgrid.com/api/blocks.get.json",t=t+str,e=new XMLHttpRequest;if("withCredentials"in e)e.open("POST",t,!0),e.setRequestHeader("Access-Control-Allow-Origin","*"),e.setRequestHeader("Access-Control-Allow-Methods","GET"),e.onreadystatechange=handler,e.send();else if(XDomainRequest){var n=new XDomainRequest;n.open("post",t),n.send()}}function handler(){console.log("sent")}!function(t){var e,n,i="0.4.2",r="hasOwnProperty",a=/[\.\/]/,o=/\s*,\s*/,s="*",c=function(t,e){return t-e},l={n:{}},h=function(){for(var t=0,e=this.length;e>t;t++)if("undefined"!=typeof this[t])return this[t]},u=function(){for(var t=this.length;--t;)if("undefined"!=typeof this[t])return this[t]},d=function(t,i){t=String(t);var r,a=n,o=Array.prototype.slice.call(arguments,2),s=d.listeners(t),l=0,p=[],f={},m=[],g=e;m.firstDefined=h,m.lastDefined=u,e=t,n=0;for(var v=0,y=s.length;y>v;v++)"zIndex"in s[v]&&(p.push(s[v].zIndex),s[v].zIndex<0&&(f[s[v].zIndex]=s[v]));for(p.sort(c);p[l]<0;)if(r=f[p[l++]],m.push(r.apply(i,o)),n)return n=a,m;for(v=0;y>v;v++)if(r=s[v],"zIndex"in r)if(r.zIndex==p[l]){if(m.push(r.apply(i,o)),n)break;do if(l++,r=f[p[l]],r&&m.push(r.apply(i,o)),n)break;while(r)}else f[r.zIndex]=r;else if(m.push(r.apply(i,o)),n)break;return n=a,e=g,m};d._events=l,d.listeners=function(t){var e,n,i,r,o,c,h,u,d=t.split(a),p=l,f=[p],m=[];for(r=0,o=d.length;o>r;r++){for(u=[],c=0,h=f.length;h>c;c++)for(p=f[c].n,n=[p[d[r]],p[s]],i=2;i--;)e=n[i],e&&(u.push(e),m=m.concat(e.f||[]));f=u}return m},d.on=function(t,e){if(t=String(t),"function"!=typeof e)return function(){};for(var n=t.split(o),i=0,r=n.length;r>i;i++)!function(t){for(var n,i=t.split(a),r=l,o=0,s=i.length;s>o;o++)r=r.n,r=r.hasOwnProperty(i[o])&&r[i[o]]||(r[i[o]]={n:{}});for(r.f=r.f||[],o=0,s=r.f.length;s>o;o++)if(r.f[o]==e){n=!0;break}!n&&r.f.push(e)}(n[i]);return function(t){+t==+t&&(e.zIndex=+t)}},d.f=function(t){var e=[].slice.call(arguments,1);return function(){d.apply(null,[t,null].concat(e).concat([].slice.call(arguments,0)))}},d.stop=function(){n=1},d.nt=function(t){return t?new RegExp("(?:\\.|\\/|^)"+t+"(?:\\.|\\/|$)").test(e):e},d.nts=function(){return e.split(a)},d.off=d.unbind=function(t,e){if(!t)return void(d._events=l={n:{}});var n=t.split(o);if(n.length>1)for(var i=0,c=n.length;c>i;i++)d.off(n[i],e);else{n=t.split(a);var h,u,p,i,c,f,m,g=[l];for(i=0,c=n.length;c>i;i++)for(f=0;f<g.length;f+=p.length-2){if(p=[f,1],h=g[f].n,n[i]!=s)h[n[i]]&&p.push(h[n[i]]);else for(u in h)h[r](u)&&p.push(h[u]);g.splice.apply(g,p)}for(i=0,c=g.length;c>i;i++)for(h=g[i];h.n;){if(e){if(h.f){for(f=0,m=h.f.length;m>f;f++)if(h.f[f]==e){h.f.splice(f,1);break}!h.f.length&&delete h.f}for(u in h.n)if(h.n[r](u)&&h.n[u].f){var v=h.n[u].f;for(f=0,m=v.length;m>f;f++)if(v[f]==e){v.splice(f,1);break}!v.length&&delete h.n[u].f}}else{delete h.f;for(u in h.n)h.n[r](u)&&h.n[u].f&&delete h.n[u].f}h=h.n}}},d.once=function(t,e){var n=function(){return d.unbind(t,n),e.apply(this,arguments)};return d.on(t,n)},d.version=i,d.toString=function(){return"You are running Eve "+i},"undefined"!=typeof module&&module.exports?module.exports=d:"function"==typeof define&&define.amd?define("eve",[],function(){return d}):t.eve=d}(this),function(t,e){"function"==typeof define&&define.amd?define(["eve"],function(n){return e(t,n)}):e(t,t.eve)}(this,function(t,e){var n=function(e){var n={},i=t.requestAnimationFrame||t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame||t.oRequestAnimationFrame||t.msRequestAnimationFrame||function(t){setTimeout(t,16)},r=Array.isArray||function(t){return t instanceof Array||"[object Array]"==Object.prototype.toString.call(t)},a=0,o="M"+(+new Date).toString(36),s=function(){return o+(a++).toString(36)},c=Date.now||function(){return+new Date},l=function(t){var e=this;if(null==t)return e.s;var n=e.s-t;e.b+=e.dur*n,e.B+=e.dur*n,e.s=t},h=function(t){var e=this;return null==t?e.spd:void(e.spd=t)},u=function(t){var e=this;return null==t?e.dur:(e.s=e.s*t/e.dur,void(e.dur=t))},d=function(){var t=this;delete n[t.id],t.update(),e("mina.stop."+t.id,t)},p=function(){var t=this;t.pdif||(delete n[t.id],t.update(),t.pdif=t.get()-t.b)},f=function(){var t=this;t.pdif&&(t.b=t.get()-t.pdif,delete t.pdif,n[t.id]=t)},m=function(){var t,e=this;if(r(e.start)){t=[];for(var n=0,i=e.start.length;i>n;n++)t[n]=+e.start[n]+(e.end[n]-e.start[n])*e.easing(e.s)}else t=+e.start+(e.end-e.start)*e.easing(e.s);e.set(t)},g=function(){var t=0;for(var r in n)if(n.hasOwnProperty(r)){var a=n[r],o=a.get();t++,a.s=(o-a.b)/(a.dur/a.spd),a.s>=1&&(delete n[r],a.s=1,t--,function(t){setTimeout(function(){e("mina.finish."+t.id,t)})}(a)),a.update()}t&&i(g)},v=function(t,e,r,a,o,c,y){var x={id:s(),start:t,end:e,b:r,s:0,dur:a-r,spd:1,get:o,set:c,easing:y||v.linear,status:l,speed:h,duration:u,stop:d,pause:p,resume:f,update:m};n[x.id]=x;var b,w=0;for(b in n)if(n.hasOwnProperty(b)&&(w++,2==w))break;return 1==w&&i(g),x};return v.time=c,v.getById=function(t){return n[t]||null},v.linear=function(t){return t},v.easeout=function(t){return Math.pow(t,1.7)},v.easein=function(t){return Math.pow(t,.48)},v.easeinout=function(t){if(1==t)return 1;if(0==t)return 0;var e=.48-t/1.04,n=Math.sqrt(.1734+e*e),i=n-e,r=Math.pow(Math.abs(i),1/3)*(0>i?-1:1),a=-n-e,o=Math.pow(Math.abs(a),1/3)*(0>a?-1:1),s=r+o+.5;return 3*(1-s)*s*s+s*s*s},v.backin=function(t){if(1==t)return 1;var e=1.70158;return t*t*((e+1)*t-e)},v.backout=function(t){if(0==t)return 0;t-=1;var e=1.70158;return t*t*((e+1)*t+e)+1},v.elastic=function(t){return t==!!t?t:Math.pow(2,-10*t)*Math.sin(2*(t-.075)*Math.PI/.3)+1},v.bounce=function(t){var e,n=7.5625,i=2.75;return 1/i>t?e=n*t*t:2/i>t?(t-=1.5/i,e=n*t*t+.75):2.5/i>t?(t-=2.25/i,e=n*t*t+.9375):(t-=2.625/i,e=n*t*t+.984375),e},t.mina=v,v}("undefined"==typeof e?function(){}:e),i=function(){function i(t,e){if(t){if(t.tagName)return E(t);if(a(t,"array")&&i.set)return i.set.apply(i,t);if(t instanceof b)return t;if(null==e)return t=T.doc.querySelector(t),E(t)}return t=null==t?"100%":t,e=null==e?"100%":e,new M(t,e)}function r(t,e){if(e){if("#text"==t&&(t=T.doc.createTextNode(e.text||"")),"string"==typeof t&&(t=r(t)),"string"==typeof e)return"xlink:"==e.substring(0,6)?t.getAttributeNS(Y,e.substring(6)):"xml:"==e.substring(0,4)?t.getAttributeNS(Z,e.substring(4)):t.getAttribute(e);for(var n in e)if(e[S](n)){var i=A(e[n]);i?"xlink:"==n.substring(0,6)?t.setAttributeNS(Y,n.substring(6),i):"xml:"==n.substring(0,4)?t.setAttributeNS(Z,n.substring(4),i):t.setAttribute(n,i):t.removeAttribute(n)}}else t=T.doc.createElementNS(Z,t);return t}function a(t,e){return e=A.prototype.toLowerCase.call(e),"finite"==e?isFinite(t):!("array"!=e||!(t instanceof Array||Array.isArray&&Array.isArray(t)))||("null"==e&&null===t||e==typeof t&&null!==t||"object"==e&&t===Object(t)||O.call(t).slice(8,-1).toLowerCase()==e)}function o(t){if("function"==typeof t||Object(t)!==t)return t;var e=new t.constructor;for(var n in t)t[S](n)&&(e[n]=o(t[n]));return e}function s(t,e){for(var n=0,i=t.length;i>n;n++)if(t[n]===e)return t.push(t.splice(n,1)[0])}function c(t,e,n){function i(){var r=Array.prototype.slice.call(arguments,0),a=r.join("␀"),o=i.cache=i.cache||{},c=i.count=i.count||[];return o[S](a)?(s(c,a),n?n(o[a]):o[a]):(c.length>=1e3&&delete o[c.shift()],c.push(a),o[a]=t.apply(e,r),n?n(o[a]):o[a])}return i}function l(t,e,n,i,r,a){if(null==r){var o=t-n,s=e-i;return o||s?(180+180*C.atan2(-s,-o)/N+360)%360:0}return l(t,e,r,a)-l(n,i,r,a)}function h(t){return t%360*N/180}function u(t){return 180*t/N%360}function d(t){var e=[];return t=t.replace(/(?:^|\s)(\w+)\(([^)]+)\)/g,function(t,n,i){return i=i.split(/\s*,\s*|\s+/),"rotate"==n&&1==i.length&&i.push(0,0),"scale"==n&&(i.length>2?i=i.slice(0,2):2==i.length&&i.push(0,0),1==i.length&&i.push(i[0],0,0)),e.push("skewX"==n?["m",1,0,C.tan(h(i[0])),1,0,0]:"skewY"==n?["m",1,C.tan(h(i[0])),0,1,0,0]:[n.charAt(0)].concat(i)),t}),e}function p(t,e){var n=rt(t),r=new i.Matrix;if(n)for(var a=0,o=n.length;o>a;a++){var s,c,l,h,u,d=n[a],p=d.length,f=A(d[0]).toLowerCase(),m=d[0]!=f,g=m?r.invert():0;"t"==f&&2==p?r.translate(d[1],0):"t"==f&&3==p?m?(s=g.x(0,0),c=g.y(0,0),l=g.x(d[1],d[2]),h=g.y(d[1],d[2]),r.translate(l-s,h-c)):r.translate(d[1],d[2]):"r"==f?2==p?(u=u||e,r.rotate(d[1],u.x+u.width/2,u.y+u.height/2)):4==p&&(m?(l=g.x(d[2],d[3]),h=g.y(d[2],d[3]),r.rotate(d[1],l,h)):r.rotate(d[1],d[2],d[3])):"s"==f?2==p||3==p?(u=u||e,r.scale(d[1],d[p-1],u.x+u.width/2,u.y+u.height/2)):4==p?m?(l=g.x(d[2],d[3]),h=g.y(d[2],d[3]),r.scale(d[1],d[1],l,h)):r.scale(d[1],d[1],d[2],d[3]):5==p&&(m?(l=g.x(d[3],d[4]),h=g.y(d[3],d[4]),r.scale(d[1],d[2],l,h)):r.scale(d[1],d[2],d[3],d[4])):"m"==f&&7==p&&r.add(d[1],d[2],d[3],d[4],d[5],d[6])}return r}function f(t,e){if(null==e){var n=!0;if(e=t.node.getAttribute("linearGradient"==t.type||"radialGradient"==t.type?"gradientTransform":"pattern"==t.type?"patternTransform":"transform"),!e)return new i.Matrix;e=d(e)}else e=i._.rgTransform.test(e)?A(e).replace(/\.{3}|\u2026/g,t._.transform||D):d(e),a(e,"array")&&(e=i.path?i.path.toString.call(e):A(e)),t._.transform=e;var r=p(e,t.getBBox(1));return n?r:void(t.matrix=r)}function m(t){var e=t.node.ownerSVGElement&&E(t.node.ownerSVGElement)||t.node.parentNode&&E(t.node.parentNode)||i.select("svg")||i(0,0),n=e.select("defs"),r=null!=n&&n.node;return r||(r=_("defs",e.node).node),r}function v(t){return t.node.ownerSVGElement&&E(t.node.ownerSVGElement)||i.select("svg")}function y(t,e,n){function i(t){if(null==t)return D;if(t==+t)return t;r(l,{width:t});try{return l.getBBox().width}catch(t){return 0}}function a(t){if(null==t)return D;if(t==+t)return t;r(l,{height:t});try{return l.getBBox().height}catch(t){return 0}}function o(i,r){null==e?c[i]=r(t.attr(i)||0):i==e&&(c=r(null==n?t.attr(i)||0:n))}var s=v(t).node,c={},l=s.querySelector(".svg---mgr");switch(l||(l=r("rect"),r(l,{x:-9e9,y:-9e9,width:10,height:10,class:"svg---mgr",fill:"none"}),s.appendChild(l)),t.type){case"rect":o("rx",i),o("ry",a);case"image":o("width",i),o("height",a);case"text":o("x",i),o("y",a);break;case"circle":o("cx",i),o("cy",a),o("r",i);break;case"ellipse":o("cx",i),o("cy",a),o("rx",i),o("ry",a);break;case"line":o("x1",i),o("x2",i),o("y1",a),o("y2",a);break;case"marker":o("refX",i),o("markerWidth",i),o("refY",a),o("markerHeight",a);break;case"radialGradient":o("fx",i),o("fy",a);break;case"tspan":o("dx",i),o("dy",a);break;default:o(e,i)}return s.removeChild(l),c}function x(t){a(t,"array")||(t=Array.prototype.slice.call(arguments,0));for(var e=0,n=0,i=this.node;this[e];)delete this[e++];for(e=0;e<t.length;e++)"set"==t[e].type?t[e].forEach(function(t){i.appendChild(t.node)}):i.appendChild(t[e].node);var r=i.childNodes;for(e=0;e<r.length;e++)this[n++]=E(r[e]);return this}function b(t){if(t.snap in J)return J[t.snap];var e,n=this.id=q();try{e=t.ownerSVGElement}catch(t){}if(this.node=t,e&&(this.paper=new M(e)),this.type=t.tagName,this.anims={},this._={transform:[]},t.snap=n,J[n]=this,"g"==this.type&&(this.add=x),this.type in{g:1,mask:1,pattern:1})for(var i in M.prototype)M.prototype[S](i)&&(this[i]=M.prototype[i])}function w(t){this.node=t}function _(t,e){var n=r(t);e.appendChild(n);var i=E(n);return i}function M(t,e){var n,i,a,o=M.prototype;if(t&&"svg"==t.tagName){if(t.snap in J)return J[t.snap];var s=t.ownerDocument;n=new b(t),i=t.getElementsByTagName("desc")[0],a=t.getElementsByTagName("defs")[0],i||(i=r("desc"),i.appendChild(s.createTextNode("Created with Snap")),n.node.appendChild(i)),a||(a=r("defs"),n.node.appendChild(a)),n.defs=a;for(var c in o)o[S](c)&&(n[c]=o[c]);n.paper=n.root=n}else n=_("svg",T.doc.body),r(n.node,{height:e,version:1.1,width:t,xmlns:Z});return n}function E(t){return t?t instanceof b||t instanceof w?t:t.tagName&&"svg"==t.tagName.toLowerCase()?new M(t):t.tagName&&"object"==t.tagName.toLowerCase()&&"image/svg+xml"==t.type?new M(t.contentDocument.getElementsByTagName("svg")[0]):new b(t):t}i.version="0.3.0",i.toString=function(){return"Snap v"+this.version},i._={};var T={win:t,doc:t.document};i._.glob=T;var S="hasOwnProperty",A=String,R=parseFloat,L=parseInt,C=Math,P=C.max,I=C.min,U=C.abs,N=(C.pow,C.PI),D=(C.round,""),F=" ",O=Object.prototype.toString,B=/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+%?(?:\s*,\s*[\d\.]+%?)?)\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?%?)\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?%?)\s*\))\s*$/i,z="\t\n\v\f\r   ᠎             　\u2028\u2029",H=(i._.separator=new RegExp("[,"+z+"]+"),new RegExp("["+z+"]","g"),new RegExp("["+z+"]*,["+z+"]*")),G={hs:1,rg:1},k=new RegExp("([a-z])["+z+",]*((-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?["+z+"]*,?["+z+"]*)+)","ig"),V=new RegExp("([rstm])["+z+",]*((-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?["+z+"]*,?["+z+"]*)+)","ig"),j=new RegExp("(-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?)["+z+"]*,?["+z+"]*","ig"),W=0,X="S"+(+new Date).toString(36),q=function(){return X+(W++).toString(36)},Y="http://www.w3.org/1999/xlink",Z="http://www.w3.org/2000/svg",J={},Q=i.url=function(t){return"url('#"+t+"')"};i._.$=r,i._.id=q,i.format=function(){var t=/\{([^\}]+)\}/g,e=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g,n=function(t,n,i){var r=i;return n.replace(e,function(t,e,n,i,a){e=e||i,r&&(e in r&&(r=r[e]),"function"==typeof r&&a&&(r=r()))}),r=(null==r||r==i?t:r)+""};return function(e,i){return A(e).replace(t,function(t,e){return n(t,e,i)})}}(),i._.clone=o,i._.cacher=c,i.rad=h,i.deg=u,i.angle=l,i.is=a,i.snapTo=function(t,e,n){if(n=a(n,"finite")?n:10,a(t,"array")){for(var i=t.length;i--;)if(U(t[i]-e)<=n)return t[i]}else{t=+t;var r=e%t;if(n>r)return e-r;if(r>t-n)return e-r+t}return e},i.getRGB=c(function(t){if(!t||(t=A(t)).indexOf("-")+1)return{r:-1,g:-1,b:-1,hex:"none",error:1,toString:et};if("none"==t)return{r:-1,g:-1,b:-1,hex:"none",toString:et};if(!(G[S](t.toLowerCase().substring(0,2))||"#"==t.charAt())&&(t=K(t)),!t)return{r:-1,g:-1,b:-1,hex:"none",error:1,toString:et};var e,n,r,o,s,c,l=t.match(B);return l?(l[2]&&(r=L(l[2].substring(5),16),n=L(l[2].substring(3,5),16),e=L(l[2].substring(1,3),16)),l[3]&&(r=L((s=l[3].charAt(3))+s,16),n=L((s=l[3].charAt(2))+s,16),e=L((s=l[3].charAt(1))+s,16)),l[4]&&(c=l[4].split(H),e=R(c[0]),"%"==c[0].slice(-1)&&(e*=2.55),n=R(c[1]),"%"==c[1].slice(-1)&&(n*=2.55),r=R(c[2]),"%"==c[2].slice(-1)&&(r*=2.55),"rgba"==l[1].toLowerCase().slice(0,4)&&(o=R(c[3])),c[3]&&"%"==c[3].slice(-1)&&(o/=100)),l[5]?(c=l[5].split(H),e=R(c[0]),"%"==c[0].slice(-1)&&(e/=100),n=R(c[1]),"%"==c[1].slice(-1)&&(n/=100),r=R(c[2]),"%"==c[2].slice(-1)&&(r/=100),("deg"==c[0].slice(-3)||"°"==c[0].slice(-1))&&(e/=360),"hsba"==l[1].toLowerCase().slice(0,4)&&(o=R(c[3])),c[3]&&"%"==c[3].slice(-1)&&(o/=100),i.hsb2rgb(e,n,r,o)):l[6]?(c=l[6].split(H),e=R(c[0]),"%"==c[0].slice(-1)&&(e/=100),n=R(c[1]),"%"==c[1].slice(-1)&&(n/=100),r=R(c[2]),"%"==c[2].slice(-1)&&(r/=100),("deg"==c[0].slice(-3)||"°"==c[0].slice(-1))&&(e/=360),"hsla"==l[1].toLowerCase().slice(0,4)&&(o=R(c[3])),c[3]&&"%"==c[3].slice(-1)&&(o/=100),i.hsl2rgb(e,n,r,o)):(e=I(C.round(e),255),n=I(C.round(n),255),r=I(C.round(r),255),o=I(P(o,0),1),l={r:e,g:n,b:r,toString:et},l.hex="#"+(16777216|r|n<<8|e<<16).toString(16).slice(1),l.opacity=a(o,"finite")?o:1,l)):{r:-1,g:-1,b:-1,hex:"none",error:1,toString:et}},i),i.hsb=c(function(t,e,n){return i.hsb2rgb(t,e,n).hex}),i.hsl=c(function(t,e,n){return i.hsl2rgb(t,e,n).hex}),i.rgb=c(function(t,e,n,i){if(a(i,"finite")){var r=C.round;return"rgba("+[r(t),r(e),r(n),+i.toFixed(2)]+")"}return"#"+(16777216|n|e<<8|t<<16).toString(16).slice(1)});var K=function(t){var e=T.doc.getElementsByTagName("head")[0]||T.doc.getElementsByTagName("svg")[0],n="rgb(255, 0, 0)";return(K=c(function(t){if("red"==t.toLowerCase())return n;e.style.color=n,e.style.color=t;var i=T.doc.defaultView.getComputedStyle(e,D).getPropertyValue("color");
return i==n?null:i}))(t)},$=function(){return"hsb("+[this.h,this.s,this.b]+")"},tt=function(){return"hsl("+[this.h,this.s,this.l]+")"},et=function(){return 1==this.opacity||null==this.opacity?this.hex:"rgba("+[this.r,this.g,this.b,this.opacity]+")"},nt=function(t,e,n){if(null==e&&a(t,"object")&&"r"in t&&"g"in t&&"b"in t&&(n=t.b,e=t.g,t=t.r),null==e&&a(t,string)){var r=i.getRGB(t);t=r.r,e=r.g,n=r.b}return(t>1||e>1||n>1)&&(t/=255,e/=255,n/=255),[t,e,n]},it=function(t,e,n,r){t=C.round(255*t),e=C.round(255*e),n=C.round(255*n);var o={r:t,g:e,b:n,opacity:a(r,"finite")?r:1,hex:i.rgb(t,e,n),toString:et};return a(r,"finite")&&(o.opacity=r),o};i.color=function(t){var e;return a(t,"object")&&"h"in t&&"s"in t&&"b"in t?(e=i.hsb2rgb(t),t.r=e.r,t.g=e.g,t.b=e.b,t.opacity=1,t.hex=e.hex):a(t,"object")&&"h"in t&&"s"in t&&"l"in t?(e=i.hsl2rgb(t),t.r=e.r,t.g=e.g,t.b=e.b,t.opacity=1,t.hex=e.hex):(a(t,"string")&&(t=i.getRGB(t)),a(t,"object")&&"r"in t&&"g"in t&&"b"in t&&!("error"in t)?(e=i.rgb2hsl(t),t.h=e.h,t.s=e.s,t.l=e.l,e=i.rgb2hsb(t),t.v=e.b):(t={hex:"none"},t.r=t.g=t.b=t.h=t.s=t.v=t.l=-1,t.error=1)),t.toString=et,t},i.hsb2rgb=function(t,e,n,i){a(t,"object")&&"h"in t&&"s"in t&&"b"in t&&(n=t.b,e=t.s,t=t.h,i=t.o),t*=360;var r,o,s,c,l;return t=t%360/60,l=n*e,c=l*(1-U(t%2-1)),r=o=s=n-l,t=~~t,r+=[l,c,0,0,c,l][t],o+=[c,l,l,c,0,0][t],s+=[0,0,c,l,l,c][t],it(r,o,s,i)},i.hsl2rgb=function(t,e,n,i){a(t,"object")&&"h"in t&&"s"in t&&"l"in t&&(n=t.l,e=t.s,t=t.h),(t>1||e>1||n>1)&&(t/=360,e/=100,n/=100),t*=360;var r,o,s,c,l;return t=t%360/60,l=2*e*(.5>n?n:1-n),c=l*(1-U(t%2-1)),r=o=s=n-l/2,t=~~t,r+=[l,c,0,0,c,l][t],o+=[c,l,l,c,0,0][t],s+=[0,0,c,l,l,c][t],it(r,o,s,i)},i.rgb2hsb=function(t,e,n){n=nt(t,e,n),t=n[0],e=n[1],n=n[2];var i,r,a,o;return a=P(t,e,n),o=a-I(t,e,n),i=0==o?null:a==t?(e-n)/o:a==e?(n-t)/o+2:(t-e)/o+4,i=(i+360)%6*60/360,r=0==o?0:o/a,{h:i,s:r,b:a,toString:$}},i.rgb2hsl=function(t,e,n){n=nt(t,e,n),t=n[0],e=n[1],n=n[2];var i,r,a,o,s,c;return o=P(t,e,n),s=I(t,e,n),c=o-s,i=0==c?null:o==t?(e-n)/c:o==e?(n-t)/c+2:(t-e)/c+4,i=(i+360)%6*60/360,a=(o+s)/2,r=0==c?0:.5>a?c/(2*a):c/(2-2*a),{h:i,s:r,l:a,toString:tt}},i.parsePathString=function(t){if(!t)return null;var e=i.path(t);if(e.arr)return i.path.clone(e.arr);var n={a:7,c:6,o:2,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,u:3,z:0},r=[];return a(t,"array")&&a(t[0],"array")&&(r=i.path.clone(t)),r.length||A(t).replace(k,function(t,e,i){var a=[],o=e.toLowerCase();if(i.replace(j,function(t,e){e&&a.push(+e)}),"m"==o&&a.length>2&&(r.push([e].concat(a.splice(0,2))),o="l",e="m"==e?"l":"L"),"o"==o&&1==a.length&&r.push([e,a[0]]),"r"==o)r.push([e].concat(a));else for(;a.length>=n[o]&&(r.push([e].concat(a.splice(0,n[o]))),n[o]););}),r.toString=i.path.toString,e.arr=i.path.clone(r),r};var rt=i.parseTransformString=function(t){if(!t)return null;var e=[];return a(t,"array")&&a(t[0],"array")&&(e=i.path.clone(t)),e.length||A(t).replace(V,function(t,n,i){var r=[];n.toLowerCase(),i.replace(j,function(t,e){e&&r.push(+e)}),e.push([n].concat(r))}),e.toString=i.path.toString,e};i._.svgTransform2string=d,i._.rgTransform=new RegExp("^[a-z]["+z+"]*-?\\.?\\d","i"),i._.transform2matrix=p,i._unit2px=y,T.doc.contains||T.doc.compareDocumentPosition?function(t,e){var n=9==t.nodeType?t.documentElement:t,i=e&&e.parentNode;return t==i||!(!i||1!=i.nodeType||!(n.contains?n.contains(i):t.compareDocumentPosition&&16&t.compareDocumentPosition(i)))}:function(t,e){if(e)for(;e;)if(e=e.parentNode,e==t)return!0;return!1},i._.getSomeDefs=m,i._.getSomeSVG=v,i.select=function(t){return E(T.doc.querySelector(t))},i.selectAll=function(t){for(var e=T.doc.querySelectorAll(t),n=(i.set||Array)(),r=0;r<e.length;r++)n.push(E(e[r]));return n},setInterval(function(){for(var t in J)if(J[S](t)){var e=J[t],n=e.node;("svg"!=e.type&&!n.ownerSVGElement||"svg"==e.type&&(!n.parentNode||"ownerSVGElement"in n.parentNode&&!n.ownerSVGElement))&&delete J[t]}},1e4),function(t){function o(t){function e(t,e){var n=r(t.node,e);n=n&&n.match(o),n=n&&n[2],n&&"#"==n.charAt()&&(n=n.substring(1),n&&(c[n]=(c[n]||[]).concat(function(n){var i={};i[e]=Q(n),r(t.node,i)})))}function n(t){var e=r(t.node,"xlink:href");e&&"#"==e.charAt()&&(e=e.substring(1),e&&(c[e]=(c[e]||[]).concat(function(e){t.attr("xlink:href","#"+e)})))}for(var i,a=t.selectAll("*"),o=/^\s*url\(("|'|)(.*)\1\)\s*$/,s=[],c={},l=0,h=a.length;h>l;l++){i=a[l],e(i,"fill"),e(i,"stroke"),e(i,"filter"),e(i,"mask"),e(i,"clip-path"),n(i);var u=r(i.node,"id");u&&(r(i.node,{id:i.id}),s.push({old:u,id:i.id}))}for(l=0,h=s.length;h>l;l++){var d=c[s[l].old];if(d)for(var p=0,f=d.length;f>p;p++)d[p](s[l].id)}}function s(t,e,n){return function(i){var r=i.slice(t,e);return 1==r.length&&(r=r[0]),n?n(r):r}}function c(t){return function(){var e=t?"<"+this.type:"",n=this.node.attributes,i=this.node.childNodes;if(t)for(var r=0,a=n.length;a>r;r++)e+=" "+n[r].name+'="'+n[r].value.replace(/"/g,'\\"')+'"';if(i.length){for(t&&(e+=">"),r=0,a=i.length;a>r;r++)3==i[r].nodeType?e+=i[r].nodeValue:1==i[r].nodeType&&(e+=E(i[r]).toString());t&&(e+="</"+this.type+">")}else t&&(e+="/>");return e}}t.attr=function(t,n){var i=this;if(i.node,!t)return i;if(a(t,"string")){if(!(arguments.length>1))return e("snap.util.getattr."+t,i).firstDefined();var r={};r[t]=n,t=r}for(var o in t)t[S](o)&&e("snap.util.attr."+o,i,t[o]);return i},t.getBBox=function(t){if(!i.Matrix||!i.path)return this.node.getBBox();var e=this,n=new i.Matrix;if(e.removed)return i._.box();for(;"use"==e.type;)if(t||(n=n.add(e.transform().localMatrix.translate(e.attr("x")||0,e.attr("y")||0))),e.original)e=e.original;else{var r=e.attr("xlink:href");e=e.original=e.node.ownerDocument.getElementById(r.substring(r.indexOf("#")+1))}var a=e._,o=i.path.get[e.type]||i.path.get.deflt;try{return t?(a.bboxwt=o?i.path.getBBox(e.realPath=o(e)):i._.box(e.node.getBBox()),i._.box(a.bboxwt)):(e.realPath=o(e),e.matrix=e.transform().localMatrix,a.bbox=i.path.getBBox(i.path.map(e.realPath,n.add(e.matrix))),i._.box(a.bbox))}catch(t){return i._.box()}};var l=function(){return this.string};t.transform=function(t){var e=this._;if(null==t){for(var n,a=this,o=new i.Matrix(this.node.getCTM()),s=f(this),c=[s],h=new i.Matrix,u=s.toTransformString(),d=A(s)==A(this.matrix)?A(e.transform):u;"svg"!=a.type&&(a=a.parent());)c.push(f(a));for(n=c.length;n--;)h.add(c[n]);return{string:d,globalMatrix:o,totalMatrix:h,localMatrix:s,diffMatrix:o.clone().add(s.invert()),global:o.toTransformString(),total:h.toTransformString(),local:u,toString:l}}return t instanceof i.Matrix?this.matrix=t:f(this,t),this.node&&("linearGradient"==this.type||"radialGradient"==this.type?r(this.node,{gradientTransform:this.matrix}):"pattern"==this.type?r(this.node,{patternTransform:this.matrix}):r(this.node,{transform:this.matrix})),this},t.parent=function(){return E(this.node.parentNode)},t.append=t.add=function(t){if(t){if("set"==t.type){var e=this;return t.forEach(function(t){e.add(t)}),this}t=E(t),this.node.appendChild(t.node),t.paper=this.paper}return this},t.appendTo=function(t){return t&&(t=E(t),t.append(this)),this},t.prepend=function(t){if(t){if("set"==t.type){var e,n=this;return t.forEach(function(t){e?e.after(t):n.prepend(t),e=t}),this}t=E(t);var i=t.parent();this.node.insertBefore(t.node,this.node.firstChild),this.add&&this.add(),t.paper=this.paper,this.parent()&&this.parent().add(),i&&i.add()}return this},t.prependTo=function(t){return t=E(t),t.prepend(this),this},t.before=function(t){if("set"==t.type){var e=this;return t.forEach(function(t){var n=t.parent();e.node.parentNode.insertBefore(t.node,e.node),n&&n.add()}),this.parent().add(),this}t=E(t);var n=t.parent();return this.node.parentNode.insertBefore(t.node,this.node),this.parent()&&this.parent().add(),n&&n.add(),t.paper=this.paper,this},t.after=function(t){t=E(t);var e=t.parent();return this.node.nextSibling?this.node.parentNode.insertBefore(t.node,this.node.nextSibling):this.node.parentNode.appendChild(t.node),this.parent()&&this.parent().add(),e&&e.add(),t.paper=this.paper,this},t.insertBefore=function(t){t=E(t);var e=this.parent();return t.node.parentNode.insertBefore(this.node,t.node),this.paper=t.paper,e&&e.add(),t.parent()&&t.parent().add(),this},t.insertAfter=function(t){t=E(t);var e=this.parent();return t.node.parentNode.insertBefore(this.node,t.node.nextSibling),this.paper=t.paper,e&&e.add(),t.parent()&&t.parent().add(),this},t.remove=function(){var t=this.parent();return this.node.parentNode&&this.node.parentNode.removeChild(this.node),delete this.paper,this.removed=!0,t&&t.add(),this},t.select=function(t){return E(this.node.querySelector(t))},t.selectAll=function(t){for(var e=this.node.querySelectorAll(t),n=(i.set||Array)(),r=0;r<e.length;r++)n.push(E(e[r]));return n},t.asPX=function(t,e){return null==e&&(e=this.attr(t)),+y(this,t,e)},t.use=function(){var t,e=this.node.id;return e||(e=this.id,r(this.node,{id:e})),t="linearGradient"==this.type||"radialGradient"==this.type||"pattern"==this.type?_(this.type,this.node.parentNode):_("use",this.node.parentNode),r(t.node,{"xlink:href":"#"+e}),t.original=this,t};var h=/\S+/g;t.addClass=function(t){var e,n,i,r,a=(t||"").match(h)||[],o=this.node,s=o.className.baseVal,c=s.match(h)||[];if(a.length){for(e=0;i=a[e++];)n=c.indexOf(i),~n||c.push(i);r=c.join(" "),s!=r&&(o.className.baseVal=r)}return this},t.removeClass=function(t){var e,n,i,r,a=(t||"").match(h)||[],o=this.node,s=o.className.baseVal,c=s.match(h)||[];if(c.length){for(e=0;i=a[e++];)n=c.indexOf(i),~n&&c.splice(n,1);r=c.join(" "),s!=r&&(o.className.baseVal=r)}return this},t.hasClass=function(t){var e=this.node,n=e.className.baseVal,i=n.match(h)||[];return!!~i.indexOf(t)},t.toggleClass=function(t,e){if(null!=e)return e?this.addClass(t):this.removeClass(t);var n,i,r,a,o=(t||"").match(h)||[],s=this.node,c=s.className.baseVal,l=c.match(h)||[];for(n=0;r=o[n++];)i=l.indexOf(r),~i?l.splice(i,1):l.push(r);return a=l.join(" "),c!=a&&(s.className.baseVal=a),this},t.clone=function(){var t=E(this.node.cloneNode(!0));return r(t.node,"id")&&r(t.node,{id:t.id}),o(t),t.insertAfter(this),t},t.toDefs=function(){var t=m(this);return t.appendChild(this.node),this},t.pattern=t.toPattern=function(t,e,n,i){var o=_("pattern",m(this));return null==t&&(t=this.getBBox()),a(t,"object")&&"x"in t&&(e=t.y,n=t.width,i=t.height,t=t.x),r(o.node,{x:t,y:e,width:n,height:i,patternUnits:"userSpaceOnUse",id:o.id,viewBox:[t,e,n,i].join(" ")}),o.node.appendChild(this.node),o},t.marker=function(t,e,n,i,o,s){var c=_("marker",m(this));return null==t&&(t=this.getBBox()),a(t,"object")&&"x"in t&&(e=t.y,n=t.width,i=t.height,o=t.refX||t.cx,s=t.refY||t.cy,t=t.x),r(c.node,{viewBox:[t,e,n,i].join(F),markerWidth:n,markerHeight:i,orient:"auto",refX:o||0,refY:s||0,id:c.id}),c.node.appendChild(this.node),c};var u=function(t,e,i,r){"function"!=typeof i||i.length||(r=i,i=n.linear),this.attr=t,this.dur=e,i&&(this.easing=i),r&&(this.callback=r)};i._.Animation=u,i.animation=function(t,e,n,i){return new u(t,e,n,i)},t.inAnim=function(){var t=this,e=[];for(var n in t.anims)t.anims[S](n)&&!function(t){e.push({anim:new u(t._attrs,t.dur,t.easing,t._callback),mina:t,curStatus:t.status(),status:function(e){return t.status(e)},stop:function(){t.stop()}})}(t.anims[n]);return e},i.animate=function(t,i,r,a,o,s){"function"!=typeof o||o.length||(s=o,o=n.linear);var c=n.time(),l=n(t,i,c,c+a,n.time,r,o);return s&&e.once("mina.finish."+l.id,s),l},t.stop=function(){for(var t=this.inAnim(),e=0,n=t.length;n>e;e++)t[e].stop();return this},t.animate=function(t,i,r,o){"function"!=typeof r||r.length||(o=r,r=n.linear),t instanceof u&&(o=t.callback,r=t.easing,i=r.dur,t=t.attr);var c,l,h,d,p=[],f=[],m={},g=this;for(var v in t)if(t[S](v)){g.equal?(d=g.equal(v,A(t[v])),c=d.from,l=d.to,h=d.f):(c=+g.attr(v),l=+t[v]);var y=a(c,"array")?c.length:1;m[v]=s(p.length,p.length+y,h),p=p.concat(c),f=f.concat(l)}var x=n.time(),b=n(p,f,x,x+i,n.time,function(t){var e={};for(var n in m)m[S](n)&&(e[n]=m[n](t));g.attr(e)},r);return g.anims[b.id]=b,b._attrs=t,b._callback=o,e("snap.animcreated."+g.id,b),e.once("mina.finish."+b.id,function(){delete g.anims[b.id],o&&o.call(g)}),e.once("mina.stop."+b.id,function(){delete g.anims[b.id]}),g};var d={};t.data=function(t,n){var r=d[this.id]=d[this.id]||{};if(0==arguments.length)return e("snap.data.get."+this.id,this,r,null),r;if(1==arguments.length){if(i.is(t,"object")){for(var a in t)t[S](a)&&this.data(a,t[a]);return this}return e("snap.data.get."+this.id,this,r[t],t),r[t]}return r[t]=n,e("snap.data.set."+this.id,this,n,t),this},t.removeData=function(t){return null==t?d[this.id]={}:d[this.id]&&delete d[this.id][t],this},t.outerSVG=t.toString=c(1),t.innerSVG=c()}(b.prototype),i.parse=function(t){var e=T.doc.createDocumentFragment(),n=!0,i=T.doc.createElement("div");if(t=A(t),t.match(/^\s*<\s*svg(?:\s|>)/)||(t="<svg>"+t+"</svg>",n=!1),i.innerHTML=t,t=i.getElementsByTagName("svg")[0])if(n)e=t;else for(;t.firstChild;)e.appendChild(t.firstChild);return i.innerHTML=D,new w(e)},w.prototype.select=b.prototype.select,w.prototype.selectAll=b.prototype.selectAll,i.fragment=function(){for(var t=Array.prototype.slice.call(arguments,0),e=T.doc.createDocumentFragment(),n=0,r=t.length;r>n;n++){var a=t[n];a.node&&a.node.nodeType&&e.appendChild(a.node),a.nodeType&&e.appendChild(a),"string"==typeof a&&e.appendChild(i.parse(a).node)}return new w(e)},i._.make=_,i._.wrap=E,M.prototype.el=function(t,e){var n=_(t,this.node);return e&&n.attr(e),n},e.on("snap.util.getattr",function(){var t=e.nt();t=t.substring(t.lastIndexOf(".")+1);var n=t.replace(/[A-Z]/g,function(t){return"-"+t.toLowerCase()});return at[S](n)?this.node.ownerDocument.defaultView.getComputedStyle(this.node,null).getPropertyValue(n):r(this.node,t)});var at={"alignment-baseline":0,"baseline-shift":0,clip:0,"clip-path":0,"clip-rule":0,color:0,"color-interpolation":0,"color-interpolation-filters":0,"color-profile":0,"color-rendering":0,cursor:0,direction:0,display:0,"dominant-baseline":0,"enable-background":0,fill:0,"fill-opacity":0,"fill-rule":0,filter:0,"flood-color":0,"flood-opacity":0,font:0,"font-family":0,"font-size":0,"font-size-adjust":0,"font-stretch":0,"font-style":0,"font-variant":0,"font-weight":0,"glyph-orientation-horizontal":0,"glyph-orientation-vertical":0,"image-rendering":0,kerning:0,"letter-spacing":0,"lighting-color":0,marker:0,"marker-end":0,"marker-mid":0,"marker-start":0,mask:0,opacity:0,overflow:0,"pointer-events":0,"shape-rendering":0,"stop-color":0,"stop-opacity":0,stroke:0,"stroke-dasharray":0,"stroke-dashoffset":0,"stroke-linecap":0,"stroke-linejoin":0,"stroke-miterlimit":0,"stroke-opacity":0,"stroke-width":0,"text-anchor":0,"text-decoration":0,"text-rendering":0,"unicode-bidi":0,visibility:0,"word-spacing":0,"writing-mode":0};e.on("snap.util.attr",function(t){var n=e.nt(),i={};n=n.substring(n.lastIndexOf(".")+1),i[n]=t;var a=n.replace(/-(\w)/gi,function(t,e){return e.toUpperCase()}),o=n.replace(/[A-Z]/g,function(t){return"-"+t.toLowerCase()});at[S](o)?this.node.style[a]=null==t?D:t:r(this.node,i)}),function(){}(M.prototype),i.ajax=function(t,n,i,r){var o=new XMLHttpRequest,s=q();if(o){if(a(n,"function"))r=i,i=n,n=null;else if(a(n,"object")){var c=[];for(var l in n)n.hasOwnProperty(l)&&c.push(encodeURIComponent(l)+"="+encodeURIComponent(n[l]));n=c.join("&")}return o.open(n?"POST":"GET",t,!0),n&&(o.setRequestHeader("X-Requested-With","XMLHttpRequest"),o.setRequestHeader("Content-type","application/x-www-form-urlencoded")),i&&(e.once("snap.ajax."+s+".0",i),e.once("snap.ajax."+s+".200",i),e.once("snap.ajax."+s+".304",i)),o.onreadystatechange=function(){4==o.readyState&&e("snap.ajax."+s+"."+o.status,r,o)},4==o.readyState?o:(o.send(n),o)}},i.load=function(t,e,n){i.ajax(t,function(t){var r=i.parse(t.responseText);n?e.call(n,r):e(r)})};var ot=function(t){var e=t.getBoundingClientRect(),n=t.ownerDocument,i=n.body,r=n.documentElement,a=r.clientTop||i.clientTop||0,o=r.clientLeft||i.clientLeft||0,s=e.top+(g.win.pageYOffset||r.scrollTop||i.scrollTop)-a,c=e.left+(g.win.pageXOffset||r.scrollLeft||i.scrollLeft)-o;return{y:s,x:c}};return i.getElementByPoint=function(t,e){var n=this,i=(n.canvas,T.doc.elementFromPoint(t,e));if(T.win.opera&&"svg"==i.tagName){var r=ot(i),a=i.createSVGRect();a.x=t-r.x,a.y=e-r.y,a.width=a.height=1;var o=i.getIntersectionList(a,null);o.length&&(i=o[o.length-1])}return i?E(i):null},i.plugin=function(t){t(i,b,M,T,w)},T.win.Snap=i,i}();return i.plugin(function(t){function e(t,e,i,r,a,o){return null==e&&"[object SVGMatrix]"==n.call(t)?(this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.e=t.e,void(this.f=t.f)):void(null!=t?(this.a=+t,this.b=+e,this.c=+i,this.d=+r,this.e=+a,this.f=+o):(this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0))}var n=Object.prototype.toString,i=String,r=Math,a="";!function(n){function o(t){return t[0]*t[0]+t[1]*t[1]}function s(t){var e=r.sqrt(o(t));t[0]&&(t[0]/=e),t[1]&&(t[1]/=e)}n.add=function(t,n,i,r,a,o){var s,c,l,h,u=[[],[],[]],d=[[this.a,this.c,this.e],[this.b,this.d,this.f],[0,0,1]],p=[[t,i,a],[n,r,o],[0,0,1]];for(t&&t instanceof e&&(p=[[t.a,t.c,t.e],[t.b,t.d,t.f],[0,0,1]]),s=0;3>s;s++)for(c=0;3>c;c++){for(h=0,l=0;3>l;l++)h+=d[s][l]*p[l][c];u[s][c]=h}return this.a=u[0][0],this.b=u[1][0],this.c=u[0][1],this.d=u[1][1],this.e=u[0][2],this.f=u[1][2],this},n.invert=function(){var t=this,n=t.a*t.d-t.b*t.c;return new e(t.d/n,-t.b/n,-t.c/n,t.a/n,(t.c*t.f-t.d*t.e)/n,(t.b*t.e-t.a*t.f)/n)},n.clone=function(){return new e(this.a,this.b,this.c,this.d,this.e,this.f)},n.translate=function(t,e){return this.add(1,0,0,1,t,e)},n.scale=function(t,e,n,i){return null==e&&(e=t),(n||i)&&this.add(1,0,0,1,n,i),this.add(t,0,0,e,0,0),(n||i)&&this.add(1,0,0,1,-n,-i),this},n.rotate=function(e,n,i){e=t.rad(e),n=n||0,i=i||0;var a=+r.cos(e).toFixed(9),o=+r.sin(e).toFixed(9);return this.add(a,o,-o,a,n,i),this.add(1,0,0,1,-n,-i)},n.x=function(t,e){return t*this.a+e*this.c+this.e},n.y=function(t,e){return t*this.b+e*this.d+this.f},n.get=function(t){return+this[i.fromCharCode(97+t)].toFixed(4)},n.toString=function(){return"matrix("+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)].join()+")"},n.offset=function(){return[this.e.toFixed(4),this.f.toFixed(4)]},n.determinant=function(){return this.a*this.d-this.b*this.c},n.split=function(){var e={};e.dx=this.e,e.dy=this.f;var n=[[this.a,this.c],[this.b,this.d]];e.scalex=r.sqrt(o(n[0])),s(n[0]),e.shear=n[0][0]*n[1][0]+n[0][1]*n[1][1],n[1]=[n[1][0]-n[0][0]*e.shear,n[1][1]-n[0][1]*e.shear],e.scaley=r.sqrt(o(n[1])),s(n[1]),e.shear/=e.scaley,this.determinant()<0&&(e.scalex=-e.scalex);var i=-n[0][1],a=n[1][1];return 0>a?(e.rotate=t.deg(r.acos(a)),0>i&&(e.rotate=360-e.rotate)):e.rotate=t.deg(r.asin(i)),e.isSimple=!(+e.shear.toFixed(9)||e.scalex.toFixed(9)!=e.scaley.toFixed(9)&&e.rotate),e.isSuperSimple=!+e.shear.toFixed(9)&&e.scalex.toFixed(9)==e.scaley.toFixed(9)&&!e.rotate,e.noRotation=!+e.shear.toFixed(9)&&!e.rotate,e},n.toTransformString=function(t){var e=t||this.split();return+e.shear.toFixed(9)?"m"+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)]:(e.scalex=+e.scalex.toFixed(4),e.scaley=+e.scaley.toFixed(4),e.rotate=+e.rotate.toFixed(4),(e.dx||e.dy?"t"+[+e.dx.toFixed(4),+e.dy.toFixed(4)]:a)+(1!=e.scalex||1!=e.scaley?"s"+[e.scalex,e.scaley,0,0]:a)+(e.rotate?"r"+[+e.rotate.toFixed(4),0,0]:a))}}(e.prototype),t.Matrix=e,t.matrix=function(t,n,i,r,a,o){return new e(t,n,i,r,a,o)}}),i.plugin(function(t,n,i,r,a){function o(i){return function(r){if(e.stop(),r instanceof a&&1==r.node.childNodes.length&&("radialGradient"==r.node.firstChild.tagName||"linearGradient"==r.node.firstChild.tagName||"pattern"==r.node.firstChild.tagName)&&(r=r.node.firstChild,p(this).appendChild(r),r=u(r)),r instanceof n)if("radialGradient"==r.type||"linearGradient"==r.type||"pattern"==r.type){r.node.id||m(r.node,{id:r.id});var o=g(r.node.id)}else o=r.attr(i);else if(o=t.color(r),o.error){var s=t(p(this).ownerSVGElement).gradient(r);s?(s.node.id||m(s.node,{id:s.id}),o=g(s.node.id)):o=r}else o=v(o);var c={};c[i]=o,m(this.node,c),this.node.style[i]=x}}function s(t){e.stop(),t==+t&&(t+="px"),this.node.style.fontSize=t}function c(t){for(var e=[],n=t.childNodes,i=0,r=n.length;r>i;i++){var a=n[i];3==a.nodeType&&e.push(a.nodeValue),"tspan"==a.tagName&&e.push(1==a.childNodes.length&&3==a.firstChild.nodeType?a.firstChild.nodeValue:c(a))}return e}function l(){return e.stop(),this.node.style.fontSize}var h=t._.make,u=t._.wrap,d=t.is,p=t._.getSomeDefs,f=/^url\(#?([^)]+)\)$/,m=t._.$,g=t.url,v=String,y=t._.separator,x="";e.on("snap.util.attr.mask",function(t){if(t instanceof n||t instanceof a){if(e.stop(),t instanceof a&&1==t.node.childNodes.length&&(t=t.node.firstChild,p(this).appendChild(t),t=u(t)),"mask"==t.type)var i=t;else i=h("mask",p(this)),i.node.appendChild(t.node);!i.node.id&&m(i.node,{id:i.id}),m(this.node,{mask:g(i.id)})}}),function(t){e.on("snap.util.attr.clip",t),e.on("snap.util.attr.clip-path",t),e.on("snap.util.attr.clipPath",t)}(function(t){if(t instanceof n||t instanceof a){if(e.stop(),"clipPath"==t.type)var i=t;else i=h("clipPath",p(this)),i.node.appendChild(t.node),!i.node.id&&m(i.node,{id:i.id});m(this.node,{"clip-path":g(i.id)})}}),e.on("snap.util.attr.fill",o("fill")),e.on("snap.util.attr.stroke",o("stroke"));var b=/^([lr])(?:\(([^)]*)\))?(.*)$/i;e.on("snap.util.grad.parse",function(t){t=v(t);var e=t.match(b);if(!e)return null;var n=e[1],i=e[2],r=e[3];return i=i.split(/\s*,\s*/).map(function(t){return+t==t?+t:t}),1==i.length&&0==i[0]&&(i=[]),r=r.split("-"),r=r.map(function(t){t=t.split(":");var e={color:t[0]};return t[1]&&(e.offset=parseFloat(t[1])),e}),{type:n,params:i,stops:r}}),e.on("snap.util.attr.d",function(n){e.stop(),d(n,"array")&&d(n[0],"array")&&(n=t.path.toString.call(n)),n=v(n),n.match(/[ruo]/i)&&(n=t.path.toAbsolute(n)),m(this.node,{d:n})})(-1),e.on("snap.util.attr.#text",function(t){e.stop(),t=v(t);for(var n=r.doc.createTextNode(t);this.node.firstChild;)this.node.removeChild(this.node.firstChild);this.node.appendChild(n)})(-1),e.on("snap.util.attr.path",function(t){e.stop(),this.attr({d:t})})(-1),e.on("snap.util.attr.class",function(t){e.stop(),this.node.className.baseVal=t})(-1),e.on("snap.util.attr.viewBox",function(t){var n;n=d(t,"object")&&"x"in t?[t.x,t.y,t.width,t.height].join(" "):d(t,"array")?t.join(" "):t,m(this.node,{viewBox:n}),e.stop()})(-1),e.on("snap.util.attr.transform",function(t){this.transform(t),e.stop()})(-1),e.on("snap.util.attr.r",function(t){"rect"==this.type&&(e.stop(),m(this.node,{rx:t,ry:t}))})(-1),e.on("snap.util.attr.textpath",function(t){if(e.stop(),"text"==this.type){var i,r,a;if(!t&&this.textPath){for(r=this.textPath;r.node.firstChild;)this.node.appendChild(r.node.firstChild);return r.remove(),void delete this.textPath}if(d(t,"string")){var o=p(this),s=u(o.parentNode).path(t);o.appendChild(s.node),i=s.id,s.attr({id:i})}else t=u(t),t instanceof n&&(i=t.attr("id"),i||(i=t.id,t.attr({id:i})));if(i)if(r=this.textPath,a=this.node,r)r.attr({"xlink:href":"#"+i});else{for(r=m("textPath",{"xlink:href":"#"+i});a.firstChild;)r.appendChild(a.firstChild);a.appendChild(r),this.textPath=u(r)}}})(-1),e.on("snap.util.attr.text",function(t){if("text"==this.type){for(var n=this.node,i=function(t){var e=m("tspan");if(d(t,"array"))for(var n=0;n<t.length;n++)e.appendChild(i(t[n]));else e.appendChild(r.doc.createTextNode(t));return e.normalize&&e.normalize(),e};n.firstChild;)n.removeChild(n.firstChild);for(var a=i(t);a.firstChild;)n.appendChild(a.firstChild)}e.stop()})(-1),e.on("snap.util.attr.fontSize",s)(-1),e.on("snap.util.attr.font-size",s)(-1),e.on("snap.util.getattr.transform",function(){return e.stop(),this.transform()})(-1),e.on("snap.util.getattr.textpath",function(){return e.stop(),this.textPath})(-1),function(){function n(n){return function(){e.stop();var i=r.doc.defaultView.getComputedStyle(this.node,null).getPropertyValue("marker-"+n);return"none"==i?i:t(r.doc.getElementById(i.match(f)[1]))}}function i(t){return function(n){e.stop();var i="marker"+t.charAt(0).toUpperCase()+t.substring(1);if(""==n||!n)return void(this.node.style[i]="none");if("marker"==n.type){var r=n.node.id;return r||m(n.node,{id:n.id}),void(this.node.style[i]=g(r))}}}e.on("snap.util.getattr.marker-end",n("end"))(-1),e.on("snap.util.getattr.markerEnd",n("end"))(-1),e.on("snap.util.getattr.marker-start",n("start"))(-1),e.on("snap.util.getattr.markerStart",n("start"))(-1),e.on("snap.util.getattr.marker-mid",n("mid"))(-1),e.on("snap.util.getattr.markerMid",n("mid"))(-1),e.on("snap.util.attr.marker-end",i("end"))(-1),e.on("snap.util.attr.markerEnd",i("end"))(-1),e.on("snap.util.attr.marker-start",i("start"))(-1),e.on("snap.util.attr.markerStart",i("start"))(-1),e.on("snap.util.attr.marker-mid",i("mid"))(-1),e.on("snap.util.attr.markerMid",i("mid"))(-1)}(),e.on("snap.util.getattr.r",function(){return"rect"==this.type&&m(this.node,"rx")==m(this.node,"ry")?(e.stop(),m(this.node,"rx")):void 0})(-1),e.on("snap.util.getattr.text",function(){if("text"==this.type||"tspan"==this.type){e.stop();var t=c(this.node);return 1==t.length?t[0]:t}})(-1),e.on("snap.util.getattr.#text",function(){return this.node.textContent})(-1),e.on("snap.util.getattr.viewBox",function(){e.stop();var n=m(this.node,"viewBox");return n?(n=n.split(y),t._.box(+n[0],+n[1],+n[2],+n[3])):void 0})(-1),e.on("snap.util.getattr.points",function(){var t=m(this.node,"points");return e.stop(),t?t.split(y):void 0})(-1),e.on("snap.util.getattr.path",function(){var t=m(this.node,"d");return e.stop(),t})(-1),e.on("snap.util.getattr.class",function(){return this.node.className.baseVal})(-1),e.on("snap.util.getattr.fontSize",l)(-1),e.on("snap.util.getattr.font-size",l)(-1)}),i.plugin(function(){function t(t){return t}function n(t){return function(e){return+e.toFixed(3)+t}}var i={"+":function(t,e){return t+e},"-":function(t,e){return t-e},"/":function(t,e){return t/e},"*":function(t,e){return t*e}},r=String,a=/[a-z]+$/i,o=/^\s*([+\-\/*])\s*=\s*([\d.eE+\-]+)\s*([^\d\s]+)?\s*$/;e.on("snap.util.attr",function(t){var n=r(t).match(o);if(n){var s=e.nt(),c=s.substring(s.lastIndexOf(".")+1),l=this.attr(c),h={};e.stop();var u=n[3]||"",d=l.match(a),p=i[n[1]];if(d&&d==u?t=p(parseFloat(l),+n[2]):(l=this.asPX(c),t=p(this.asPX(c),this.asPX(c,n[2]+u))),isNaN(l)||isNaN(t))return;h[c]=t,this.attr(h)}})(-10),e.on("snap.util.equal",function(s,c){var l=r(this.attr(s)||""),h=r(c).match(o);if(h){e.stop();var u=h[3]||"",d=l.match(a),p=i[h[1]];return d&&d==u?{from:parseFloat(l),to:p(parseFloat(l),+h[2]),f:n(d)}:(l=this.asPX(s),{from:l,to:p(l,this.asPX(s,h[2]+u)),f:t})}})(-10)}),i.plugin(function(t,n,i,r){var a=i.prototype,o=t.is;a.rect=function(t,e,n,i,r,a){var s;return null==a&&(a=r),o(t,"object")&&"[object Object]"==t?s=t:null!=t&&(s={x:t,y:e,width:n,height:i},null!=r&&(s.rx=r,s.ry=a)),this.el("rect",s)},a.circle=function(t,e,n){var i;return o(t,"object")&&"[object Object]"==t?i=t:null!=t&&(i={cx:t,cy:e,r:n}),this.el("circle",i)};var s=function(){function t(){this.parentNode.removeChild(this)}return function(e,n){var i=r.doc.createElement("img"),a=r.doc.body;i.style.cssText="position:absolute;left:-9999em;top:-9999em",i.onload=function(){n.call(i),i.onload=i.onerror=null,a.removeChild(i)},i.onerror=t,a.appendChild(i),i.src=e}}();a.image=function(e,n,i,r,a){var c=this.el("image");if(o(e,"object")&&"src"in e)c.attr(e);else if(null!=e){var l={"xlink:href":e,preserveAspectRatio:"none"};null!=n&&null!=i&&(l.x=n,l.y=i),null!=r&&null!=a?(l.width=r,l.height=a):s(e,function(){t._.$(c.node,{width:this.offsetWidth,height:this.offsetHeight})}),t._.$(c.node,l)}return c},a.ellipse=function(t,e,n,i){var r;return o(t,"object")&&"[object Object]"==t?r=t:null!=t&&(r={cx:t,cy:e,rx:n,ry:i}),this.el("ellipse",r)},a.path=function(t){var e;return o(t,"object")&&!o(t,"array")?e=t:t&&(e={d:t}),this.el("path",e)},a.group=a.g=function(t){var e=this.el("g");return 1==arguments.length&&t&&!t.type?e.attr(t):arguments.length&&e.add(Array.prototype.slice.call(arguments,0)),e},a.svg=function(t,e,n,i,r,a,s,c){var l={};return o(t,"object")&&null==e?l=t:(null!=t&&(l.x=t),null!=e&&(l.y=e),null!=n&&(l.width=n),null!=i&&(l.height=i),null!=r&&null!=a&&null!=s&&null!=c&&(l.viewBox=[r,a,s,c])),this.el("svg",l)},a.mask=function(t){var e=this.el("mask");return 1==arguments.length&&t&&!t.type?e.attr(t):arguments.length&&e.add(Array.prototype.slice.call(arguments,0)),e},a.ptrn=function(t,e,n,i,r,a,s,c){if(o(t,"object"))var l=t;else arguments.length?(l={},null!=t&&(l.x=t),null!=e&&(l.y=e),null!=n&&(l.width=n),null!=i&&(l.height=i),null!=r&&null!=a&&null!=s&&null!=c&&(l.viewBox=[r,a,s,c])):l={patternUnits:"userSpaceOnUse"};return this.el("pattern",l)},a.use=function(t){return null!=t?(make("use",this.node),t instanceof n&&(t.attr("id")||t.attr({id:ID()}),t=t.attr("id")),this.el("use",{"xlink:href":t})):n.prototype.use.call(this)},a.text=function(t,e,n){var i={};return o(t,"object")?i=t:null!=t&&(i={x:t,y:e,text:n||""}),this.el("text",i)},a.line=function(t,e,n,i){var r={};return o(t,"object")?r=t:null!=t&&(r={x1:t,x2:n,y1:e,y2:i}),this.el("line",r)},a.polyline=function(t){arguments.length>1&&(t=Array.prototype.slice.call(arguments,0));var e={};return o(t,"object")&&!o(t,"array")?e=t:null!=t&&(e={points:t}),this.el("polyline",e)},a.polygon=function(t){arguments.length>1&&(t=Array.prototype.slice.call(arguments,0));var e={};return o(t,"object")&&!o(t,"array")?e=t:null!=t&&(e={points:t}),this.el("polygon",e)},function(){function n(){return this.selectAll("stop")}function i(e,n){var i=l("stop"),r={offset:+n+"%"};return e=t.color(e),r["stop-color"]=e.hex,e.opacity<1&&(r["stop-opacity"]=e.opacity),l(i,r),this.node.appendChild(i),this}function r(){if("linearGradient"==this.type){var e=l(this.node,"x1")||0,n=l(this.node,"x2")||1,i=l(this.node,"y1")||0,r=l(this.node,"y2")||0;return t._.box(e,i,math.abs(n-e),math.abs(r-i))}var a=this.node.cx||.5,o=this.node.cy||.5,s=this.node.r||0;return t._.box(a-s,o-s,2*s,2*s)}function o(t,n){function i(t,e){for(var n=(e-u)/(t-d),i=d;t>i;i++)o[i].offset=+(+u+n*(i-d)).toFixed(2);d=t,u=e}var r,a=e("snap.util.grad.parse",null,n).firstDefined();if(!a)return null;a.params.unshift(t),r="l"==a.type.toLowerCase()?s.apply(0,a.params):c.apply(0,a.params),a.type!=a.type.toLowerCase()&&l(r.node,{gradientUnits:"userSpaceOnUse"});var o=a.stops,h=o.length,u=0,d=0;h--;for(var p=0;h>p;p++)"offset"in o[p]&&i(p,o[p].offset);for(o[h].offset=o[h].offset||100,i(h,o[h].offset),p=0;h>=p;p++){var f=o[p];r.addStop(f.color,f.offset)}return r}function s(e,a,o,s,c){var h=t._.make("linearGradient",e);return h.stops=n,h.addStop=i,h.getBBox=r,null!=a&&l(h.node,{x1:a,y1:o,x2:s,y2:c}),h}function c(e,a,o,s,c,h){var u=t._.make("radialGradient",e);return u.stops=n,u.addStop=i,u.getBBox=r,null!=a&&l(u.node,{cx:a,cy:o,r:s}),null!=c&&null!=h&&l(u.node,{fx:c,fy:h}),u}var l=t._.$;a.gradient=function(t){return o(this.defs,t)},a.gradientLinear=function(t,e,n,i){return s(this.defs,t,e,n,i)},a.gradientRadial=function(t,e,n,i,r){return c(this.defs,t,e,n,i,r)},a.toString=function(){var e,n=this.node.ownerDocument,i=n.createDocumentFragment(),r=n.createElement("div"),a=this.node.cloneNode(!0);return i.appendChild(r),r.appendChild(a),t._.$(a,{xmlns:"http://www.w3.org/2000/svg"}),e=r.innerHTML,i.removeChild(i.firstChild),e},a.clear=function(){for(var t,e=this.node.firstChild;e;)t=e.nextSibling,"defs"!=e.tagName?e.parentNode.removeChild(e):a.clear.call({node:e}),e=t}}()}),i.plugin(function(t,e){function n(t){var e=n.ps=n.ps||{};return e[t]?e[t].sleep=100:e[t]={sleep:100},setTimeout(function(){for(var n in e)e[F](n)&&n!=t&&(e[n].sleep--,!e[n].sleep&&delete e[n])}),e[t]}function i(t,e,n,i){return null==t&&(t=e=n=i=0),null==e&&(e=t.y,n=t.width,i=t.height,t=t.x),{x:t,y:e,width:n,w:n,height:i,h:i,x2:t+n,y2:e+i,cx:t+n/2,cy:e+i/2,r1:z.min(n,i)/2,r2:z.max(n,i)/2,r0:z.sqrt(n*n+i*i)/2,path:_(t,e,n,i),vb:[t,e,n,i].join(" ")}}function r(){return this.join(",").replace(O,"$1")}function a(t){var e=D(t);return e.toString=r,e}function o(t,e,n,i,r,a,o,s,l){return null==l?p(t,e,n,i,r,a,o,s):c(t,e,n,i,r,a,o,s,f(t,e,n,i,r,a,o,s,l))}function s(n,i){function r(t){return+(+t).toFixed(3)}return t._.cacher(function(t,a,s){t instanceof e&&(t=t.attr("d")),t=C(t);for(var l,h,u,d,p,f="",m={},g=0,v=0,y=t.length;y>v;v++){
if(u=t[v],"M"==u[0])l=+u[1],h=+u[2];else{if(d=o(l,h,u[1],u[2],u[3],u[4],u[5],u[6]),g+d>a){if(i&&!m.start){if(p=o(l,h,u[1],u[2],u[3],u[4],u[5],u[6],a-g),f+=["C"+r(p.start.x),r(p.start.y),r(p.m.x),r(p.m.y),r(p.x),r(p.y)],s)return f;m.start=f,f=["M"+r(p.x),r(p.y)+"C"+r(p.n.x),r(p.n.y),r(p.end.x),r(p.end.y),r(u[5]),r(u[6])].join(),g+=d,l=+u[5],h=+u[6];continue}if(!n&&!i)return p=o(l,h,u[1],u[2],u[3],u[4],u[5],u[6],a-g)}g+=d,l=+u[5],h=+u[6]}f+=u.shift()+u}return m.end=f,p=n?g:i?m:c(l,h,u[0],u[1],u[2],u[3],u[4],u[5],1)},null,t._.clone)}function c(t,e,n,i,r,a,o,s,c){var l=1-c,h=V(l,3),u=V(l,2),d=c*c,p=d*c,f=h*t+3*u*c*n+3*l*c*c*r+p*o,m=h*e+3*u*c*i+3*l*c*c*a+p*s,g=t+2*c*(n-t)+d*(r-2*n+t),v=e+2*c*(i-e)+d*(a-2*i+e),y=n+2*c*(r-n)+d*(o-2*r+n),x=i+2*c*(a-i)+d*(s-2*a+i),b=l*t+c*n,w=l*e+c*i,_=l*r+c*o,M=l*a+c*s,E=90-180*z.atan2(g-y,v-x)/H;return{x:f,y:m,m:{x:g,y:v},n:{x:y,y:x},start:{x:b,y:w},end:{x:_,y:M},alpha:E}}function l(e,n,r,a,o,s,c,l){t.is(e,"array")||(e=[e,n,r,a,o,s,c,l]);var h=L.apply(null,e);return i(h.min.x,h.min.y,h.max.x-h.min.x,h.max.y-h.min.y)}function h(t,e,n){return e>=t.x&&e<=t.x+t.width&&n>=t.y&&n<=t.y+t.height}function u(t,e){return t=i(t),e=i(e),h(e,t.x,t.y)||h(e,t.x2,t.y)||h(e,t.x,t.y2)||h(e,t.x2,t.y2)||h(t,e.x,e.y)||h(t,e.x2,e.y)||h(t,e.x,e.y2)||h(t,e.x2,e.y2)||(t.x<e.x2&&t.x>e.x||e.x<t.x2&&e.x>t.x)&&(t.y<e.y2&&t.y>e.y||e.y<t.y2&&e.y>t.y)}function d(t,e,n,i,r){var a=-3*e+9*n-9*i+3*r,o=t*a+6*e-12*n+6*i;return t*o-3*e+3*n}function p(t,e,n,i,r,a,o,s,c){null==c&&(c=1),c=c>1?1:0>c?0:c;for(var l=c/2,h=12,u=[-.1252,.1252,-.3678,.3678,-.5873,.5873,-.7699,.7699,-.9041,.9041,-.9816,.9816],p=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472],f=0,m=0;h>m;m++){var g=l*u[m]+l,v=d(g,t,n,r,o),y=d(g,e,i,a,s),x=v*v+y*y;f+=p[m]*z.sqrt(x)}return l*f}function f(t,e,n,i,r,a,o,s,c){if(!(0>c||p(t,e,n,i,r,a,o,s)<c)){var l,h=1,u=h/2,d=h-u,f=.01;for(l=p(t,e,n,i,r,a,o,s,d);j(l-c)>f;)u/=2,d+=(c>l?1:-1)*u,l=p(t,e,n,i,r,a,o,s,d);return d}}function m(t,e,n,i,r,a,o,s){if(!(k(t,n)<G(r,o)||G(t,n)>k(r,o)||k(e,i)<G(a,s)||G(e,i)>k(a,s))){var c=(t*i-e*n)*(r-o)-(t-n)*(r*s-a*o),l=(t*i-e*n)*(a-s)-(e-i)*(r*s-a*o),h=(t-n)*(a-s)-(e-i)*(r-o);if(h){var u=c/h,d=l/h,p=+u.toFixed(2),f=+d.toFixed(2);if(!(p<+G(t,n).toFixed(2)||p>+k(t,n).toFixed(2)||p<+G(r,o).toFixed(2)||p>+k(r,o).toFixed(2)||f<+G(e,i).toFixed(2)||f>+k(e,i).toFixed(2)||f<+G(a,s).toFixed(2)||f>+k(a,s).toFixed(2)))return{x:u,y:d}}}}function g(t,e,n){var i=l(t),r=l(e);if(!u(i,r))return n?0:[];for(var a=p.apply(0,t),o=p.apply(0,e),s=~~(a/8),h=~~(o/8),d=[],f=[],g={},v=n?0:[],y=0;s+1>y;y++){var x=c.apply(0,t.concat(y/s));d.push({x:x.x,y:x.y,t:y/s})}for(y=0;h+1>y;y++)x=c.apply(0,e.concat(y/h)),f.push({x:x.x,y:x.y,t:y/h});for(y=0;s>y;y++)for(var b=0;h>b;b++){var w=d[y],_=d[y+1],M=f[b],E=f[b+1],T=j(_.x-w.x)<.001?"y":"x",S=j(E.x-M.x)<.001?"y":"x",A=m(w.x,w.y,_.x,_.y,M.x,M.y,E.x,E.y);if(A){if(g[A.x.toFixed(4)]==A.y.toFixed(4))continue;g[A.x.toFixed(4)]=A.y.toFixed(4);var R=w.t+j((A[T]-w[T])/(_[T]-w[T]))*(_.t-w.t),L=M.t+j((A[S]-M[S])/(E[S]-M[S]))*(E.t-M.t);R>=0&&1>=R&&L>=0&&1>=L&&(n?v++:v.push({x:A.x,y:A.y,t1:R,t2:L}))}}return v}function v(t,e){return x(t,e)}function y(t,e){return x(t,e,1)}function x(t,e,n){t=C(t),e=C(e);for(var i,r,a,o,s,c,l,h,u,d,p=n?0:[],f=0,m=t.length;m>f;f++){var v=t[f];if("M"==v[0])i=s=v[1],r=c=v[2];else{"C"==v[0]?(u=[i,r].concat(v.slice(1)),i=u[6],r=u[7]):(u=[i,r,i,r,s,c,s,c],i=s,r=c);for(var y=0,x=e.length;x>y;y++){var b=e[y];if("M"==b[0])a=l=b[1],o=h=b[2];else{"C"==b[0]?(d=[a,o].concat(b.slice(1)),a=d[6],o=d[7]):(d=[a,o,a,o,l,h,l,h],a=l,o=h);var w=g(u,d,n);if(n)p+=w;else{for(var _=0,M=w.length;M>_;_++)w[_].segment1=f,w[_].segment2=y,w[_].bez1=u,w[_].bez2=d;p=p.concat(w)}}}}}return p}function b(t,e,n){var i=w(t);return h(i,e,n)&&x(t,[["M",e,n],["H",i.x2+10]],1)%2==1}function w(t){var e=n(t);if(e.bbox)return D(e.bbox);if(!t)return i();t=C(t);for(var r,a=0,o=0,s=[],c=[],l=0,h=t.length;h>l;l++)if(r=t[l],"M"==r[0])a=r[1],o=r[2],s.push(a),c.push(o);else{var u=L(a,o,r[1],r[2],r[3],r[4],r[5],r[6]);s=s.concat(u.min.x,u.max.x),c=c.concat(u.min.y,u.max.y),a=r[5],o=r[6]}var d=G.apply(0,s),p=G.apply(0,c),f=k.apply(0,s),m=k.apply(0,c),g=i(d,p,f-d,m-p);return e.bbox=D(g),g}function _(t,e,n,i,a){if(a)return[["M",+t+ +a,e],["l",n-2*a,0],["a",a,a,0,0,1,a,a],["l",0,i-2*a],["a",a,a,0,0,1,-a,a],["l",2*a-n,0],["a",a,a,0,0,1,-a,-a],["l",0,2*a-i],["a",a,a,0,0,1,a,-a],["z"]];var o=[["M",t,e],["l",n,0],["l",0,i],["l",-n,0],["z"]];return o.toString=r,o}function M(t,e,n,i,a){if(null==a&&null==i&&(i=n),t=+t,e=+e,n=+n,i=+i,null!=a)var o=Math.PI/180,s=t+n*Math.cos(-i*o),c=t+n*Math.cos(-a*o),l=e+n*Math.sin(-i*o),h=e+n*Math.sin(-a*o),u=[["M",s,l],["A",n,n,0,+(a-i>180),0,c,h]];else u=[["M",t,e],["m",0,-i],["a",n,i,0,1,1,0,2*i],["a",n,i,0,1,1,0,-2*i],["z"]];return u.toString=r,u}function E(e){var i=n(e),o=String.prototype.toLowerCase;if(i.rel)return a(i.rel);t.is(e,"array")&&t.is(e&&e[0],"array")||(e=t.parsePathString(e));var s=[],c=0,l=0,h=0,u=0,d=0;"M"==e[0][0]&&(c=e[0][1],l=e[0][2],h=c,u=l,d++,s.push(["M",c,l]));for(var p=d,f=e.length;f>p;p++){var m=s[p]=[],g=e[p];if(g[0]!=o.call(g[0]))switch(m[0]=o.call(g[0]),m[0]){case"a":m[1]=g[1],m[2]=g[2],m[3]=g[3],m[4]=g[4],m[5]=g[5],m[6]=+(g[6]-c).toFixed(3),m[7]=+(g[7]-l).toFixed(3);break;case"v":m[1]=+(g[1]-l).toFixed(3);break;case"m":h=g[1],u=g[2];default:for(var v=1,y=g.length;y>v;v++)m[v]=+(g[v]-(v%2?c:l)).toFixed(3)}else{m=s[p]=[],"m"==g[0]&&(h=g[1]+c,u=g[2]+l);for(var x=0,b=g.length;b>x;x++)s[p][x]=g[x]}var w=s[p].length;switch(s[p][0]){case"z":c=h,l=u;break;case"h":c+=+s[p][w-1];break;case"v":l+=+s[p][w-1];break;default:c+=+s[p][w-2],l+=+s[p][w-1]}}return s.toString=r,i.rel=a(s),s}function T(e){var i=n(e);if(i.abs)return a(i.abs);if(N(e,"array")&&N(e&&e[0],"array")||(e=t.parsePathString(e)),!e||!e.length)return[["M",0,0]];var o,s=[],c=0,l=0,h=0,u=0,d=0;"M"==e[0][0]&&(c=+e[0][1],l=+e[0][2],h=c,u=l,d++,s[0]=["M",c,l]);for(var p,f,m=3==e.length&&"M"==e[0][0]&&"R"==e[1][0].toUpperCase()&&"Z"==e[2][0].toUpperCase(),g=d,v=e.length;v>g;g++){if(s.push(p=[]),f=e[g],o=f[0],o!=o.toUpperCase())switch(p[0]=o.toUpperCase(),p[0]){case"A":p[1]=f[1],p[2]=f[2],p[3]=f[3],p[4]=f[4],p[5]=f[5],p[6]=+f[6]+c,p[7]=+f[7]+l;break;case"V":p[1]=+f[1]+l;break;case"H":p[1]=+f[1]+c;break;case"R":for(var y=[c,l].concat(f.slice(1)),x=2,b=y.length;b>x;x++)y[x]=+y[x]+c,y[++x]=+y[x]+l;s.pop(),s=s.concat(I(y,m));break;case"O":s.pop(),y=M(c,l,f[1],f[2]),y.push(y[0]),s=s.concat(y);break;case"U":s.pop(),s=s.concat(M(c,l,f[1],f[2],f[3])),p=["U"].concat(s[s.length-1].slice(-2));break;case"M":h=+f[1]+c,u=+f[2]+l;default:for(x=1,b=f.length;b>x;x++)p[x]=+f[x]+(x%2?c:l)}else if("R"==o)y=[c,l].concat(f.slice(1)),s.pop(),s=s.concat(I(y,m)),p=["R"].concat(f.slice(-2));else if("O"==o)s.pop(),y=M(c,l,f[1],f[2]),y.push(y[0]),s=s.concat(y);else if("U"==o)s.pop(),s=s.concat(M(c,l,f[1],f[2],f[3])),p=["U"].concat(s[s.length-1].slice(-2));else for(var w=0,_=f.length;_>w;w++)p[w]=f[w];if(o=o.toUpperCase(),"O"!=o)switch(p[0]){case"Z":c=+h,l=+u;break;case"H":c=p[1];break;case"V":l=p[1];break;case"M":h=p[p.length-2],u=p[p.length-1];default:c=p[p.length-2],l=p[p.length-1]}}return s.toString=r,i.abs=a(s),s}function S(t,e,n,i){return[t,e,n,i,n,i]}function A(t,e,n,i,r,a){var o=1/3,s=2/3;return[o*t+s*n,o*e+s*i,o*r+s*n,o*a+s*i,r,a]}function R(e,n,i,r,a,o,s,c,l,h){var u,d=120*H/180,p=H/180*(+a||0),f=[],m=t._.cacher(function(t,e,n){var i=t*z.cos(n)-e*z.sin(n),r=t*z.sin(n)+e*z.cos(n);return{x:i,y:r}});if(h)E=h[0],T=h[1],_=h[2],M=h[3];else{u=m(e,n,-p),e=u.x,n=u.y,u=m(c,l,-p),c=u.x,l=u.y;var g=(z.cos(H/180*a),z.sin(H/180*a),(e-c)/2),v=(n-l)/2,y=g*g/(i*i)+v*v/(r*r);y>1&&(y=z.sqrt(y),i=y*i,r=y*r);var x=i*i,b=r*r,w=(o==s?-1:1)*z.sqrt(j((x*b-x*v*v-b*g*g)/(x*v*v+b*g*g))),_=w*i*v/r+(e+c)/2,M=w*-r*g/i+(n+l)/2,E=z.asin(((n-M)/r).toFixed(9)),T=z.asin(((l-M)/r).toFixed(9));E=_>e?H-E:E,T=_>c?H-T:T,0>E&&(E=2*H+E),0>T&&(T=2*H+T),s&&E>T&&(E-=2*H),!s&&T>E&&(T-=2*H)}var S=T-E;if(j(S)>d){var A=T,L=c,C=l;T=E+d*(s&&T>E?1:-1),c=_+i*z.cos(T),l=M+r*z.sin(T),f=R(c,l,i,r,a,0,s,L,C,[T,A,_,M])}S=T-E;var P=z.cos(E),I=z.sin(E),U=z.cos(T),N=z.sin(T),D=z.tan(S/4),F=4/3*i*D,O=4/3*r*D,B=[e,n],G=[e+F*I,n-O*P],k=[c+F*N,l-O*U],V=[c,l];if(G[0]=2*B[0]-G[0],G[1]=2*B[1]-G[1],h)return[G,k,V].concat(f);f=[G,k,V].concat(f).join().split(",");for(var W=[],X=0,q=f.length;q>X;X++)W[X]=X%2?m(f[X-1],f[X],p).y:m(f[X],f[X+1],p).x;return W}function L(t,e,n,i,r,a,o,s){for(var c,l,h,u,d,p,f,m,g=[],v=[[],[]],y=0;2>y;++y)if(0==y?(l=6*t-12*n+6*r,c=-3*t+9*n-9*r+3*o,h=3*n-3*t):(l=6*e-12*i+6*a,c=-3*e+9*i-9*a+3*s,h=3*i-3*e),j(c)<1e-12){if(j(l)<1e-12)continue;u=-h/l,u>0&&1>u&&g.push(u)}else f=l*l-4*h*c,m=z.sqrt(f),0>f||(d=(-l+m)/(2*c),d>0&&1>d&&g.push(d),p=(-l-m)/(2*c),p>0&&1>p&&g.push(p));for(var x,b=g.length,w=b;b--;)u=g[b],x=1-u,v[0][b]=x*x*x*t+3*x*x*u*n+3*x*u*u*r+u*u*u*o,v[1][b]=x*x*x*e+3*x*x*u*i+3*x*u*u*a+u*u*u*s;return v[0][w]=t,v[1][w]=e,v[0][w+1]=o,v[1][w+1]=s,v[0].length=v[1].length=w+2,{min:{x:G.apply(0,v[0]),y:G.apply(0,v[1])},max:{x:k.apply(0,v[0]),y:k.apply(0,v[1])}}}function C(t,e){var i=!e&&n(t);if(!e&&i.curve)return a(i.curve);for(var r=T(t),o=e&&T(e),s={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},c={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},l=(function(t,e,n){var i,r;if(!t)return["C",e.x,e.y,e.x,e.y,e.x,e.y];switch(!(t[0]in{T:1,Q:1})&&(e.qx=e.qy=null),t[0]){case"M":e.X=t[1],e.Y=t[2];break;case"A":t=["C"].concat(R.apply(0,[e.x,e.y].concat(t.slice(1))));break;case"S":"C"==n||"S"==n?(i=2*e.x-e.bx,r=2*e.y-e.by):(i=e.x,r=e.y),t=["C",i,r].concat(t.slice(1));break;case"T":"Q"==n||"T"==n?(e.qx=2*e.x-e.qx,e.qy=2*e.y-e.qy):(e.qx=e.x,e.qy=e.y),t=["C"].concat(A(e.x,e.y,e.qx,e.qy,t[1],t[2]));break;case"Q":e.qx=t[1],e.qy=t[2],t=["C"].concat(A(e.x,e.y,t[1],t[2],t[3],t[4]));break;case"L":t=["C"].concat(S(e.x,e.y,t[1],t[2]));break;case"H":t=["C"].concat(S(e.x,e.y,t[1],e.y));break;case"V":t=["C"].concat(S(e.x,e.y,e.x,t[1]));break;case"Z":t=["C"].concat(S(e.x,e.y,e.X,e.Y))}return t}),h=function(t,e){if(t[e].length>7){t[e].shift();for(var n=t[e];n.length;)d[e]="A",o&&(p[e]="A"),t.splice(e++,0,["C"].concat(n.splice(0,6)));t.splice(e,1),v=k(r.length,o&&o.length||0)}},u=function(t,e,n,i,a){t&&e&&"M"==t[a][0]&&"M"!=e[a][0]&&(e.splice(a,0,["M",i.x,i.y]),n.bx=0,n.by=0,n.x=t[a][1],n.y=t[a][2],v=k(r.length,o&&o.length||0))},d=[],p=[],f="",m="",g=0,v=k(r.length,o&&o.length||0);v>g;g++){r[g]&&(f=r[g][0]),"C"!=f&&(d[g]=f,g&&(m=d[g-1])),r[g]=l(r[g],s,m),"A"!=d[g]&&"C"==f&&(d[g]="C"),h(r,g),o&&(o[g]&&(f=o[g][0]),"C"!=f&&(p[g]=f,g&&(m=p[g-1])),o[g]=l(o[g],c,m),"A"!=p[g]&&"C"==f&&(p[g]="C"),h(o,g)),u(r,o,s,c,g),u(o,r,c,s,g);var y=r[g],x=o&&o[g],b=y.length,w=o&&x.length;s.x=y[b-2],s.y=y[b-1],s.bx=B(y[b-4])||s.x,s.by=B(y[b-3])||s.y,c.bx=o&&(B(x[w-4])||c.x),c.by=o&&(B(x[w-3])||c.y),c.x=o&&x[w-2],c.y=o&&x[w-1]}return o||(i.curve=a(r)),o?[r,o]:r}function P(t,e){if(!e)return t;var n,i,r,a,o,s,c;for(t=C(t),r=0,o=t.length;o>r;r++)for(c=t[r],a=1,s=c.length;s>a;a+=2)n=e.x(c[a],c[a+1]),i=e.y(c[a],c[a+1]),c[a]=n,c[a+1]=i;return t}function I(t,e){for(var n=[],i=0,r=t.length;r-2*!e>i;i+=2){var a=[{x:+t[i-2],y:+t[i-1]},{x:+t[i],y:+t[i+1]},{x:+t[i+2],y:+t[i+3]},{x:+t[i+4],y:+t[i+5]}];e?i?r-4==i?a[3]={x:+t[0],y:+t[1]}:r-2==i&&(a[2]={x:+t[0],y:+t[1]},a[3]={x:+t[2],y:+t[3]}):a[0]={x:+t[r-2],y:+t[r-1]}:r-4==i?a[3]=a[2]:i||(a[0]={x:+t[i],y:+t[i+1]}),n.push(["C",(-a[0].x+6*a[1].x+a[2].x)/6,(-a[0].y+6*a[1].y+a[2].y)/6,(a[1].x+6*a[2].x-a[3].x)/6,(a[1].y+6*a[2].y-a[3].y)/6,a[2].x,a[2].y])}return n}var U=e.prototype,N=t.is,D=t._.clone,F="hasOwnProperty",O=/,?([a-z]),?/gi,B=parseFloat,z=Math,H=z.PI,G=z.min,k=z.max,V=z.pow,j=z.abs,W=s(1),X=s(),q=s(0,1),Y=t._unit2px,Z={path:function(t){return t.attr("path")},circle:function(t){var e=Y(t);return M(e.cx,e.cy,e.r)},ellipse:function(t){var e=Y(t);return M(e.cx||0,e.cy||0,e.rx,e.ry)},rect:function(t){var e=Y(t);return _(e.x||0,e.y||0,e.width,e.height,e.rx,e.ry)},image:function(t){var e=Y(t);return _(e.x||0,e.y||0,e.width,e.height)},line:function(t){return"M"+[t.attr("x1")||0,t.attr("y1")||0,t.attr("x2"),t.attr("y2")]},polyline:function(t){return"M"+t.attr("points")},polygon:function(t){return"M"+t.attr("points")+"z"},deflt:function(t){var e=t.node.getBBox();return _(e.x,e.y,e.width,e.height)}};t.path=n,t.path.getTotalLength=W,t.path.getPointAtLength=X,t.path.getSubpath=function(t,e,n){if(this.getTotalLength(t)-n<1e-6)return q(t,e).end;var i=q(t,n,1);return e?q(i,e).end:i},U.getTotalLength=function(){return this.node.getTotalLength?this.node.getTotalLength():void 0},U.getPointAtLength=function(t){return X(this.attr("d"),t)},U.getSubpath=function(e,n){return t.path.getSubpath(this.attr("d"),e,n)},t._.box=i,t.path.findDotsAtSegment=c,t.path.bezierBBox=l,t.path.isPointInsideBBox=h,t.path.isBBoxIntersect=u,t.path.intersection=v,t.path.intersectionNumber=y,t.path.isPointInside=b,t.path.getBBox=w,t.path.get=Z,t.path.toRelative=E,t.path.toAbsolute=T,t.path.toCubic=C,t.path.map=P,t.path.toString=r,t.path.clone=a}),i.plugin(function(t){var i=Math.max,r=Math.min,a=function(t){if(this.items=[],this.bindings={},this.length=0,this.type="set",t)for(var e=0,n=t.length;n>e;e++)t[e]&&(this[this.items.length]=this.items[this.items.length]=t[e],this.length++)},o=a.prototype;o.push=function(){for(var t,e,n=0,i=arguments.length;i>n;n++)t=arguments[n],t&&(e=this.items.length,this[e]=this.items[e]=t,this.length++);return this},o.pop=function(){return this.length&&delete this[this.length--],this.items.pop()},o.forEach=function(t,e){for(var n=0,i=this.items.length;i>n;n++)if(t.call(e,this.items[n],n)===!1)return this;return this},o.animate=function(i,r,a,o){"function"!=typeof a||a.length||(o=a,a=n.linear),i instanceof t._.Animation&&(o=i.callback,a=i.easing,r=a.dur,i=i.attr);var s=arguments;if(t.is(i,"array")&&t.is(s[s.length-1],"array"))var c=!0;var l,h=function(){l?this.b=l:l=this.b},u=0,d=o&&function(){u++==this.length&&o.call(this)};return this.forEach(function(t,n){e.once("snap.animcreated."+t.id,h),c?s[n]&&t.animate.apply(t,s[n]):t.animate(i,r,a,d)})},o.remove=function(){for(;this.length;)this.pop().remove();return this},o.bind=function(t,e,n){var i={};if("function"==typeof e)this.bindings[t]=e;else{var r=n||t;this.bindings[t]=function(t){i[r]=t,e.attr(i)}}return this},o.attr=function(t){var e={};for(var n in t)this.bindings[n]?this.bindings[n](t[n]):e[n]=t[n];for(var i=0,r=this.items.length;r>i;i++)this.items[i].attr(e);return this},o.clear=function(){for(;this.length;)this.pop()},o.splice=function(t,e){t=0>t?i(this.length+t,0):t,e=i(0,r(this.length-t,e));var n,o=[],s=[],c=[];for(n=2;n<arguments.length;n++)c.push(arguments[n]);for(n=0;e>n;n++)s.push(this[t+n]);for(;n<this.length-t;n++)o.push(this[t+n]);var l=c.length;for(n=0;n<l+o.length;n++)this.items[t+n]=this[t+n]=l>n?c[n]:o[n-l];for(n=this.items.length=this.length-=e-l;this[n];)delete this[n++];return new a(s)},o.exclude=function(t){for(var e=0,n=this.length;n>e;e++)if(this[e]==t)return this.splice(e,1),!0;return!1},o.insertAfter=function(t){for(var e=this.items.length;e--;)this.items[e].insertAfter(t);return this},o.getBBox=function(){for(var t=[],e=[],n=[],a=[],o=this.items.length;o--;)if(!this.items[o].removed){var s=this.items[o].getBBox();t.push(s.x),e.push(s.y),n.push(s.x+s.width),a.push(s.y+s.height)}return t=r.apply(0,t),e=r.apply(0,e),n=i.apply(0,n),a=i.apply(0,a),{x:t,y:e,x2:n,y2:a,width:n-t,height:a-e,cx:t+(n-t)/2,cy:e+(a-e)/2}},o.clone=function(t){t=new a;for(var e=0,n=this.items.length;n>e;e++)t.push(this.items[e].clone());return t},o.toString=function(){return"Snap‘s set"},o.type="set",t.set=function(){var t=new a;return arguments.length&&t.push.apply(t,Array.prototype.slice.call(arguments,0)),t}}),i.plugin(function(t,n){function i(t){var e=t[0];switch(e.toLowerCase()){case"t":return[e,0,0];case"m":return[e,1,0,0,1,0,0];case"r":return 4==t.length?[e,0,t[2],t[3]]:[e,0];case"s":return 5==t.length?[e,1,1,t[3],t[4]]:3==t.length?[e,1,1]:[e,1]}}function r(e,n,r){n=d(n).replace(/\.{3}|\u2026/g,e),e=t.parseTransformString(e)||[],n=t.parseTransformString(n)||[];for(var a,o,s,h,u=Math.max(e.length,n.length),p=[],f=[],m=0;u>m;m++){if(s=e[m]||i(n[m]),h=n[m]||i(s),s[0]!=h[0]||"r"==s[0].toLowerCase()&&(s[2]!=h[2]||s[3]!=h[3])||"s"==s[0].toLowerCase()&&(s[3]!=h[3]||s[4]!=h[4])){e=t._.transform2matrix(e,r()),n=t._.transform2matrix(n,r()),p=[["m",e.a,e.b,e.c,e.d,e.e,e.f]],f=[["m",n.a,n.b,n.c,n.d,n.e,n.f]];break}for(p[m]=[],f[m]=[],a=0,o=Math.max(s.length,h.length);o>a;a++)a in s&&(p[m][a]=s[a]),a in h&&(f[m][a]=h[a])}return{from:l(p),to:l(f),f:c(p)}}function a(t){return t}function o(t){return function(e){return+e.toFixed(3)+t}}function s(e){return t.rgb(e[0],e[1],e[2])}function c(t){var e,n,i,r,a,o,s=0,c=[];for(e=0,n=t.length;n>e;e++){for(a="[",o=['"'+t[e][0]+'"'],i=1,r=t[e].length;r>i;i++)o[i]="val["+s++ +"]";a+=o+"]",c[e]=a}return Function("val","return Snap.path.toString.call(["+c+"])")}function l(t){for(var e=[],n=0,i=t.length;i>n;n++)for(var r=1,a=t[n].length;a>r;r++)e.push(t[n][r]);return e}var h={},u=/[a-z]+$/i,d=String;h.stroke=h.fill="colour",n.prototype.equal=function(t,n){return e("snap.util.equal",this,t,n).firstDefined()},e.on("snap.util.equal",function(e,n){var i,p,f=d(this.attr(e)||""),m=this;if(f==+f&&n==+n)return{from:+f,to:+n,f:a};if("colour"==h[e])return i=t.color(f),p=t.color(n),{from:[i.r,i.g,i.b,i.opacity],to:[p.r,p.g,p.b,p.opacity],f:s};if("transform"==e||"gradientTransform"==e||"patternTransform"==e)return n instanceof t.Matrix&&(n=n.toTransformString()),t._.rgTransform.test(n)||(n=t._.svgTransform2string(n)),r(f,n,function(){return m.getBBox(1)});if("d"==e||"path"==e)return i=t.path.toCubic(f,n),{from:l(i[0]),to:l(i[1]),f:c(i[0])};if("points"==e)return i=d(f).split(t._.separator),p=d(n).split(t._.separator),{from:i,to:p,f:function(t){return t}};aUnit=f.match(u);var g=d(n).match(u);return aUnit&&aUnit==g?{from:parseFloat(f),to:parseFloat(n),f:o(aUnit)}:{from:this.asPX(e),to:this.asPX(e,n),f:a}})}),i.plugin(function(t,n,i,r){for(var a=n.prototype,o="hasOwnProperty",s=("createTouch"in r.doc),c=["click","dblclick","mousedown","mousemove","mouseout","mouseover","mouseup","touchstart","touchmove","touchend","touchcancel"],l={mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"},h=(function(t,e){var n="y"==t?"scrollTop":"scrollLeft",i=e&&e.node?e.node.ownerDocument:r.doc;return i[n in i.documentElement?"documentElement":"body"][n]}),u=function(){this.returnValue=!1},d=function(){return this.originalEvent.preventDefault()},p=function(){this.cancelBubble=!0},f=function(){return this.originalEvent.stopPropagation()},m=function(){return r.doc.addEventListener?function(t,e,n,i){var r=s&&l[e]?l[e]:e,a=function(r){var a=h("y",i),c=h("x",i);if(s&&l[o](e))for(var u=0,p=r.targetTouches&&r.targetTouches.length;p>u;u++)if(r.targetTouches[u].target==t||t.contains(r.targetTouches[u].target)){var m=r;r=r.targetTouches[u],r.originalEvent=m,r.preventDefault=d,r.stopPropagation=f;break}var g=r.clientX+c,v=r.clientY+a;return n.call(i,r,g,v)};return e!==r&&t.addEventListener(e,a,!1),t.addEventListener(r,a,!1),function(){return e!==r&&t.removeEventListener(e,a,!1),t.removeEventListener(r,a,!1),!0}}:r.doc.attachEvent?function(t,e,n,i){var r=function(t){t=t||i.node.ownerDocument.window.event;var e=h("y",i),r=h("x",i),a=t.clientX+r,o=t.clientY+e;return t.preventDefault=t.preventDefault||u,t.stopPropagation=t.stopPropagation||p,n.call(i,t,a,o)};t.attachEvent("on"+e,r);var a=function(){return t.detachEvent("on"+e,r),!0};return a}:void 0}(),g=[],v=function(t){for(var n,i=t.clientX,r=t.clientY,a=h("y"),o=h("x"),c=g.length;c--;){if(n=g[c],s){for(var l,u=t.touches&&t.touches.length;u--;)if(l=t.touches[u],l.identifier==n.el._drag.id||n.el.node.contains(l.target)){i=l.clientX,r=l.clientY,(t.originalEvent?t.originalEvent:t).preventDefault();break}}else t.preventDefault();var d=n.el.node;d.nextSibling,d.parentNode,d.style.display,i+=o,r+=a,e("snap.drag.move."+n.el.id,n.move_scope||n.el,i-n.el._drag.x,r-n.el._drag.y,i,r,t)}},y=function(n){t.unmousemove(v).unmouseup(y);for(var i,r=g.length;r--;)i=g[r],i.el._drag={},e("snap.drag.end."+i.el.id,i.end_scope||i.start_scope||i.move_scope||i.el,n);g=[]},x=c.length;x--;)!function(e){t[e]=a[e]=function(n,i){return t.is(n,"function")&&(this.events=this.events||[],this.events.push({name:e,f:n,unbind:m(this.node||document,e,n,i||this)})),this},t["un"+e]=a["un"+e]=function(t){for(var n=this.events||[],i=n.length;i--;)if(n[i].name==e&&(n[i].f==t||!t))return n[i].unbind(),n.splice(i,1),!n.length&&delete this.events,this;return this}}(c[x]);a.hover=function(t,e,n,i){return this.mouseover(t,n).mouseout(e,i||n)},a.unhover=function(t,e){return this.unmouseover(t).unmouseout(e)};var b=[];a.drag=function(n,i,r,a,o,s){function c(c,l,h){(c.originalEvent||c).preventDefault(),this._drag.x=l,this._drag.y=h,this._drag.id=c.identifier,!g.length&&t.mousemove(v).mouseup(y),g.push({el:this,move_scope:a,start_scope:o,end_scope:s}),i&&e.on("snap.drag.start."+this.id,i),n&&e.on("snap.drag.move."+this.id,n),r&&e.on("snap.drag.end."+this.id,r),e("snap.drag.start."+this.id,o||a||this,l,h,c)}if(!arguments.length){var l;return this.drag(function(t,e){this.attr({transform:l+(l?"T":"t")+[t,e]})},function(){l=this.transform().local})}return this._drag={},b.push({el:this,start:c}),this.mousedown(c),this},a.undrag=function(){for(var n=b.length;n--;)b[n].el==this&&(this.unmousedown(b[n].start),b.splice(n,1),e.unbind("snap.drag.*."+this.id));return!b.length&&t.unmousemove(v).unmouseup(y),this}}),i.plugin(function(t,n,i){var r=(n.prototype,i.prototype),a=/^\s*url\((.+)\)/,o=String,s=t._.$;t.filter={},r.filter=function(e){var i=this;"svg"!=i.type&&(i=i.paper);var r=t.parse(o(e)),a=t._.id(),c=(i.node.offsetWidth,i.node.offsetHeight,s("filter"));return s(c,{id:a,filterUnits:"userSpaceOnUse"}),c.appendChild(r.node),i.defs.appendChild(c),new n(c)},e.on("snap.util.getattr.filter",function(){e.stop();var n=s(this.node,"filter");if(n){var i=o(n).match(a);return i&&t.select(i[1])}}),e.on("snap.util.attr.filter",function(i){if(i instanceof n&&"filter"==i.type){e.stop();var r=i.node.id;r||(s(i.node,{id:i.id}),r=i.id),s(this.node,{filter:t.url(r)})}i&&"none"!=i||(e.stop(),this.node.removeAttribute("filter"))}),t.filter.blur=function(e,n){null==e&&(e=2);var i=null==n?e:[e,n];return t.format('<feGaussianBlur stdDeviation="{def}"/>',{def:i})},t.filter.blur.toString=function(){return this()},t.filter.shadow=function(e,n,i,r,a){return"string"==typeof i&&(r=i,a=r,i=4),"string"!=typeof r&&(a=r,r="#000"),r=r||"#000",null==i&&(i=4),null==a&&(a=1),null==e&&(e=0,n=2),null==n&&(n=e),r=t.color(r),t.format('<feGaussianBlur in="SourceAlpha" stdDeviation="{blur}"/><feOffset dx="{dx}" dy="{dy}" result="offsetblur"/><feFlood flood-color="{color}"/><feComposite in2="offsetblur" operator="in"/><feComponentTransfer><feFuncA type="linear" slope="{opacity}"/></feComponentTransfer><feMerge><feMergeNode/><feMergeNode in="SourceGraphic"/></feMerge>',{color:r,dx:e,dy:n,blur:i,opacity:a})},t.filter.shadow.toString=function(){return this()},t.filter.grayscale=function(e){return null==e&&(e=1),t.format('<feColorMatrix type="matrix" values="{a} {b} {c} 0 0 {d} {e} {f} 0 0 {g} {b} {h} 0 0 0 0 0 1 0"/>',{a:.2126+.7874*(1-e),b:.7152-.7152*(1-e),c:.0722-.0722*(1-e),d:.2126-.2126*(1-e),e:.7152+.2848*(1-e),f:.0722-.0722*(1-e),g:.2126-.2126*(1-e),h:.0722+.9278*(1-e)})},t.filter.grayscale.toString=function(){return this()},t.filter.sepia=function(e){return null==e&&(e=1),t.format('<feColorMatrix type="matrix" values="{a} {b} {c} 0 0 {d} {e} {f} 0 0 {g} {h} {i} 0 0 0 0 0 1 0"/>',{a:.393+.607*(1-e),b:.769-.769*(1-e),c:.189-.189*(1-e),d:.349-.349*(1-e),e:.686+.314*(1-e),f:.168-.168*(1-e),g:.272-.272*(1-e),h:.534-.534*(1-e),i:.131+.869*(1-e)})},t.filter.sepia.toString=function(){return this()},t.filter.saturate=function(e){return null==e&&(e=1),t.format('<feColorMatrix type="saturate" values="{amount}"/>',{amount:1-e})},t.filter.saturate.toString=function(){return this()},t.filter.hueRotate=function(e){return e=e||0,t.format('<feColorMatrix type="hueRotate" values="{angle}"/>',{angle:e})},t.filter.hueRotate.toString=function(){return this()},t.filter.invert=function(e){return null==e&&(e=1),t.format('<feComponentTransfer><feFuncR type="table" tableValues="{amount} {amount2}"/><feFuncG type="table" tableValues="{amount} {amount2}"/><feFuncB type="table" tableValues="{amount} {amount2}"/></feComponentTransfer>',{amount:e,amount2:1-e})},t.filter.invert.toString=function(){return this()},t.filter.brightness=function(e){return null==e&&(e=1),t.format('<feComponentTransfer><feFuncR type="linear" slope="{amount}"/><feFuncG type="linear" slope="{amount}"/><feFuncB type="linear" slope="{amount}"/></feComponentTransfer>',{amount:e})},t.filter.brightness.toString=function(){return this()},t.filter.contrast=function(e){return null==e&&(e=1),t.format('<feComponentTransfer><feFuncR type="linear" slope="{amount}" intercept="{amount2}"/><feFuncG type="linear" slope="{amount}" intercept="{amount2}"/><feFuncB type="linear" slope="{amount}" intercept="{amount2}"/></feComponentTransfer>',{amount:e,amount2:.5-e/2})},t.filter.contrast.toString=function(){return this()}}),i}),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.THREE=t.THREE||{})}(this,function(t){function e(){}function n(t,e){this.x=t||0,this.y=e||0}function i(e,r,a,o,s,c,l,h,u,d){Object.defineProperty(this,"id",{value:zi++}),this.uuid=t.Math.generateUUID(),this.sourceFile=this.name="",this.image=void 0!==e?e:i.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==r?r:i.DEFAULT_MAPPING,this.wrapS=void 0!==a?a:1001,this.wrapT=void 0!==o?o:1001,this.magFilter=void 0!==s?s:1006,this.minFilter=void 0!==c?c:1008,this.anisotropy=void 0!==u?u:1,this.format=void 0!==l?l:1023,this.type=void 0!==h?h:1009,this.offset=new n(0,0),this.repeat=new n(1,1),this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==d?d:3e3,this.version=0,this.onUpdate=null}function r(t,e,n,i){this.x=t||0,this.y=e||0,this.z=n||0,this.w=void 0!==i?i:1}function a(e,n,a){this.uuid=t.Math.generateUUID(),this.width=e,this.height=n,this.scissor=new r(0,0,e,n),this.scissorTest=!1,this.viewport=new r(0,0,e,n),a=a||{},void 0===a.minFilter&&(a.minFilter=1006),this.texture=new i((void 0),(void 0),a.wrapS,a.wrapT,a.magFilter,a.minFilter,a.format,a.type,a.anisotropy,a.encoding),this.depthBuffer=void 0===a.depthBuffer||a.depthBuffer,this.stencilBuffer=void 0===a.stencilBuffer||a.stencilBuffer,this.depthTexture=void 0!==a.depthTexture?a.depthTexture:null}function o(t,e,n){a.call(this,t,e,n),this.activeMipMapLevel=this.activeCubeFace=0}function s(t,e,n,i){this._x=t||0,this._y=e||0,this._z=n||0,this._w=void 0!==i?i:1}function c(t,e,n){this.x=t||0,this.y=e||0,this.z=n||0}function l(){this.elements=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),0<arguments.length&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}function h(t,e,n,r,a,o,s,c,l,h){t=void 0!==t?t:[],i.call(this,t,void 0!==e?e:301,n,r,a,o,s,c,l,h),this.flipY=!1}function u(t,e,n){var i=t[0];if(0>=i||0<i)return t;var r=e*n,a=ki[r];if(void 0===a&&(a=new Float32Array(r),ki[r]=a),0!==e)for(i.toArray(a,0),i=1,r=0;i!==e;++i)r+=n,t[i].toArray(a,r);return a}function d(t,e){var n=Vi[e];void 0===n&&(n=new Int32Array(e),Vi[e]=n);for(var i=0;i!==e;++i)n[i]=t.allocTextureUnit();return n}function p(t,e){t.uniform1f(this.addr,e)}function f(t,e){t.uniform1i(this.addr,e)}function m(t,e){void 0===e.x?t.uniform2fv(this.addr,e):t.uniform2f(this.addr,e.x,e.y)}function g(t,e){void 0!==e.x?t.uniform3f(this.addr,e.x,e.y,e.z):void 0!==e.r?t.uniform3f(this.addr,e.r,e.g,e.b):t.uniform3fv(this.addr,e)}function v(t,e){void 0===e.x?t.uniform4fv(this.addr,e):t.uniform4f(this.addr,e.x,e.y,e.z,e.w)}function y(t,e){t.uniformMatrix2fv(this.addr,!1,e.elements||e)}function x(t,e){t.uniformMatrix3fv(this.addr,!1,e.elements||e)}function b(t,e){t.uniformMatrix4fv(this.addr,!1,e.elements||e)}function w(t,e,n){var i=n.allocTextureUnit();t.uniform1i(this.addr,i),n.setTexture2D(e||Hi,i)}function _(t,e,n){var i=n.allocTextureUnit();t.uniform1i(this.addr,i),n.setTextureCube(e||Gi,i)}function M(t,e){t.uniform2iv(this.addr,e)}function E(t,e){t.uniform3iv(this.addr,e)}function T(t,e){t.uniform4iv(this.addr,e)}function S(t){switch(t){case 5126:return p;case 35664:return m;case 35665:return g;case 35666:return v;case 35674:return y;case 35675:return x;case 35676:return b;case 35678:return w;case 35680:return _;case 5124:case 35670:return f;case 35667:case 35671:return M;case 35668:case 35672:return E;case 35669:case 35673:return T}}function A(t,e){t.uniform1fv(this.addr,e)}function R(t,e){t.uniform1iv(this.addr,e)}function L(t,e){t.uniform2fv(this.addr,u(e,this.size,2))}function C(t,e){t.uniform3fv(this.addr,u(e,this.size,3))}function P(t,e){t.uniform4fv(this.addr,u(e,this.size,4))}function I(t,e){t.uniformMatrix2fv(this.addr,!1,u(e,this.size,4))}function U(t,e){t.uniformMatrix3fv(this.addr,!1,u(e,this.size,9))}function N(t,e){t.uniformMatrix4fv(this.addr,!1,u(e,this.size,16))}function D(t,e,n){var i=e.length,r=d(n,i);for(t.uniform1iv(this.addr,r),t=0;t!==i;++t)n.setTexture2D(e[t]||Hi,r[t])}function F(t,e,n){var i=e.length,r=d(n,i);for(t.uniform1iv(this.addr,r),t=0;t!==i;++t)n.setTextureCube(e[t]||Gi,r[t])}function O(t){switch(t){case 5126:return A;case 35664:return L;case 35665:return C;case 35666:return P;case 35674:return I;case 35675:return U;case 35676:return N;case 35678:return D;case 35680:return F;case 5124:case 35670:return R;case 35667:case 35671:return M;case 35668:case 35672:return E;case 35669:case 35673:return T}}function B(t,e,n){this.id=t,this.addr=n,this.setValue=S(e.type)}function z(t,e,n){this.id=t,this.addr=n,this.size=e.size,this.setValue=O(e.type)}function H(t){this.id=t,this.seq=[],this.map={}}function G(t,e,n){this.seq=[],this.map={},this.renderer=n,n=t.getProgramParameter(e,t.ACTIVE_UNIFORMS);for(var i=0;i!==n;++i){var r=t.getActiveUniform(e,i),a=t.getUniformLocation(e,r.name),o=this,s=r.name,c=s.length;for(ji.lastIndex=0;;){var l=ji.exec(s),h=ji.lastIndex,u=l[1],d=l[3];if("]"===l[2]&&(u|=0),void 0===d||"["===d&&h+2===c){s=o,r=void 0===d?new B(u,r,a):new z(u,r,a),s.seq.push(r),s.map[r.id]=r;break}d=o.map[u],void 0===d&&(d=new H(u),u=o,o=d,u.seq.push(o),u.map[o.id]=o),o=d}}}function k(t,e,n){return void 0===e&&void 0===n?this.set(t):this.setRGB(t,e,n)}function V(t,e){this.min=void 0!==t?t:new n(1/0,1/0),this.max=void 0!==e?e:new n((-(1/0)),(-(1/0)))}function j(t,e){var i,r,a,o,s,l,h,u,d,p,f,m,g,v,y,x,b=t.context,w=t.state;this.render=function(_,M,E){if(0!==e.length){_=new c;var T=E.w/E.z,S=.5*E.z,A=.5*E.w,R=16/E.w,L=new n(R*T,R),C=new c(1,1,0),P=new n(1,1),I=new V;if(I.min.set(0,0),I.max.set(E.z-16,E.w-16),void 0===v){var R=new Float32Array([-1,-1,0,0,1,-1,1,0,1,1,1,1,-1,1,0,1]),U=new Uint16Array([0,1,2,0,2,3]);f=b.createBuffer(),m=b.createBuffer(),b.bindBuffer(b.ARRAY_BUFFER,f),b.bufferData(b.ARRAY_BUFFER,R,b.STATIC_DRAW),b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,m),b.bufferData(b.ELEMENT_ARRAY_BUFFER,U,b.STATIC_DRAW),y=b.createTexture(),x=b.createTexture(),w.bindTexture(b.TEXTURE_2D,y),b.texImage2D(b.TEXTURE_2D,0,b.RGB,16,16,0,b.RGB,b.UNSIGNED_BYTE,null),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.NEAREST),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.NEAREST),w.bindTexture(b.TEXTURE_2D,x),b.texImage2D(b.TEXTURE_2D,0,b.RGBA,16,16,0,b.RGBA,b.UNSIGNED_BYTE,null),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.NEAREST),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.NEAREST);var R=g={vertexShader:"uniform lowp int renderType;\nuniform vec3 screenPosition;\nuniform vec2 scale;\nuniform float rotation;\nuniform sampler2D occlusionMap;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvarying float vVisibility;\nvoid main() {\nvUV = uv;\nvec2 pos = position;\nif ( renderType == 2 ) {\nvec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );\nvVisibility =        visibility.r / 9.0;\nvVisibility *= 1.0 - visibility.g / 9.0;\nvVisibility *=       visibility.b / 9.0;\nvVisibility *= 1.0 - visibility.a / 9.0;\npos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;\npos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;\n}\ngl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\n}",
fragmentShader:"uniform lowp int renderType;\nuniform sampler2D map;\nuniform float opacity;\nuniform vec3 color;\nvarying vec2 vUV;\nvarying float vVisibility;\nvoid main() {\nif ( renderType == 0 ) {\ngl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );\n} else if ( renderType == 1 ) {\ngl_FragColor = texture2D( map, vUV );\n} else {\nvec4 texture = texture2D( map, vUV );\ntexture.a *= opacity * vVisibility;\ngl_FragColor = texture;\ngl_FragColor.rgb *= color;\n}\n}"},U=b.createProgram(),N=b.createShader(b.FRAGMENT_SHADER),D=b.createShader(b.VERTEX_SHADER),F="precision "+t.getPrecision()+" float;\n";b.shaderSource(N,F+R.fragmentShader),b.shaderSource(D,F+R.vertexShader),b.compileShader(N),b.compileShader(D),b.attachShader(U,N),b.attachShader(U,D),b.linkProgram(U),v=U,d=b.getAttribLocation(v,"position"),p=b.getAttribLocation(v,"uv"),i=b.getUniformLocation(v,"renderType"),r=b.getUniformLocation(v,"map"),a=b.getUniformLocation(v,"occlusionMap"),o=b.getUniformLocation(v,"opacity"),s=b.getUniformLocation(v,"color"),l=b.getUniformLocation(v,"scale"),h=b.getUniformLocation(v,"rotation"),u=b.getUniformLocation(v,"screenPosition")}for(b.useProgram(v),w.initAttributes(),w.enableAttribute(d),w.enableAttribute(p),w.disableUnusedAttributes(),b.uniform1i(a,0),b.uniform1i(r,1),b.bindBuffer(b.ARRAY_BUFFER,f),b.vertexAttribPointer(d,2,b.FLOAT,!1,16,0),b.vertexAttribPointer(p,2,b.FLOAT,!1,16,8),b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,m),w.disable(b.CULL_FACE),w.setDepthWrite(!1),U=0,N=e.length;U<N;U++)if(R=16/E.w,L.set(R*T,R),D=e[U],_.set(D.matrixWorld.elements[12],D.matrixWorld.elements[13],D.matrixWorld.elements[14]),_.applyMatrix4(M.matrixWorldInverse),_.applyProjection(M.projectionMatrix),C.copy(_),P.x=E.x+C.x*S+S-8,P.y=E.y+C.y*A+A-8,!0===I.containsPoint(P)){w.activeTexture(b.TEXTURE0),w.bindTexture(b.TEXTURE_2D,null),w.activeTexture(b.TEXTURE1),w.bindTexture(b.TEXTURE_2D,y),b.copyTexImage2D(b.TEXTURE_2D,0,b.RGB,P.x,P.y,16,16,0),b.uniform1i(i,0),b.uniform2f(l,L.x,L.y),b.uniform3f(u,C.x,C.y,C.z),w.disable(b.BLEND),w.enable(b.DEPTH_TEST),b.drawElements(b.TRIANGLES,6,b.UNSIGNED_SHORT,0),w.activeTexture(b.TEXTURE0),w.bindTexture(b.TEXTURE_2D,x),b.copyTexImage2D(b.TEXTURE_2D,0,b.RGBA,P.x,P.y,16,16,0),b.uniform1i(i,1),w.disable(b.DEPTH_TEST),w.activeTexture(b.TEXTURE1),w.bindTexture(b.TEXTURE_2D,y),b.drawElements(b.TRIANGLES,6,b.UNSIGNED_SHORT,0),D.positionScreen.copy(C),D.customUpdateCallback?D.customUpdateCallback(D):D.updateLensFlares(),b.uniform1i(i,2),w.enable(b.BLEND);for(var F=0,O=D.lensFlares.length;F<O;F++){var B=D.lensFlares[F];.001<B.opacity&&.001<B.scale&&(C.x=B.x,C.y=B.y,C.z=B.z,R=B.size*B.scale/E.w,L.x=R*T,L.y=R,b.uniform3f(u,C.x,C.y,C.z),b.uniform2f(l,L.x,L.y),b.uniform1f(h,B.rotation),b.uniform1f(o,B.opacity),b.uniform3f(s,B.color.r,B.color.g,B.color.b),w.setBlending(B.blending,B.blendEquation,B.blendSrc,B.blendDst),t.setTexture2D(B.texture,1),b.drawElements(b.TRIANGLES,6,b.UNSIGNED_SHORT,0))}}w.enable(b.CULL_FACE),w.enable(b.DEPTH_TEST),w.setDepthWrite(!0),t.resetGLState()}}}function W(t,e){function n(t,e){return t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:e.id-t.id}var r,a,o,l,h,u,d,p,f,m,g,v,y,x,b,w,_,M,E,T,S,A=t.context,R=t.state,L=new c,C=new s,P=new c;this.render=function(s,c){if(0!==e.length){if(void 0===T){var I=new Float32Array([-.5,-.5,0,0,.5,-.5,1,0,.5,.5,1,1,-.5,.5,0,1]),U=new Uint16Array([0,1,2,0,2,3]);M=A.createBuffer(),E=A.createBuffer(),A.bindBuffer(A.ARRAY_BUFFER,M),A.bufferData(A.ARRAY_BUFFER,I,A.STATIC_DRAW),A.bindBuffer(A.ELEMENT_ARRAY_BUFFER,E),A.bufferData(A.ELEMENT_ARRAY_BUFFER,U,A.STATIC_DRAW);var I=A.createProgram(),U=A.createShader(A.VERTEX_SHADER),N=A.createShader(A.FRAGMENT_SHADER);A.shaderSource(U,["precision "+t.getPrecision()+" float;","uniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform float rotation;\nuniform vec2 scale;\nuniform vec2 uvOffset;\nuniform vec2 uvScale;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvoid main() {\nvUV = uvOffset + uv * uvScale;\nvec2 alignedPosition = position * scale;\nvec2 rotatedPosition;\nrotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\nrotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\nvec4 finalPosition;\nfinalPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\nfinalPosition.xy += rotatedPosition;\nfinalPosition = projectionMatrix * finalPosition;\ngl_Position = finalPosition;\n}"].join("\n")),A.shaderSource(N,["precision "+t.getPrecision()+" float;","uniform vec3 color;\nuniform sampler2D map;\nuniform float opacity;\nuniform int fogType;\nuniform vec3 fogColor;\nuniform float fogDensity;\nuniform float fogNear;\nuniform float fogFar;\nuniform float alphaTest;\nvarying vec2 vUV;\nvoid main() {\nvec4 texture = texture2D( map, vUV );\nif ( texture.a < alphaTest ) discard;\ngl_FragColor = vec4( color * texture.xyz, texture.a * opacity );\nif ( fogType > 0 ) {\nfloat depth = gl_FragCoord.z / gl_FragCoord.w;\nfloat fogFactor = 0.0;\nif ( fogType == 1 ) {\nfogFactor = smoothstep( fogNear, fogFar, depth );\n} else {\nconst float LOG2 = 1.442695;\nfogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );\nfogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );\n}\ngl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );\n}\n}"].join("\n")),A.compileShader(U),A.compileShader(N),A.attachShader(I,U),A.attachShader(I,N),A.linkProgram(I),T=I,w=A.getAttribLocation(T,"position"),_=A.getAttribLocation(T,"uv"),r=A.getUniformLocation(T,"uvOffset"),a=A.getUniformLocation(T,"uvScale"),o=A.getUniformLocation(T,"rotation"),l=A.getUniformLocation(T,"scale"),h=A.getUniformLocation(T,"color"),u=A.getUniformLocation(T,"map"),d=A.getUniformLocation(T,"opacity"),p=A.getUniformLocation(T,"modelViewMatrix"),f=A.getUniformLocation(T,"projectionMatrix"),m=A.getUniformLocation(T,"fogType"),g=A.getUniformLocation(T,"fogDensity"),v=A.getUniformLocation(T,"fogNear"),y=A.getUniformLocation(T,"fogFar"),x=A.getUniformLocation(T,"fogColor"),b=A.getUniformLocation(T,"alphaTest"),I=document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),I.width=8,I.height=8,U=I.getContext("2d"),U.fillStyle="white",U.fillRect(0,0,8,8),S=new i(I),S.needsUpdate=!0}A.useProgram(T),R.initAttributes(),R.enableAttribute(w),R.enableAttribute(_),R.disableUnusedAttributes(),R.disable(A.CULL_FACE),R.enable(A.BLEND),A.bindBuffer(A.ARRAY_BUFFER,M),A.vertexAttribPointer(w,2,A.FLOAT,!1,16,0),A.vertexAttribPointer(_,2,A.FLOAT,!1,16,8),A.bindBuffer(A.ELEMENT_ARRAY_BUFFER,E),A.uniformMatrix4fv(f,!1,c.projectionMatrix.elements),R.activeTexture(A.TEXTURE0),A.uniform1i(u,0),U=I=0,(N=s.fog)?(A.uniform3f(x,N.color.r,N.color.g,N.color.b),N&&N.isFog?(A.uniform1f(v,N.near),A.uniform1f(y,N.far),A.uniform1i(m,1),U=I=1):N&&N.isFogExp2&&(A.uniform1f(g,N.density),A.uniform1i(m,2),U=I=2)):(A.uniform1i(m,0),U=I=0);for(var N=0,D=e.length;N<D;N++){var F=e[N];F.modelViewMatrix.multiplyMatrices(c.matrixWorldInverse,F.matrixWorld),F.z=-F.modelViewMatrix.elements[14]}e.sort(n);for(var O=[],N=0,D=e.length;N<D;N++){var F=e[N],B=F.material;!1!==B.visible&&(A.uniform1f(b,B.alphaTest),A.uniformMatrix4fv(p,!1,F.modelViewMatrix.elements),F.matrixWorld.decompose(L,C,P),O[0]=P.x,O[1]=P.y,F=0,s.fog&&B.fog&&(F=U),I!==F&&(A.uniform1i(m,F),I=F),null!==B.map?(A.uniform2f(r,B.map.offset.x,B.map.offset.y),A.uniform2f(a,B.map.repeat.x,B.map.repeat.y)):(A.uniform2f(r,0,0),A.uniform2f(a,1,1)),A.uniform1f(d,B.opacity),A.uniform3f(h,B.color.r,B.color.g,B.color.b),A.uniform1f(o,B.rotation),A.uniform2fv(l,O),R.setBlending(B.blending,B.blendEquation,B.blendSrc,B.blendDst),R.setDepthTest(B.depthTest),R.setDepthWrite(B.depthWrite),B.map?t.setTexture2D(B.map,0):t.setTexture2D(S,0),A.drawElements(A.TRIANGLES,6,A.UNSIGNED_SHORT,0))}R.enable(A.CULL_FACE),t.resetGLState()}}}function X(){Object.defineProperty(this,"id",{value:Yi++}),this.uuid=t.Math.generateUUID(),this.name="",this.type="Material",this.lights=this.fog=!0,this.blending=1,this.side=0,this.shading=2,this.vertexColors=0,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendEquationAlpha=this.blendDstAlpha=this.blendSrcAlpha=null,this.depthFunc=3,this.depthWrite=this.depthTest=!0,this.clippingPlanes=null,this.clipShadows=!1,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.alphaTest=this.polygonOffsetUnits=this.polygonOffsetFactor=0,this.premultipliedAlpha=!1,this.overdraw=0,this._needsUpdate=this.visible=!0}function q(t){X.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.morphNormals=this.morphTargets=this.skinning=this.clipping=this.lights=this.fog=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,void 0!==t&&(void 0!==t.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(t))}function Y(t){X.call(this),this.type="MeshDepthMaterial",this.depthPacking=3200,this.morphTargets=this.skinning=!1,this.displacementMap=this.alphaMap=this.map=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.lights=this.fog=!1,this.setValues(t)}function Z(t,e){this.min=void 0!==t?t:new c(1/0,1/0,1/0),this.max=void 0!==e?e:new c((-(1/0)),(-(1/0)),(-(1/0)))}function J(t,e){this.center=void 0!==t?t:new c,this.radius=void 0!==e?e:0}function Q(){this.elements=new Float32Array([1,0,0,0,1,0,0,0,1]),0<arguments.length&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}function K(t,e){this.normal=void 0!==t?t:new c(1,0,0),this.constant=void 0!==e?e:0}function $(t,e,n,i,r,a){this.planes=[void 0!==t?t:new K,void 0!==e?e:new K,void 0!==n?n:new K,void 0!==i?i:new K,void 0!==r?r:new K,void 0!==a?a:new K]}function tt(e,i,o,s){function h(t,n,i,r){var a,o=t.geometry;a=_;var s=t.customDepthMaterial;return i&&(a=M,s=t.customDistanceMaterial),s?a=s:(s=!1,n.morphTargets&&(o&&o.isBufferGeometry?s=o.morphAttributes&&o.morphAttributes.position&&0<o.morphAttributes.position.length:o&&o.isGeometry&&(s=o.morphTargets&&0<o.morphTargets.length)),t=t.isSkinnedMesh&&n.skinning,o=0,s&&(o|=1),t&&(o|=2),a=a[o]),e.localClippingEnabled&&!0===n.clipShadows&&0!==n.clippingPlanes.length&&(o=a.uuid,s=n.uuid,t=E[o],void 0===t&&(t={},E[o]=t),o=t[s],void 0===o&&(o=a.clone(),t[s]=o),a=o),a.visible=n.visible,a.wireframe=n.wireframe,s=n.side,U.renderSingleSided&&2==s&&(s=0),U.renderReverseSided&&(0===s?s=1:1===s&&(s=0)),a.side=s,a.clipShadows=n.clipShadows,a.clippingPlanes=n.clippingPlanes,a.wireframeLinewidth=n.wireframeLinewidth,a.linewidth=n.linewidth,i&&void 0!==a.uniforms.lightPos&&a.uniforms.lightPos.value.copy(r),a}function u(t,e,n){if(!1!==t.visible){0!==(t.layers.mask&e.layers.mask)&&(t.isMesh||t.isLine||t.isPoints)&&t.castShadow&&(!1===t.frustumCulled||!0===f.intersectsObject(t))&&!0===t.material.visible&&(t.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,t.matrixWorld),w.push(t)),t=t.children;for(var i=0,r=t.length;i<r;i++)u(t[i],e,n)}}var d=e.context,p=e.state,f=new $,m=new l,g=i.shadows,v=new n,y=new n(s.maxTextureSize,s.maxTextureSize),x=new c,b=new c,w=[],_=Array(4),M=Array(4),E={},T=[new c(1,0,0),new c((-1),0,0),new c(0,0,1),new c(0,0,(-1)),new c(0,1,0),new c(0,(-1),0)],S=[new c(0,1,0),new c(0,1,0),new c(0,1,0),new c(0,1,0),new c(0,0,1),new c(0,0,(-1))],A=[new r,new r,new r,new r,new r,new r];i=new Y,i.depthPacking=3201,i.clipping=!0,s=qi.distanceRGBA;for(var R=t.UniformsUtils.clone(s.uniforms),L=0;4!==L;++L){var C=0!==(1&L),P=0!==(2&L),I=i.clone();I.morphTargets=C,I.skinning=P,_[L]=I,C=new q({defines:{USE_SHADOWMAP:""},uniforms:R,vertexShader:s.vertexShader,fragmentShader:s.fragmentShader,morphTargets:C,skinning:P,clipping:!0}),M[L]=C}var U=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1,this.renderSingleSided=this.renderReverseSided=!0,this.render=function(t,n){if(!1!==U.enabled&&(!1!==U.autoUpdate||!1!==U.needsUpdate)&&0!==g.length){p.clearColor(1,1,1,1),p.disable(d.BLEND),p.setDepthTest(!0),p.setScissorTest(!1);for(var i,r,s=0,c=g.length;s<c;s++){var l=g[s],_=l.shadow;if(void 0===_)console.warn("THREE.WebGLShadowMap:",l,"has no shadow.");else{var M=_.camera;if(v.copy(_.mapSize),v.min(y),l&&l.isPointLight){i=6,r=!0;var E=v.x,R=v.y;A[0].set(2*E,R,E,R),A[1].set(0,R,E,R),A[2].set(3*E,R,E,R),A[3].set(E,R,E,R),A[4].set(3*E,0,E,R),A[5].set(E,0,E,R),v.x*=4,v.y*=2}else i=1,r=!1;for(null===_.map&&(_.map=new a(v.x,v.y,{minFilter:1003,magFilter:1003,format:1023}),M.updateProjectionMatrix()),_&&_.isSpotLightShadow&&_.update(l),E=_.map,_=_.matrix,b.setFromMatrixPosition(l.matrixWorld),M.position.copy(b),e.setRenderTarget(E),e.clear(),E=0;E<i;E++){r?(x.copy(M.position),x.add(T[E]),M.up.copy(S[E]),M.lookAt(x),p.viewport(A[E])):(x.setFromMatrixPosition(l.target.matrixWorld),M.lookAt(x)),M.updateMatrixWorld(),M.matrixWorldInverse.getInverse(M.matrixWorld),_.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),_.multiply(M.projectionMatrix),_.multiply(M.matrixWorldInverse),m.multiplyMatrices(M.projectionMatrix,M.matrixWorldInverse),f.setFromMatrix(m),w.length=0,u(t,n,M);for(var R=0,L=w.length;R<L;R++){var C=w[R],P=o.update(C),I=C.material;if(I&&I.isMultiMaterial)for(var N=P.groups,I=I.materials,D=0,F=N.length;D<F;D++){var O=N[D],B=I[O.materialIndex];!0===B.visible&&(B=h(C,B,r,b),e.renderBufferDirect(M,null,P,B,C,O))}else B=h(C,I,r,b),e.renderBufferDirect(M,null,P,B,C,null)}}}}i=e.getClearColor(),r=e.getClearAlpha(),e.setClearColor(i,r),U.needsUpdate=!1}}}function et(t,e){this.origin=void 0!==t?t:new c,this.direction=void 0!==e?e:new c}function nt(t,e,n,i){this._x=t||0,this._y=e||0,this._z=n||0,this._order=i||nt.DefaultOrder}function it(){this.mask=1}function rt(){Object.defineProperty(this,"id",{value:Zi++}),this.uuid=t.Math.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=rt.DefaultUp.clone();var e=new c,n=new nt,i=new s,r=new c(1,1,1);n.onChange(function(){i.setFromEuler(n,!1)}),i.onChange(function(){n.setFromQuaternion(i,void 0,!1)}),Object.defineProperties(this,{position:{enumerable:!0,value:e},rotation:{enumerable:!0,value:n},quaternion:{enumerable:!0,value:i},scale:{enumerable:!0,value:r},modelViewMatrix:{value:new l},normalMatrix:{value:new Q}}),this.matrix=new l,this.matrixWorld=new l,this.matrixAutoUpdate=rt.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new it,this.visible=!0,this.receiveShadow=this.castShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={},this.onBeforeRender=null}function at(t,e){this.start=void 0!==t?t:new c,this.end=void 0!==e?e:new c}function ot(t,e,n){this.a=void 0!==t?t:new c,this.b=void 0!==e?e:new c,this.c=void 0!==n?n:new c}function st(t,e,n,i,r,a){this.a=t,this.b=e,this.c=n,this.normal=i&&i.isVector3?i:new c,this.vertexNormals=Array.isArray(i)?i:[],this.color=r&&r.isColor?r:new k,this.vertexColors=Array.isArray(r)?r:[],this.materialIndex=void 0!==a?a:0}function ct(t){X.call(this),this.type="MeshBasicMaterial",this.color=new k(16777215),this.aoMap=this.map=null,this.aoMapIntensity=1,this.envMap=this.alphaMap=this.specularMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.lights=this.morphTargets=this.skinning=!1,this.setValues(t)}function lt(e,n,i){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.uuid=t.Math.generateUUID(),this.array=e,this.itemSize=n,this.count=void 0!==e?e.length/n:0,this.normalized=!0===i,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0}function ht(t,e){return new lt(new Uint16Array(t),e)}function ut(t,e){return new lt(new Uint32Array(t),e)}function dt(t,e){return new lt(new Float32Array(t),e)}function pt(){Object.defineProperty(this,"id",{value:Ji++}),this.uuid=t.Math.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingSphere=this.boundingBox=null,this.groupsNeedUpdate=this.lineDistancesNeedUpdate=this.colorsNeedUpdate=this.normalsNeedUpdate=this.uvsNeedUpdate=this.verticesNeedUpdate=this.elementsNeedUpdate=!1}function ft(){Object.defineProperty(this,"id",{value:Ji++}),this.uuid=t.Math.generateUUID(),this.name="",this.type="DirectGeometry",this.indices=[],this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingSphere=this.boundingBox=null,this.groupsNeedUpdate=this.uvsNeedUpdate=this.colorsNeedUpdate=this.normalsNeedUpdate=this.verticesNeedUpdate=!1}function mt(){Object.defineProperty(this,"id",{value:Ji++}),this.uuid=t.Math.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingSphere=this.boundingBox=null,this.drawRange={start:0,count:1/0}}function gt(t,e){rt.call(this),this.type="Mesh",this.geometry=void 0!==t?t:new mt,this.material=void 0!==e?e:new ct({color:16777215*Math.random()}),this.drawMode=0,this.updateMorphTargets()}function vt(t,e,n,i,r,a){function o(t,e,n,i,r,a,o,l,h,b,w){var _=a/h,M=o/b,E=a/2,T=o/2,S=l/2;o=h+1;for(var A=b+1,R=a=0,L=new c,C=0;C<A;C++)for(var P=C*M-T,I=0;I<o;I++)L[t]=(I*_-E)*i,L[e]=P*r,L[n]=S,d[m]=L.x,d[m+1]=L.y,d[m+2]=L.z,L[t]=0,L[e]=0,L[n]=0<l?1:-1,p[m]=L.x,p[m+1]=L.y,p[m+2]=L.z,f[g]=I/h,f[g+1]=1-C/b,m+=3,g+=2,a+=1;for(C=0;C<b;C++)for(I=0;I<h;I++)t=y+I+o*(C+1),e=y+(I+1)+o*(C+1),n=y+(I+1)+o*C,u[v]=y+I+o*C,u[v+1]=t,u[v+2]=n,u[v+3]=t,u[v+4]=e,u[v+5]=n,v+=6,R+=6;s.addGroup(x,R,w),x+=R,y+=a}mt.call(this),this.type="BoxBufferGeometry",this.parameters={width:t,height:e,depth:n,widthSegments:i,heightSegments:r,depthSegments:a};var s=this;i=Math.floor(i)||1,r=Math.floor(r)||1,a=Math.floor(a)||1;var l=function(t,e,n){return t=0+(t+1)*(e+1)*2+(t+1)*(n+1)*2+(n+1)*(e+1)*2}(i,r,a),h=function(t,e,n){return t=0+t*e*2+t*n*2+n*e*2,6*t}(i,r,a),u=new(65535<h?Uint32Array:Uint16Array)(h),d=new Float32Array(3*l),p=new Float32Array(3*l),f=new Float32Array(2*l),m=0,g=0,v=0,y=0,x=0;o("z","y","x",-1,-1,n,e,t,a,r,0),o("z","y","x",1,-1,n,e,-t,a,r,1),o("x","z","y",1,1,t,n,e,i,a,2),o("x","z","y",1,-1,t,n,-e,i,a,3),o("x","y","z",1,-1,t,e,n,i,r,4),o("x","y","z",-1,-1,t,e,-n,i,r,5),this.setIndex(new lt(u,1)),this.addAttribute("position",new lt(d,3)),this.addAttribute("normal",new lt(p,3)),this.addAttribute("uv",new lt(f,2))}function yt(t,e,n,i){mt.call(this),this.type="PlaneBufferGeometry",this.parameters={width:t,height:e,widthSegments:n,heightSegments:i};var r=t/2,a=e/2;n=Math.floor(n)||1,i=Math.floor(i)||1;var o=n+1,s=i+1,c=t/n,l=e/i;e=new Float32Array(o*s*3),t=new Float32Array(o*s*3);for(var h=new Float32Array(o*s*2),u=0,d=0,p=0;p<s;p++)for(var f=p*l-a,m=0;m<o;m++)e[u]=m*c-r,e[u+1]=-f,t[u+2]=1,h[d]=m/n,h[d+1]=1-p/i,u+=3,d+=2;for(u=0,r=new(65535<e.length/3?Uint32Array:Uint16Array)(n*i*6),p=0;p<i;p++)for(m=0;m<n;m++)a=m+o*(p+1),s=m+1+o*(p+1),c=m+1+o*p,r[u]=m+o*p,r[u+1]=a,r[u+2]=c,r[u+3]=a,r[u+4]=s,r[u+5]=c,u+=6;this.setIndex(new lt(r,1)),this.addAttribute("position",new lt(e,3)),this.addAttribute("normal",new lt(t,3)),this.addAttribute("uv",new lt(h,2))}function xt(){rt.call(this),this.type="Camera",this.matrixWorldInverse=new l,this.projectionMatrix=new l}function bt(t,e,n,i){xt.call(this),this.type="PerspectiveCamera",this.fov=void 0!==t?t:50,this.zoom=1,this.near=void 0!==n?n:.1,this.far=void 0!==i?i:2e3,this.focus=10,this.aspect=void 0!==e?e:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}function wt(t,e,n,i,r,a){xt.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=t,this.right=e,this.top=n,this.bottom=i,this.near=void 0!==r?r:.1,this.far=void 0!==a?a:2e3,this.updateProjectionMatrix()}function _t(t,e,n){var i,r,a;return{setMode:function(t){i=t},setIndex:function(n){n.array instanceof Uint32Array&&e.get("OES_element_index_uint")?(r=t.UNSIGNED_INT,a=4):(r=t.UNSIGNED_SHORT,a=2)},render:function(e,o){t.drawElements(i,o,r,e*a),n.calls++,n.vertices+=o,i===t.TRIANGLES&&(n.faces+=o/3)},renderInstances:function(o,s,c){var l=e.get("ANGLE_instanced_arrays");null===l?console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays."):(l.drawElementsInstancedANGLE(i,c,r,s*a,o.maxInstancedCount),n.calls++,n.vertices+=c*o.maxInstancedCount,i===t.TRIANGLES&&(n.faces+=o.maxInstancedCount*c/3))}}}function Mt(t,e,n){var i;return{setMode:function(t){i=t},render:function(e,r){t.drawArrays(i,e,r),n.calls++,n.vertices+=r,i===t.TRIANGLES&&(n.faces+=r/3)},renderInstances:function(r){var a=e.get("ANGLE_instanced_arrays");if(null===a)console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");else{var o=r.attributes.position,o=o&&o.isInterleavedBufferAttribute?o.data.count:o.count;a.drawArraysInstancedANGLE(i,0,o,r.maxInstancedCount),n.calls++,n.vertices+=o*r.maxInstancedCount,i===t.TRIANGLES&&(n.faces+=r.maxInstancedCount*o/3)}}}}function Et(){var t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];var i;switch(e.type){case"DirectionalLight":i={direction:new c,color:new k,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new n};break;case"SpotLight":i={position:new c,direction:new c,color:new k,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new n};break;case"PointLight":i={position:new c,color:new k,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new n};break;case"HemisphereLight":i={direction:new c,skyColor:new k,groundColor:new k}}return t[e.id]=i}}}function Tt(t){t=t.split("\n");for(var e=0;e<t.length;e++)t[e]=e+1+": "+t[e];return t.join("\n")}function St(t,e,n){var i=t.createShader(e);return t.shaderSource(i,n),t.compileShader(i),!1===t.getShaderParameter(i,t.COMPILE_STATUS)&&console.error("THREE.WebGLShader: Shader couldn't compile."),""!==t.getShaderInfoLog(i)&&console.warn("THREE.WebGLShader: gl.getShaderInfoLog()",e===t.VERTEX_SHADER?"vertex":"fragment",t.getShaderInfoLog(i),Tt(n)),i}function At(t){switch(t){case 3e3:return["Linear","( value )"];case 3001:return["sRGB","( value )"];case 3002:return["RGBE","( value )"];case 3004:return["RGBM","( value, 7.0 )"];case 3005:return["RGBM","( value, 16.0 )"];case 3006:return["RGBD","( value, 256.0 )"];case 3007:return["Gamma","( value, float( GAMMA_FACTOR ) )"];default:throw Error("unsupported encoding: "+t)}}function Rt(t,e){var n=At(e);return"vec4 "+t+"( vec4 value ) { return "+n[0]+"ToLinear"+n[1]+"; }"}function Lt(t,e){var n=At(e);return"vec4 "+t+"( vec4 value ) { return LinearTo"+n[0]+n[1]+"; }"}function Ct(t,e){var n;switch(e){case 1:n="Linear";break;case 2:n="Reinhard";break;case 3:n="Uncharted2";break;case 4:n="OptimizedCineon";break;default:throw Error("unsupported toneMapping: "+e)}return"vec3 "+t+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function Pt(t,e,n){return t=t||{},[t.derivatives||e.envMapCubeUV||e.bumpMap||e.normalMap||e.flatShading?"#extension GL_OES_standard_derivatives : enable":"",(t.fragDepth||e.logarithmicDepthBuffer)&&n.get("EXT_frag_depth")?"#extension GL_EXT_frag_depth : enable":"",t.drawBuffers&&n.get("WEBGL_draw_buffers")?"#extension GL_EXT_draw_buffers : require":"",(t.shaderTextureLOD||e.envMap)&&n.get("EXT_shader_texture_lod")?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Ut).join("\n")}function It(t){var e,n=[];for(e in t){var i=t[e];!1!==i&&n.push("#define "+e+" "+i)}return n.join("\n")}function Ut(t){return""!==t}function Nt(t,e){return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights)}function Dt(t){return t.replace(/#include +<([\w\d.]+)>/g,function(t,e){var n=Wi[e];if(void 0===n)throw Error("Can not resolve #include <"+e+">");return Dt(n)})}function Ft(t){return t.replace(/for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,function(t,e,n,i){for(t="",e=parseInt(e);e<parseInt(n);e++)t+=i.replace(/\[ i \]/g,"[ "+e+" ]");return t})}function Ot(t,e,n,i){var r=t.context,a=n.extensions,o=n.defines,s=n.__webglShader.vertexShader,c=n.__webglShader.fragmentShader,l="SHADOWMAP_TYPE_BASIC";1===i.shadowMapType?l="SHADOWMAP_TYPE_PCF":2===i.shadowMapType&&(l="SHADOWMAP_TYPE_PCF_SOFT");var h="ENVMAP_TYPE_CUBE",u="ENVMAP_MODE_REFLECTION",d="ENVMAP_BLENDING_MULTIPLY";if(i.envMap){switch(n.envMap.mapping){case 301:case 302:h="ENVMAP_TYPE_CUBE";break;case 306:case 307:h="ENVMAP_TYPE_CUBE_UV";break;case 303:case 304:h="ENVMAP_TYPE_EQUIREC";break;case 305:h="ENVMAP_TYPE_SPHERE"}switch(n.envMap.mapping){case 302:case 304:u="ENVMAP_MODE_REFRACTION"}switch(n.combine){case 0:d="ENVMAP_BLENDING_MULTIPLY";break;case 1:d="ENVMAP_BLENDING_MIX";break;case 2:d="ENVMAP_BLENDING_ADD"}}var p=0<t.gammaFactor?t.gammaFactor:1,a=Pt(a,i,t.extensions),f=It(o),m=r.createProgram();n.isRawShaderMaterial?(o=[f,"\n"].filter(Ut).join("\n"),l=[a,f,"\n"].filter(Ut).join("\n")):(o=["precision "+i.precision+" float;","precision "+i.precision+" int;","#define SHADER_NAME "+n.__webglShader.name,f,i.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+p,"#define MAX_BONES "+i.maxBones,i.map?"#define USE_MAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+u:"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.displacementMap&&i.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.vertexColors?"#define USE_COLOR":"",i.flatShading?"#define FLAT_SHADED":"",i.skinning?"#define USE_SKINNING":"",i.useVertexTexture?"#define BONE_TEXTURE":"",i.morphTargets?"#define USE_MORPHTARGETS":"",i.morphNormals&&!1===i.flatShading?"#define USE_MORPHNORMALS":"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"","#define NUM_CLIPPING_PLANES "+i.numClippingPlanes,i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+l:"",i.sizeAttenuation?"#define USE_SIZEATTENUATION":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.logarithmicDepthBuffer&&t.extensions.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Ut).join("\n"),l=[a,"precision "+i.precision+" float;","precision "+i.precision+" int;","#define SHADER_NAME "+n.__webglShader.name,f,i.alphaTest?"#define ALPHATEST "+i.alphaTest:"","#define GAMMA_FACTOR "+p,i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp?"#define FOG_EXP2":"",i.map?"#define USE_MAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+h:"",i.envMap?"#define "+u:"",i.envMap?"#define "+d:"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.vertexColors?"#define USE_COLOR":"",i.flatShading?"#define FLAT_SHADED":"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"","#define NUM_CLIPPING_PLANES "+i.numClippingPlanes,i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+l:"",i.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",i.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.logarithmicDepthBuffer&&t.extensions.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"",i.envMap&&t.extensions.get("EXT_shader_texture_lod")?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",0!==i.toneMapping?"#define TONE_MAPPING":"",0!==i.toneMapping?Wi.tonemapping_pars_fragment:"",0!==i.toneMapping?Ct("toneMapping",i.toneMapping):"",i.outputEncoding||i.mapEncoding||i.envMapEncoding||i.emissiveMapEncoding?Wi.encodings_pars_fragment:"",i.mapEncoding?Rt("mapTexelToLinear",i.mapEncoding):"",i.envMapEncoding?Rt("envMapTexelToLinear",i.envMapEncoding):"",i.emissiveMapEncoding?Rt("emissiveMapTexelToLinear",i.emissiveMapEncoding):"",i.outputEncoding?Lt("linearToOutputTexel",i.outputEncoding):"",i.depthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(Ut).join("\n")),s=Dt(s,i),s=Nt(s,i),c=Dt(c,i),c=Nt(c,i),n.isShaderMaterial||(s=Ft(s),c=Ft(c)),c=l+c,s=St(r,r.VERTEX_SHADER,o+s),c=St(r,r.FRAGMENT_SHADER,c),r.attachShader(m,s),r.attachShader(m,c),void 0!==n.index0AttributeName?r.bindAttribLocation(m,0,n.index0AttributeName):!0===i.morphTargets&&r.bindAttribLocation(m,0,"position"),r.linkProgram(m),i=r.getProgramInfoLog(m),h=r.getShaderInfoLog(s),u=r.getShaderInfoLog(c),p=d=!0,!1===r.getProgramParameter(m,r.LINK_STATUS)?(d=!1,console.error("THREE.WebGLProgram: shader error: ",r.getError(),"gl.VALIDATE_STATUS",r.getProgramParameter(m,r.VALIDATE_STATUS),"gl.getProgramInfoLog",i,h,u)):""!==i?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",i):""!==h&&""!==u||(p=!1),p&&(this.diagnostics={runnable:d,material:n,programLog:i,vertexShader:{log:h,prefix:o},fragmentShader:{log:u,prefix:l}}),r.deleteShader(s),r.deleteShader(c);var g;this.getUniforms=function(){return void 0===g&&(g=new G(r,m,t)),g};var v;return this.getAttributes=function(){if(void 0===v){for(var t={},e=r.getProgramParameter(m,r.ACTIVE_ATTRIBUTES),n=0;n<e;n++){var i=r.getActiveAttrib(m,n).name;t[i]=r.getAttribLocation(m,i)}v=t}return v},this.destroy=function(){r.deleteProgram(m),this.program=void 0},Object.defineProperties(this,{uniforms:{get:function(){return console.warn("THREE.WebGLProgram: .uniforms is now .getUniforms()."),this.getUniforms()}},attributes:{get:function(){return console.warn("THREE.WebGLProgram: .attributes is now .getAttributes()."),this.getAttributes()}}}),this.id=Qi++,this.code=e,this.usedTimes=1,this.program=m,this.vertexShader=s,this.fragmentShader=c,this}function Bt(t,e){function n(t,e){var n;return t?t&&t.isTexture?n=t.encoding:t&&t.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),n=t.texture.encoding):n=3e3,3e3===n&&e&&(n=3007),n}var i=[],r={MeshDepthMaterial:"depth",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",
MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points"},a="precision supportsVertexTextures map mapEncoding envMap envMapMode envMapEncoding lightMap aoMap emissiveMap emissiveMapEncoding bumpMap normalMap displacementMap specularMap roughnessMap metalnessMap alphaMap combine vertexColors fog useFog fogExp flatShading sizeAttenuation logarithmicDepthBuffer skinning maxBones useVertexTexture morphTargets morphNormals maxMorphTargets maxMorphNormals premultipliedAlpha numDirLights numPointLights numSpotLights numHemiLights shadowMapEnabled shadowMapType toneMapping physicallyCorrectLights alphaTest doubleSided flipSided numClippingPlanes depthPacking".split(" ");this.getParameters=function(i,a,o,s,c){var l,h=r[i.type];e.floatVertexTextures&&c&&c.skeleton&&c.skeleton.useVertexTexture?l=1024:(l=Math.floor((e.maxVertexUniforms-20)/4),void 0!==c&&c&&c.isSkinnedMesh&&(l=Math.min(c.skeleton.bones.length,l),l<c.skeleton.bones.length&&console.warn("WebGLRenderer: too many bones - "+c.skeleton.bones.length+", this GPU supports just "+l+" (try OpenGL instead of ANGLE)")));var u=t.getPrecision();null!==i.precision&&(u=e.getMaxPrecision(i.precision),u!==i.precision&&console.warn("THREE.WebGLProgram.getParameters:",i.precision,"not supported, using",u,"instead."));var d=t.getCurrentRenderTarget();return{shaderID:h,precision:u,supportsVertexTextures:e.vertexTextures,outputEncoding:n(d?d.texture:null,t.gammaOutput),map:!!i.map,mapEncoding:n(i.map,t.gammaInput),envMap:!!i.envMap,envMapMode:i.envMap&&i.envMap.mapping,envMapEncoding:n(i.envMap,t.gammaInput),envMapCubeUV:!!i.envMap&&(306===i.envMap.mapping||307===i.envMap.mapping),lightMap:!!i.lightMap,aoMap:!!i.aoMap,emissiveMap:!!i.emissiveMap,emissiveMapEncoding:n(i.emissiveMap,t.gammaInput),bumpMap:!!i.bumpMap,normalMap:!!i.normalMap,displacementMap:!!i.displacementMap,roughnessMap:!!i.roughnessMap,metalnessMap:!!i.metalnessMap,specularMap:!!i.specularMap,alphaMap:!!i.alphaMap,combine:i.combine,vertexColors:i.vertexColors,fog:!!o,useFog:i.fog,fogExp:o&&o.isFogExp2,flatShading:1===i.shading,sizeAttenuation:i.sizeAttenuation,logarithmicDepthBuffer:e.logarithmicDepthBuffer,skinning:i.skinning,maxBones:l,useVertexTexture:e.floatVertexTextures&&c&&c.skeleton&&c.skeleton.useVertexTexture,morphTargets:i.morphTargets,morphNormals:i.morphNormals,maxMorphTargets:t.maxMorphTargets,maxMorphNormals:t.maxMorphNormals,numDirLights:a.directional.length,numPointLights:a.point.length,numSpotLights:a.spot.length,numHemiLights:a.hemi.length,numClippingPlanes:s,shadowMapEnabled:t.shadowMap.enabled&&c.receiveShadow&&0<a.shadows.length,shadowMapType:t.shadowMap.type,toneMapping:t.toneMapping,physicallyCorrectLights:t.physicallyCorrectLights,premultipliedAlpha:i.premultipliedAlpha,alphaTest:i.alphaTest,doubleSided:2===i.side,flipSided:1===i.side,depthPacking:void 0!==i.depthPacking&&i.depthPacking}},this.getProgramCode=function(t,e){var n=[];if(e.shaderID?n.push(e.shaderID):(n.push(t.fragmentShader),n.push(t.vertexShader)),void 0!==t.defines)for(var i in t.defines)n.push(i),n.push(t.defines[i]);for(i=0;i<a.length;i++)n.push(e[a[i]]);return n.join()},this.acquireProgram=function(e,n,r){for(var a,o=0,s=i.length;o<s;o++){var c=i[o];if(c.code===r){a=c,++a.usedTimes;break}}return void 0===a&&(a=new Ot(t,r,e,n),i.push(a)),a},this.releaseProgram=function(t){if(0===--t.usedTimes){var e=i.indexOf(t);i[e]=i[i.length-1],i.pop(),t.destroy()}},this.programs=i}function zt(t,e,n){function i(t){var o=t.target;t=a[o.id],null!==t.index&&r(t.index);var s,c=t.attributes;for(s in c)r(c[s]);o.removeEventListener("dispose",i),delete a[o.id],s=e.get(o),s.wireframe&&r(s.wireframe),e.delete(o),o=e.get(t),o.wireframe&&r(o.wireframe),e.delete(t),n.memory.geometries--}function r(n){var i;i=n.isInterleavedBufferAttribute?e.get(n.data).__webglBuffer:e.get(n).__webglBuffer,void 0!==i&&(t.deleteBuffer(i),n.isInterleavedBufferAttribute?e.delete(n.data):e.delete(n))}var a={};return{get:function(t){var e=t.geometry;if(void 0!==a[e.id])return a[e.id];e.addEventListener("dispose",i);var r;return e.isBufferGeometry?r=e:e.isGeometry&&(void 0===e._bufferGeometry&&(e._bufferGeometry=(new mt).setFromObject(t)),r=e._bufferGeometry),a[e.id]=r,n.memory.geometries++,r}}}function Ht(t,e,n){function i(n,i){var r=n.isInterleavedBufferAttribute?n.data:n,a=e.get(r);void 0===a.__webglBuffer?(a.__webglBuffer=t.createBuffer(),t.bindBuffer(i,a.__webglBuffer),t.bufferData(i,r.array,r.dynamic?t.DYNAMIC_DRAW:t.STATIC_DRAW),a.version=r.version):a.version!==r.version&&(t.bindBuffer(i,a.__webglBuffer),!1===r.dynamic||-1===r.updateRange.count?t.bufferSubData(i,0,r.array):0===r.updateRange.count?console.error("THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually."):(t.bufferSubData(i,r.updateRange.offset*r.array.BYTES_PER_ELEMENT,r.array.subarray(r.updateRange.offset,r.updateRange.offset+r.updateRange.count)),r.updateRange.count=0),a.version=r.version)}var r=new zt(t,e,n);return{getAttributeBuffer:function(t){return t.isInterleavedBufferAttribute?e.get(t.data).__webglBuffer:e.get(t).__webglBuffer},getWireframeAttribute:function(n){var r=e.get(n);if(void 0!==r.wireframe)return r.wireframe;var a=[],o=n.index,s=n.attributes;if(n=s.position,null!==o)for(var o=o.array,s=0,c=o.length;s<c;s+=3){var l=o[s+0],h=o[s+1],u=o[s+2];a.push(l,h,h,u,u,l)}else for(o=s.position.array,s=0,c=o.length/3-1;s<c;s+=3)l=s+0,h=s+1,u=s+2,a.push(l,h,h,u,u,l);return a=new lt(new(65535<n.count?Uint32Array:Uint16Array)(a),1),i(a,t.ELEMENT_ARRAY_BUFFER),r.wireframe=a},update:function(e){var n=r.get(e);e.geometry.isGeometry&&n.updateFromObject(e),e=n.index;var a=n.attributes;null!==e&&i(e,t.ELEMENT_ARRAY_BUFFER);for(var o in a)i(a[o],t.ARRAY_BUFFER);e=n.morphAttributes;for(o in e)for(var a=e[o],s=0,c=a.length;s<c;s++)i(a[s],t.ARRAY_BUFFER);return n}}}function Gt(e,n,i,r,a,o,s){function c(t,e){if(t.width>e||t.height>e){var n=e/Math.max(t.width,t.height),i=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");return i.width=Math.floor(t.width*n),i.height=Math.floor(t.height*n),i.getContext("2d").drawImage(t,0,0,t.width,t.height,0,0,i.width,i.height),console.warn("THREE.WebGLRenderer: image is too big ("+t.width+"x"+t.height+"). Resized to "+i.width+"x"+i.height,t),i}return t}function l(e){return t.Math.isPowerOfTwo(e.width)&&t.Math.isPowerOfTwo(e.height)}function h(t){return 1003===t||1004===t||1005===t?e.NEAREST:e.LINEAR}function u(t){t=t.target,t.removeEventListener("dispose",u);t:{var n=r.get(t);if(t.image&&n.__image__webglTextureCube)e.deleteTexture(n.__image__webglTextureCube);else{if(void 0===n.__webglInit)break t;e.deleteTexture(n.__webglTexture)}r.delete(t)}v.textures--}function d(t){t=t.target,t.removeEventListener("dispose",d);var n=r.get(t),i=r.get(t.texture);if(t){if(void 0!==i.__webglTexture&&e.deleteTexture(i.__webglTexture),t.depthTexture&&t.depthTexture.dispose(),t&&t.isWebGLRenderTargetCube)for(i=0;6>i;i++)e.deleteFramebuffer(n.__webglFramebuffer[i]),n.__webglDepthbuffer&&e.deleteRenderbuffer(n.__webglDepthbuffer[i]);else e.deleteFramebuffer(n.__webglFramebuffer),n.__webglDepthbuffer&&e.deleteRenderbuffer(n.__webglDepthbuffer);r.delete(t.texture),r.delete(t)}v.textures--}function p(n,s){var h=r.get(n);if(0<n.version&&h.__version!==n.version){var d=n.image;if(void 0===d)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined",n);else{if(!1!==d.complete){void 0===h.__webglInit&&(h.__webglInit=!0,n.addEventListener("dispose",u),h.__webglTexture=e.createTexture(),v.textures++),i.activeTexture(e.TEXTURE0+s),i.bindTexture(e.TEXTURE_2D,h.__webglTexture),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,n.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,n.unpackAlignment);var p=c(n.image,a.maxTextureSize);if((1001!==n.wrapS||1001!==n.wrapT||1003!==n.minFilter&&1006!==n.minFilter)&&!1===l(p))if(d=p,d instanceof HTMLImageElement||d instanceof HTMLCanvasElement){var m=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");m.width=t.Math.nearestPowerOfTwo(d.width),m.height=t.Math.nearestPowerOfTwo(d.height),m.getContext("2d").drawImage(d,0,0,m.width,m.height),console.warn("THREE.WebGLRenderer: image is not power of two ("+d.width+"x"+d.height+"). Resized to "+m.width+"x"+m.height,d),p=m}else p=d;var d=l(p),m=o(n.format),g=o(n.type);f(e.TEXTURE_2D,n,d);var x=n.mipmaps;if(n&&n.isDepthTexture){if(x=e.DEPTH_COMPONENT,1015===n.type){if(!y)throw Error("Float Depth Texture only supported in WebGL2.0");x=e.DEPTH_COMPONENT32F}else y&&(x=e.DEPTH_COMPONENT16);1027===n.format&&(x=e.DEPTH_STENCIL),i.texImage2D(e.TEXTURE_2D,0,x,p.width,p.height,0,m,g,null)}else if(n&&n.isDataTexture)if(0<x.length&&d){for(var b=0,w=x.length;b<w;b++)p=x[b],i.texImage2D(e.TEXTURE_2D,b,m,p.width,p.height,0,m,g,p.data);n.generateMipmaps=!1}else i.texImage2D(e.TEXTURE_2D,0,m,p.width,p.height,0,m,g,p.data);else if(n&&n.isCompressedTexture)for(b=0,w=x.length;b<w;b++)p=x[b],1023!==n.format&&1022!==n.format?-1<i.getCompressedTextureFormats().indexOf(m)?i.compressedTexImage2D(e.TEXTURE_2D,b,m,p.width,p.height,0,p.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):i.texImage2D(e.TEXTURE_2D,b,m,p.width,p.height,0,m,g,p.data);else if(0<x.length&&d){for(b=0,w=x.length;b<w;b++)p=x[b],i.texImage2D(e.TEXTURE_2D,b,m,m,g,p);n.generateMipmaps=!1}else i.texImage2D(e.TEXTURE_2D,0,m,m,g,p);return n.generateMipmaps&&d&&e.generateMipmap(e.TEXTURE_2D),h.__version=n.version,void(n.onUpdate&&n.onUpdate(n))}console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete",n)}}i.activeTexture(e.TEXTURE0+s),i.bindTexture(e.TEXTURE_2D,h.__webglTexture)}function f(t,i,s){s?(e.texParameteri(t,e.TEXTURE_WRAP_S,o(i.wrapS)),e.texParameteri(t,e.TEXTURE_WRAP_T,o(i.wrapT)),e.texParameteri(t,e.TEXTURE_MAG_FILTER,o(i.magFilter)),e.texParameteri(t,e.TEXTURE_MIN_FILTER,o(i.minFilter))):(e.texParameteri(t,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(t,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),1001===i.wrapS&&1001===i.wrapT||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping.",i),e.texParameteri(t,e.TEXTURE_MAG_FILTER,h(i.magFilter)),e.texParameteri(t,e.TEXTURE_MIN_FILTER,h(i.minFilter)),1003!==i.minFilter&&1006!==i.minFilter&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.",i)),!(s=n.get("EXT_texture_filter_anisotropic"))||1015===i.type&&null===n.get("OES_texture_float_linear")||1016===i.type&&null===n.get("OES_texture_half_float_linear")||!(1<i.anisotropy||r.get(i).__currentAnisotropy)||(e.texParameterf(t,s.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(i.anisotropy,a.getMaxAnisotropy())),r.get(i).__currentAnisotropy=i.anisotropy)}function m(t,n,a,s){var c=o(n.texture.format),l=o(n.texture.type);i.texImage2D(s,0,c,n.width,n.height,0,c,l,null),e.bindFramebuffer(e.FRAMEBUFFER,t),e.framebufferTexture2D(e.FRAMEBUFFER,a,s,r.get(n.texture).__webglTexture,0),e.bindFramebuffer(e.FRAMEBUFFER,null)}function g(t,n){e.bindRenderbuffer(e.RENDERBUFFER,t),n.depthBuffer&&!n.stencilBuffer?(e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_COMPONENT16,n.width,n.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,t)):n.depthBuffer&&n.stencilBuffer?(e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,n.width,n.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,t)):e.renderbufferStorage(e.RENDERBUFFER,e.RGBA4,n.width,n.height),e.bindRenderbuffer(e.RENDERBUFFER,null)}var v=s.memory,y="undefined"!=typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext;this.setTexture2D=p,this.setTextureCube=function(t,n){var s=r.get(t);if(6===t.image.length)if(0<t.version&&s.__version!==t.version){s.__image__webglTextureCube||(t.addEventListener("dispose",u),s.__image__webglTextureCube=e.createTexture(),v.textures++),i.activeTexture(e.TEXTURE0+n),i.bindTexture(e.TEXTURE_CUBE_MAP,s.__image__webglTextureCube),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,t.flipY);for(var h=t&&t.isCompressedTexture,d=t.image[0]&&t.image[0].isDataTexture,p=[],m=0;6>m;m++)p[m]=h||d?d?t.image[m].image:t.image[m]:c(t.image[m],a.maxCubemapSize);var g=l(p[0]),y=o(t.format),x=o(t.type);for(f(e.TEXTURE_CUBE_MAP,t,g),m=0;6>m;m++)if(h)for(var b,w=p[m].mipmaps,_=0,M=w.length;_<M;_++)b=w[_],1023!==t.format&&1022!==t.format?-1<i.getCompressedTextureFormats().indexOf(y)?i.compressedTexImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+m,_,y,b.width,b.height,0,b.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):i.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+m,_,y,b.width,b.height,0,y,x,b.data);else d?i.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+m,0,y,p[m].width,p[m].height,0,y,x,p[m].data):i.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+m,0,y,y,x,p[m]);t.generateMipmaps&&g&&e.generateMipmap(e.TEXTURE_CUBE_MAP),s.__version=t.version,t.onUpdate&&t.onUpdate(t)}else i.activeTexture(e.TEXTURE0+n),i.bindTexture(e.TEXTURE_CUBE_MAP,s.__image__webglTextureCube)},this.setTextureCubeDynamic=function(t,n){i.activeTexture(e.TEXTURE0+n),i.bindTexture(e.TEXTURE_CUBE_MAP,r.get(t).__webglTexture)},this.setupRenderTarget=function(t){var n=r.get(t),a=r.get(t.texture);t.addEventListener("dispose",d),a.__webglTexture=e.createTexture(),v.textures++;var o=t&&t.isWebGLRenderTargetCube,s=l(t);if(o){n.__webglFramebuffer=[];for(var c=0;6>c;c++)n.__webglFramebuffer[c]=e.createFramebuffer()}else n.__webglFramebuffer=e.createFramebuffer();if(o){for(i.bindTexture(e.TEXTURE_CUBE_MAP,a.__webglTexture),f(e.TEXTURE_CUBE_MAP,t.texture,s),c=0;6>c;c++)m(n.__webglFramebuffer[c],t,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+c);t.texture.generateMipmaps&&s&&e.generateMipmap(e.TEXTURE_CUBE_MAP),i.bindTexture(e.TEXTURE_CUBE_MAP,null)}else i.bindTexture(e.TEXTURE_2D,a.__webglTexture),f(e.TEXTURE_2D,t.texture,s),m(n.__webglFramebuffer,t,e.COLOR_ATTACHMENT0,e.TEXTURE_2D),t.texture.generateMipmaps&&s&&e.generateMipmap(e.TEXTURE_2D),i.bindTexture(e.TEXTURE_2D,null);if(t.depthBuffer){if(n=r.get(t),a=t&&t.isWebGLRenderTargetCube,t.depthTexture){if(a)throw Error("target.depthTexture not supported in Cube render targets");if(t&&t.isWebGLRenderTargetCube)throw Error("Depth Texture with cube render targets is not supported!");if(e.bindFramebuffer(e.FRAMEBUFFER,n.__webglFramebuffer),!t.depthTexture||!t.depthTexture.isDepthTexture)throw Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");if(r.get(t.depthTexture).__webglTexture&&t.depthTexture.image.width===t.width&&t.depthTexture.image.height===t.height||(t.depthTexture.image.width=t.width,t.depthTexture.image.height=t.height,t.depthTexture.needsUpdate=!0),p(t.depthTexture,0),n=r.get(t.depthTexture).__webglTexture,1026===t.depthTexture.format)e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,n,0);else{if(1027!==t.depthTexture.format)throw Error("Unknown depthTexture format");e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,n,0)}}else if(a)for(n.__webglDepthbuffer=[],a=0;6>a;a++)e.bindFramebuffer(e.FRAMEBUFFER,n.__webglFramebuffer[a]),n.__webglDepthbuffer[a]=e.createRenderbuffer(),g(n.__webglDepthbuffer[a],t);else e.bindFramebuffer(e.FRAMEBUFFER,n.__webglFramebuffer),n.__webglDepthbuffer=e.createRenderbuffer(),g(n.__webglDepthbuffer,t);e.bindFramebuffer(e.FRAMEBUFFER,null)}},this.updateRenderTargetMipmap=function(t){var n=t.texture;n.generateMipmaps&&l(t)&&1003!==n.minFilter&&1006!==n.minFilter&&(t=t&&t.isWebGLRenderTargetCube?e.TEXTURE_CUBE_MAP:e.TEXTURE_2D,n=r.get(n).__webglTexture,i.bindTexture(t,n),e.generateMipmap(t),i.bindTexture(t,null))}}function kt(){var t={};return{get:function(e){e=e.uuid;var n=t[e];return void 0===n&&(n={},t[e]=n),n},delete:function(e){delete t[e.uuid]},clear:function(){t={}}}}function Vt(t,e,n){function i(e,n,i){var r=new Uint8Array(4),a=t.createTexture();for(t.bindTexture(e,a),t.texParameteri(e,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(e,t.TEXTURE_MAG_FILTER,t.NEAREST),e=0;e<i;e++)t.texImage2D(n+e,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,r);return a}function a(e){!0!==_[e]&&(t.enable(e),_[e]=!0)}function o(e){!1!==_[e]&&(t.disable(e),_[e]=!1)}function s(e,i,r,s,c,l,h,u){0!==e?(a(t.BLEND),e===E&&u===P||(2===e?u?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ONE,t.ONE,t.ONE,t.ONE)):(t.blendEquation(t.FUNC_ADD),t.blendFunc(t.SRC_ALPHA,t.ONE)):3===e?u?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ZERO,t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ONE_MINUS_SRC_ALPHA)):(t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ZERO,t.ONE_MINUS_SRC_COLOR)):4===e?u?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ZERO,t.SRC_COLOR,t.ZERO,t.SRC_ALPHA)):(t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ZERO,t.SRC_COLOR)):u?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ONE,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA)):(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA)),E=e,P=u),5===e?(c=c||i,l=l||r,h=h||s,i===T&&c===R||(t.blendEquationSeparate(n(i),n(c)),T=i,R=c),r===S&&s===A&&l===L&&h===C||(t.blendFuncSeparate(n(r),n(s),n(l),n(h)),S=r,A=s,L=l,C=h)):C=L=R=A=S=T=null):(o(t.BLEND),E=e)}function c(t){g.setFunc(t)}function l(e){I!==e&&(e?t.frontFace(t.CW):t.frontFace(t.CCW),I=e)}function h(e){0!==e?(a(t.CULL_FACE),e!==U&&(1===e?t.cullFace(t.BACK):2===e?t.cullFace(t.FRONT):t.cullFace(t.FRONT_AND_BACK))):o(t.CULL_FACE),U=e}function u(e){void 0===e&&(e=t.TEXTURE0+B-1),z!==e&&(t.activeTexture(e),z=e)}function d(t,e,n,i){m.setClear(t,e,n,i)}function p(t){g.setClear(t)}function f(t){v.setClear(t)}var m=new function(){var e=!1,n=new r,i=null,a=new r;return{setMask:function(n){i===n||e||(t.colorMask(n,n,n,n),i=n)},setLocked:function(t){e=t},setClear:function(e,i,r,o){n.set(e,i,r,o),!1===a.equals(n)&&(t.clearColor(e,i,r,o),a.copy(n))},reset:function(){e=!1,i=null,a.set(0,0,0,1)}}},g=new function(){var e=!1,n=null,i=null,r=null;return{setTest:function(e){e?a(t.DEPTH_TEST):o(t.DEPTH_TEST)},setMask:function(i){n===i||e||(t.depthMask(i),n=i)},setFunc:function(e){if(i!==e){if(e)switch(e){case 0:t.depthFunc(t.NEVER);break;case 1:t.depthFunc(t.ALWAYS);break;case 2:t.depthFunc(t.LESS);break;case 3:t.depthFunc(t.LEQUAL);break;case 4:t.depthFunc(t.EQUAL);break;case 5:t.depthFunc(t.GEQUAL);break;case 6:t.depthFunc(t.GREATER);break;case 7:t.depthFunc(t.NOTEQUAL);break;default:t.depthFunc(t.LEQUAL)}else t.depthFunc(t.LEQUAL);i=e}},setLocked:function(t){e=t},setClear:function(e){r!==e&&(t.clearDepth(e),r=e)},reset:function(){e=!1,r=i=n=null}}},v=new function(){var e=!1,n=null,i=null,r=null,s=null,c=null,l=null,h=null,u=null;return{setTest:function(e){e?a(t.STENCIL_TEST):o(t.STENCIL_TEST)},setMask:function(i){n===i||e||(t.stencilMask(i),n=i)},setFunc:function(e,n,a){i===e&&r===n&&s===a||(t.stencilFunc(e,n,a),i=e,r=n,s=a)},setOp:function(e,n,i){c===e&&l===n&&h===i||(t.stencilOp(e,n,i),c=e,l=n,h=i)},setLocked:function(t){e=t},setClear:function(e){u!==e&&(t.clearStencil(e),u=e)},reset:function(){e=!1,u=h=l=c=s=r=i=n=null}}},y=t.getParameter(t.MAX_VERTEX_ATTRIBS),x=new Uint8Array(y),b=new Uint8Array(y),w=new Uint8Array(y),_={},M=null,E=null,T=null,S=null,A=null,R=null,L=null,C=null,P=!1,I=null,U=null,N=null,D=null,F=null,O=null,B=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),z=null,H={},G=new r,k=new r,V={};return V[t.TEXTURE_2D]=i(t.TEXTURE_2D,t.TEXTURE_2D,1),V[t.TEXTURE_CUBE_MAP]=i(t.TEXTURE_CUBE_MAP,t.TEXTURE_CUBE_MAP_POSITIVE_X,6),{buffers:{color:m,depth:g,stencil:v},init:function(){d(0,0,0,1),p(1),f(0),a(t.DEPTH_TEST),c(3),l(!1),h(1),a(t.CULL_FACE),a(t.BLEND),s(1)},initAttributes:function(){for(var t=0,e=x.length;t<e;t++)x[t]=0},enableAttribute:function(n){x[n]=1,0===b[n]&&(t.enableVertexAttribArray(n),b[n]=1),0!==w[n]&&(e.get("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(n,0),w[n]=0)},enableAttributeAndDivisor:function(e,n,i){x[e]=1,0===b[e]&&(t.enableVertexAttribArray(e),b[e]=1),w[e]!==n&&(i.vertexAttribDivisorANGLE(e,n),w[e]=n)},disableUnusedAttributes:function(){for(var e=0,n=b.length;e!==n;++e)b[e]!==x[e]&&(t.disableVertexAttribArray(e),b[e]=0)},enable:a,disable:o,getCompressedTextureFormats:function(){if(null===M&&(M=[],e.get("WEBGL_compressed_texture_pvrtc")||e.get("WEBGL_compressed_texture_s3tc")||e.get("WEBGL_compressed_texture_etc1")))for(var n=t.getParameter(t.COMPRESSED_TEXTURE_FORMATS),i=0;i<n.length;i++)M.push(n[i]);return M},setBlending:s,setColorWrite:function(t){m.setMask(t)},setDepthTest:function(t){g.setTest(t)},setDepthWrite:function(t){g.setMask(t)},setDepthFunc:c,setStencilTest:function(t){v.setTest(t)},setStencilWrite:function(t){v.setMask(t)},setStencilFunc:function(t,e,n){v.setFunc(t,e,n)},setStencilOp:function(t,e,n){v.setOp(t,e,n)},setFlipSided:l,setCullFace:h,setLineWidth:function(e){e!==N&&(t.lineWidth(e),N=e)},setPolygonOffset:function(e,n,i){e?(a(t.POLYGON_OFFSET_FILL),(D!==n||F!==i)&&(t.polygonOffset(n,i),D=n,F=i)):o(t.POLYGON_OFFSET_FILL)},getScissorTest:function(){return O},setScissorTest:function(e){(O=e)?a(t.SCISSOR_TEST):o(t.SCISSOR_TEST)},activeTexture:u,bindTexture:function(e,n){null===z&&u();var i=H[z];void 0===i&&(i={type:void 0,texture:void 0},H[z]=i),i.type===e&&i.texture===n||(t.bindTexture(e,n||V[e]),i.type=e,i.texture=n)},compressedTexImage2D:function(){try{t.compressedTexImage2D.apply(t,arguments)}catch(t){console.error(t)}},texImage2D:function(){try{t.texImage2D.apply(t,arguments)}catch(t){console.error(t)}},clearColor:d,clearDepth:p,clearStencil:f,scissor:function(e){!1===G.equals(e)&&(t.scissor(e.x,e.y,e.z,e.w),G.copy(e))},viewport:function(e){!1===k.equals(e)&&(t.viewport(e.x,e.y,e.z,e.w),k.copy(e))},reset:function(){for(var e=0;e<b.length;e++)1===b[e]&&(t.disableVertexAttribArray(e),b[e]=0);_={},z=M=null,H={},U=I=E=null,m.reset(),g.reset(),v.reset()}}}function jt(t,e,n){function i(e){if("highp"===e){if(0<t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.HIGH_FLOAT).precision&&0<t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision)return"highp";e="mediump"}return"mediump"===e&&0<t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.MEDIUM_FLOAT).precision&&0<t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.MEDIUM_FLOAT).precision?"mediump":"lowp"}var r,a=void 0!==n.precision?n.precision:"highp",o=i(a);o!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",o,"instead."),a=o),n=!0===n.logarithmicDepthBuffer&&!!e.get("EXT_frag_depth");var o=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),s=t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS),c=t.getParameter(t.MAX_TEXTURE_SIZE),l=t.getParameter(t.MAX_CUBE_MAP_TEXTURE_SIZE),h=t.getParameter(t.MAX_VERTEX_ATTRIBS),u=t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS),d=t.getParameter(t.MAX_VARYING_VECTORS),p=t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS),f=0<s,m=!!e.get("OES_texture_float");return{getMaxAnisotropy:function(){if(void 0!==r)return r;var n=e.get("EXT_texture_filter_anisotropic");return r=null!==n?t.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},getMaxPrecision:i,precision:a,logarithmicDepthBuffer:n,maxTextures:o,maxVertexTextures:s,maxTextureSize:c,maxCubemapSize:l,maxAttributes:h,maxVertexUniforms:u,maxVaryings:d,maxFragmentUniforms:p,vertexTextures:f,floatFragmentTextures:m,floatVertexTextures:f&&m}}function Wt(t){var e={};return{get:function(n){if(void 0!==e[n])return e[n];var i;switch(n){case"WEBGL_depth_texture":i=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":i=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;case"WEBGL_compressed_texture_etc1":i=t.getExtension("WEBGL_compressed_texture_etc1");break;default:i=t.getExtension(n)}return null===i&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),e[n]=i}}}function Xt(){function t(){l.value!==i&&(l.value=i,l.needsUpdate=0<r),n.numPlanes=r}function e(t,e,i,r){var a=null!==t?t.length:0,o=null;if(0!==a){if(o=l.value,!0!==r||null===o)for(r=i+4*a,e=e.matrixWorldInverse,c.getNormalMatrix(e),(null===o||o.length<r)&&(o=new Float32Array(r)),r=0;r!==a;++r,i+=4)s.copy(t[r]).applyMatrix4(e,c),s.normal.toArray(o,i),o[i+3]=s.constant;l.value=o,l.needsUpdate=!0}return n.numPlanes=a,o}var n=this,i=null,r=0,a=!1,o=!1,s=new K,c=new Q,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.init=function(t,n,o){var s=0!==t.length||n||0!==r||a;return a=n,i=e(t,o,0),r=t.length,s},this.beginShadows=function(){o=!0,e(null)},this.endShadows=function(){o=!1,t()},this.setState=function(n,s,c,h,u){if(!a||null===n||0===n.length||o&&!s)o?e(null):t();else{s=o?0:r;var d=4*s,p=h.clippingState||null;for(l.value=p,p=e(n,c,d,u),n=0;n!==d;++n)p[n]=i[n];h.clippingState=p,this.numPlanes+=s}}}function qt(e){function n(t,e,n,i){!0===R&&(t*=i,e*=i,n*=i),Ut.clearColor(t,e,n,i)}function i(){Ut.init(),Ut.scissor(Q.copy(lt).multiplyScalar(st)),Ut.viewport(et.copy(ut).multiplyScalar(st)),n(it.r,it.g,it.b,rt)}function a(){Z=z=null,Y="",X=-1,Ut.reset()}function o(t){t.preventDefault(),a(),i(),Nt.clear()}function s(t){t=t.target,t.removeEventListener("dispose",s),h(t),Nt.delete(t)}function h(t){var e=Nt.get(t).program;t.program=void 0,void 0!==e&&Ot.releaseProgram(e)}function u(t,e){return Math.abs(e[0])-Math.abs(t[0])}function d(t,e){return t.object.renderOrder!==e.object.renderOrder?t.object.renderOrder-e.object.renderOrder:t.material.program&&e.material.program&&t.material.program!==e.material.program?t.material.program.id-e.material.program.id:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function p(t,e){return t.object.renderOrder!==e.object.renderOrder?t.object.renderOrder-e.object.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function f(t,e,n,i,r){var a;n.transparent?(i=U,a=++N):(i=P,a=++I),a=i[a],void 0!==a?(a.id=t.id,a.object=t,a.geometry=e,a.material=n,a.z=At.z,a.group=r):(a={id:t.id,object:t,geometry:e,material:n,z:At.z,group:r},i.push(a))}function m(t){if(!dt.intersectsSphere(t))return!1;var e=pt.numPlanes;if(0===e)return!0;var n=B.clippingPlanes,i=t.center;t=-t.radius;var r=0;do if(n[r].distanceToPoint(i)<t)return!1;while(++r!==e);return!0}function g(t,e){if(!1!==t.visible){if(0!==(t.layers.mask&e.layers.mask))if(t.isLight)C.push(t);else if(t.isSprite){var n;(n=!1===t.frustumCulled)||(Tt.center.set(0,0,0),Tt.radius=.7071067811865476,Tt.applyMatrix4(t.matrixWorld),n=!0===m(Tt)),n&&F.push(t)}else if(t.isLensFlare)O.push(t);else if(t.isImmediateRenderObject)!0===B.sortObjects&&(At.setFromMatrixPosition(t.matrixWorld),At.applyProjection(St)),f(t,null,t.material,At.z,null);else if((t.isMesh||t.isLine||t.isPoints)&&(t.isSkinnedMesh&&t.skeleton.update(),(n=!1===t.frustumCulled)||(n=t.geometry,null===n.boundingSphere&&n.computeBoundingSphere(),Tt.copy(n.boundingSphere).applyMatrix4(t.matrixWorld),n=!0===m(Tt)),n)){var i=t.material;if(!0===i.visible)if(!0===B.sortObjects&&(At.setFromMatrixPosition(t.matrixWorld),At.applyProjection(St)),n=Ft.update(t),i.isMultiMaterial)for(var r=n.groups,a=i.materials,i=0,o=r.length;i<o;i++){var s=r[i],c=a[s.materialIndex];!0===c.visible&&f(t,n,c,At.z,s)}else f(t,n,i,At.z,null)}for(n=t.children,i=0,o=n.length;i<o;i++)g(n[i],e)}}function v(t,e,n,i){for(var r=0,a=t.length;r<a;r++){var o=t[r],s=o.object,c=o.geometry,l=void 0===i?o.material:i,o=o.group;if(s.modelViewMatrix.multiplyMatrices(e.matrixWorldInverse,s.matrixWorld),s.normalMatrix.getNormalMatrix(s.modelViewMatrix),s.isImmediateRenderObject){y(l);var h=x(e,n,l,s);Y="",s.render(function(t){B.renderBufferImmediate(t,h,l)})}else null!==s.onBeforeRender&&s.onBeforeRender(),B.renderBufferDirect(e,n,c,l,s,o)}}function y(t){2===t.side?Ut.disable(Ct.CULL_FACE):Ut.enable(Ct.CULL_FACE),Ut.setFlipSided(1===t.side),!0===t.transparent?Ut.setBlending(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.premultipliedAlpha):Ut.setBlending(0),Ut.setDepthFunc(t.depthFunc),Ut.setDepthTest(t.depthTest),Ut.setDepthWrite(t.depthWrite),Ut.setColorWrite(t.colorWrite),Ut.setPolygonOffset(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits)}function x(e,n,i,r){nt=0;var a=Nt.get(i);if(ft&&(xt||e!==Z)&&pt.setState(i.clippingPlanes,i.clipShadows,e,a,e===Z&&i.id===X),!1===i.needsUpdate&&(void 0===a.program?i.needsUpdate=!0:i.fog&&a.fog!==n?i.needsUpdate=!0:i.lights&&a.lightsHash!==Rt.hash?i.needsUpdate=!0:void 0!==a.numClippingPlanes&&a.numClippingPlanes!==pt.numPlanes&&(i.needsUpdate=!0)),i.needsUpdate){t:{var o=Nt.get(i),c=Ot.getParameters(i,Rt,n,pt.numPlanes,r),l=Ot.getProgramCode(i,c),u=o.program,d=!0;if(void 0===u)i.addEventListener("dispose",s);else if(u.code!==l)h(i);else{if(void 0!==c.shaderID)break t;d=!1}if(d&&(c.shaderID?(u=qi[c.shaderID],o.__webglShader={name:i.type,uniforms:t.UniformsUtils.clone(u.uniforms),vertexShader:u.vertexShader,fragmentShader:u.fragmentShader}):o.__webglShader={name:i.type,uniforms:i.uniforms,vertexShader:i.vertexShader,fragmentShader:i.fragmentShader},i.__webglShader=o.__webglShader,u=Ot.acquireProgram(i,c,l),o.program=u,i.program=u),c=u.getAttributes(),i.morphTargets)for(l=i.numSupportedMorphTargets=0;l<B.maxMorphTargets;l++)0<=c["morphTarget"+l]&&i.numSupportedMorphTargets++;if(i.morphNormals)for(l=i.numSupportedMorphNormals=0;l<B.maxMorphNormals;l++)0<=c["morphNormal"+l]&&i.numSupportedMorphNormals++;c=o.__webglShader.uniforms,(i.isShaderMaterial||i.isRawShaderMaterial)&&!0!==i.clipping||(o.numClippingPlanes=pt.numPlanes,c.clippingPlanes=pt.uniform),o.fog=n,o.lightsHash=Rt.hash,i.lights&&(c.ambientLightColor.value=Rt.ambient,c.directionalLights.value=Rt.directional,c.spotLights.value=Rt.spot,c.pointLights.value=Rt.point,c.hemisphereLights.value=Rt.hemi,c.directionalShadowMap.value=Rt.directionalShadowMap,c.directionalShadowMatrix.value=Rt.directionalShadowMatrix,c.spotShadowMap.value=Rt.spotShadowMap,c.spotShadowMatrix.value=Rt.spotShadowMatrix,c.pointShadowMap.value=Rt.pointShadowMap,c.pointShadowMatrix.value=Rt.pointShadowMatrix),l=o.program.getUniforms(),l=G.seqWithValue(l.seq,c),o.uniformsList=l,o.dynamicUniforms=G.splitDynamic(l,c)}i.needsUpdate=!1}var p=!1,d=u=!1,o=a.program,l=o.getUniforms(),c=a.__webglShader.uniforms;if(o.id!==z&&(Ct.useProgram(o.program),z=o.id,d=u=p=!0),i.id!==X&&(X=i.id,u=!0),(p||e!==Z)&&(l.set(Ct,e,"projectionMatrix"),It.logarithmicDepthBuffer&&l.setValue(Ct,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),e!==Z&&(Z=e,d=u=!0),(i.isShaderMaterial||i.isMeshPhongMaterial||i.isMeshStandardMaterial||i.envMap)&&(p=l.map.cameraPosition,void 0!==p&&p.setValue(Ct,At.setFromMatrixPosition(e.matrixWorld))),(i.isMeshPhongMaterial||i.isMeshLambertMaterial||i.isMeshBasicMaterial||i.isMeshStandardMaterial||i.isShaderMaterial||i.skinning)&&l.setValue(Ct,"viewMatrix",e.matrixWorldInverse),l.set(Ct,B,"toneMappingExposure"),l.set(Ct,B,"toneMappingWhitePoint")),i.skinning&&(l.setOptional(Ct,r,"bindMatrix"),l.setOptional(Ct,r,"bindMatrixInverse"),p=r.skeleton)&&(It.floatVertexTextures&&p.useVertexTexture?(l.set(Ct,p,"boneTexture"),l.set(Ct,p,"boneTextureWidth"),l.set(Ct,p,"boneTextureHeight")):l.setOptional(Ct,p,"boneMatrices")),u){if(i.lights&&(u=d,c.ambientLightColor.needsUpdate=u,c.directionalLights.needsUpdate=u,
c.pointLights.needsUpdate=u,c.spotLights.needsUpdate=u,c.hemisphereLights.needsUpdate=u),n&&i.fog&&(c.fogColor.value=n.color,n.isFog?(c.fogNear.value=n.near,c.fogFar.value=n.far):n.isFogExp2&&(c.fogDensity.value=n.density)),i.isMeshBasicMaterial||i.isMeshLambertMaterial||i.isMeshPhongMaterial||i.isMeshStandardMaterial||i.isMeshDepthMaterial){c.opacity.value=i.opacity,c.diffuse.value=i.color,i.emissive&&c.emissive.value.copy(i.emissive).multiplyScalar(i.emissiveIntensity),c.map.value=i.map,c.specularMap.value=i.specularMap,c.alphaMap.value=i.alphaMap,i.aoMap&&(c.aoMap.value=i.aoMap,c.aoMapIntensity.value=i.aoMapIntensity);var f;i.map?f=i.map:i.specularMap?f=i.specularMap:i.displacementMap?f=i.displacementMap:i.normalMap?f=i.normalMap:i.bumpMap?f=i.bumpMap:i.roughnessMap?f=i.roughnessMap:i.metalnessMap?f=i.metalnessMap:i.alphaMap?f=i.alphaMap:i.emissiveMap&&(f=i.emissiveMap),void 0!==f&&(f.isWebGLRenderTarget&&(f=f.texture),n=f.offset,f=f.repeat,c.offsetRepeat.value.set(n.x,n.y,f.x,f.y)),c.envMap.value=i.envMap,c.flipEnvMap.value=i.envMap&&i.envMap.isCubeTexture?-1:1,c.reflectivity.value=i.reflectivity,c.refractionRatio.value=i.refractionRatio}i.isLineBasicMaterial?(c.diffuse.value=i.color,c.opacity.value=i.opacity):i.isLineDashedMaterial?(c.diffuse.value=i.color,c.opacity.value=i.opacity,c.dashSize.value=i.dashSize,c.totalSize.value=i.dashSize+i.gapSize,c.scale.value=i.scale):i.isPointsMaterial?(c.diffuse.value=i.color,c.opacity.value=i.opacity,c.size.value=i.size*st,c.scale.value=.5*_.clientHeight,c.map.value=i.map,null!==i.map&&(f=i.map.offset,n=i.map.repeat,c.offsetRepeat.value.set(f.x,f.y,n.x,n.y))):i.isMeshLambertMaterial?(i.lightMap&&(c.lightMap.value=i.lightMap,c.lightMapIntensity.value=i.lightMapIntensity),i.emissiveMap&&(c.emissiveMap.value=i.emissiveMap)):i.isMeshPhongMaterial?(c.specular.value=i.specular,c.shininess.value=Math.max(i.shininess,1e-4),i.lightMap&&(c.lightMap.value=i.lightMap,c.lightMapIntensity.value=i.lightMapIntensity),i.emissiveMap&&(c.emissiveMap.value=i.emissiveMap),i.bumpMap&&(c.bumpMap.value=i.bumpMap,c.bumpScale.value=i.bumpScale),i.normalMap&&(c.normalMap.value=i.normalMap,c.normalScale.value.copy(i.normalScale)),i.displacementMap&&(c.displacementMap.value=i.displacementMap,c.displacementScale.value=i.displacementScale,c.displacementBias.value=i.displacementBias)):i.isMeshPhysicalMaterial?(c.clearCoat.value=i.clearCoat,c.clearCoatRoughness.value=i.clearCoatRoughness,b(c,i)):i.isMeshStandardMaterial?b(c,i):i.isMeshDepthMaterial?i.displacementMap&&(c.displacementMap.value=i.displacementMap,c.displacementScale.value=i.displacementScale,c.displacementBias.value=i.displacementBias):i.isMeshNormalMaterial&&(c.opacity.value=i.opacity),G.upload(Ct,a.uniformsList,c,B)}return l.set(Ct,r,"modelViewMatrix"),l.set(Ct,r,"normalMatrix"),l.setValue(Ct,"modelMatrix",r.matrixWorld),a=a.dynamicUniforms,null!==a&&(G.evalDynamic(a,c,r,i,e),G.upload(Ct,a,c,B)),o}function b(t,e){t.roughness.value=e.roughness,t.metalness.value=e.metalness,e.roughnessMap&&(t.roughnessMap.value=e.roughnessMap),e.metalnessMap&&(t.metalnessMap.value=e.metalnessMap),e.lightMap&&(t.lightMap.value=e.lightMap,t.lightMapIntensity.value=e.lightMapIntensity),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale)),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias),e.envMap&&(t.envMapIntensity.value=e.envMapIntensity)}function w(t){var e;if(1e3===t)return Ct.REPEAT;if(1001===t)return Ct.CLAMP_TO_EDGE;if(1002===t)return Ct.MIRRORED_REPEAT;if(1003===t)return Ct.NEAREST;if(1004===t)return Ct.NEAREST_MIPMAP_NEAREST;if(1005===t)return Ct.NEAREST_MIPMAP_LINEAR;if(1006===t)return Ct.LINEAR;if(1007===t)return Ct.LINEAR_MIPMAP_NEAREST;if(1008===t)return Ct.LINEAR_MIPMAP_LINEAR;if(1009===t)return Ct.UNSIGNED_BYTE;if(1017===t)return Ct.UNSIGNED_SHORT_4_4_4_4;if(1018===t)return Ct.UNSIGNED_SHORT_5_5_5_1;if(1019===t)return Ct.UNSIGNED_SHORT_5_6_5;if(1010===t)return Ct.BYTE;if(1011===t)return Ct.SHORT;if(1012===t)return Ct.UNSIGNED_SHORT;if(1013===t)return Ct.INT;if(1014===t)return Ct.UNSIGNED_INT;if(1015===t)return Ct.FLOAT;if(e=Pt.get("OES_texture_half_float"),null!==e&&1016===t)return e.HALF_FLOAT_OES;if(1021===t)return Ct.ALPHA;if(1022===t)return Ct.RGB;if(1023===t)return Ct.RGBA;if(1024===t)return Ct.LUMINANCE;if(1025===t)return Ct.LUMINANCE_ALPHA;if(1026===t)return Ct.DEPTH_COMPONENT;if(1027===t)return Ct.DEPTH_STENCIL;if(100===t)return Ct.FUNC_ADD;if(101===t)return Ct.FUNC_SUBTRACT;if(102===t)return Ct.FUNC_REVERSE_SUBTRACT;if(200===t)return Ct.ZERO;if(201===t)return Ct.ONE;if(202===t)return Ct.SRC_COLOR;if(203===t)return Ct.ONE_MINUS_SRC_COLOR;if(204===t)return Ct.SRC_ALPHA;if(205===t)return Ct.ONE_MINUS_SRC_ALPHA;if(206===t)return Ct.DST_ALPHA;if(207===t)return Ct.ONE_MINUS_DST_ALPHA;if(208===t)return Ct.DST_COLOR;if(209===t)return Ct.ONE_MINUS_DST_COLOR;if(210===t)return Ct.SRC_ALPHA_SATURATE;if(e=Pt.get("WEBGL_compressed_texture_s3tc"),null!==e){if(2001===t)return e.COMPRESSED_RGB_S3TC_DXT1_EXT;if(2002===t)return e.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(2003===t)return e.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(2004===t)return e.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(e=Pt.get("WEBGL_compressed_texture_pvrtc"),null!==e){if(2100===t)return e.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(2101===t)return e.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(2102===t)return e.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(2103===t)return e.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(e=Pt.get("WEBGL_compressed_texture_etc1"),null!==e&&2151===t)return e.COMPRESSED_RGB_ETC1_WEBGL;if(e=Pt.get("EXT_blend_minmax"),null!==e){if(103===t)return e.MIN_EXT;if(104===t)return e.MAX_EXT}return e=Pt.get("WEBGL_depth_texture"),null!==e&&1020===t?e.UNSIGNED_INT_24_8_WEBGL:0}console.log("THREE.WebGLRenderer","81"),e=e||{};var _=void 0!==e.canvas?e.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),M=void 0!==e.context?e.context:null,E=void 0!==e.alpha&&e.alpha,T=void 0===e.depth||e.depth,S=void 0===e.stencil||e.stencil,A=void 0!==e.antialias&&e.antialias,R=void 0===e.premultipliedAlpha||e.premultipliedAlpha,L=void 0!==e.preserveDrawingBuffer&&e.preserveDrawingBuffer,C=[],P=[],I=-1,U=[],N=-1,D=new Float32Array(8),F=[],O=[];this.domElement=_,this.context=null,this.sortObjects=this.autoClearStencil=this.autoClearDepth=this.autoClearColor=this.autoClear=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.physicallyCorrectLights=this.gammaOutput=this.gammaInput=!1,this.toneMappingWhitePoint=this.toneMappingExposure=this.toneMapping=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var B=this,z=null,H=null,V=null,X=-1,Y="",Z=null,Q=new r,K=null,et=new r,nt=0,it=new k(0),rt=0,at=_.width,ot=_.height,st=1,lt=new r(0,0,at,ot),ht=!1,ut=new r(0,0,at,ot),dt=new $,pt=new Xt,ft=!1,xt=!1,Tt=new J,St=new l,At=new c,Rt={hash:"",ambient:[0,0,0],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],shadows:[]},Lt={calls:0,vertices:0,faces:0,points:0};this.info={render:Lt,memory:{geometries:0,textures:0},programs:null};var Ct;try{if(E={alpha:E,depth:T,stencil:S,antialias:A,premultipliedAlpha:R,preserveDrawingBuffer:L},Ct=M||_.getContext("webgl",E)||_.getContext("experimental-webgl",E),null===Ct){if(null!==_.getContext("webgl"))throw"Error creating WebGL context with your selected attributes.";throw"Error creating WebGL context."}void 0===Ct.getShaderPrecisionFormat&&(Ct.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}}),_.addEventListener("webglcontextlost",o,!1)}catch(t){console.error("THREE.WebGLRenderer: "+t)}var Pt=new Wt(Ct);Pt.get("WEBGL_depth_texture"),Pt.get("OES_texture_float"),Pt.get("OES_texture_float_linear"),Pt.get("OES_texture_half_float"),Pt.get("OES_texture_half_float_linear"),Pt.get("OES_standard_derivatives"),Pt.get("ANGLE_instanced_arrays"),Pt.get("OES_element_index_uint")&&(mt.MaxIndex=4294967296);var It=new jt(Ct,Pt,e),Ut=new Vt(Ct,Pt,w),Nt=new kt,Dt=new Gt(Ct,Pt,Ut,Nt,It,w,this.info),Ft=new Ht(Ct,Nt,this.info),Ot=new Bt(this,It),zt=new Et;this.info.programs=Ot.programs;var qt=new Mt(Ct,Pt,Lt),Yt=new _t(Ct,Pt,Lt),Zt=new wt((-1),1,1,(-1),0,1),Jt=new bt,Qt=new gt(new yt(2,2),new ct({depthTest:!1,depthWrite:!1,fog:!1}));e=qi.cube;var Kt=new gt(new vt(5,5,5),new q({uniforms:e.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1}));i(),this.context=Ct,this.capabilities=It,this.extensions=Pt,this.properties=Nt,this.state=Ut;var $t=new tt(this,Rt,Ft,It);this.shadowMap=$t;var te=new W(this,F),ee=new j(this,O);this.getContext=function(){return Ct},this.getContextAttributes=function(){return Ct.getContextAttributes()},this.forceContextLoss=function(){Pt.get("WEBGL_lose_context").loseContext()},this.getMaxAnisotropy=function(){return It.getMaxAnisotropy()},this.getPrecision=function(){return It.precision},this.getPixelRatio=function(){return st},this.setPixelRatio=function(t){void 0!==t&&(st=t,this.setSize(ut.z,ut.w,!1))},this.getSize=function(){return{width:at,height:ot}},this.setSize=function(t,e,n){at=t,ot=e,_.width=t*st,_.height=e*st,!1!==n&&(_.style.width=t+"px",_.style.height=e+"px"),this.setViewport(0,0,t,e)},this.setViewport=function(t,e,n,i){Ut.viewport(ut.set(t,e,n,i))},this.setScissor=function(t,e,n,i){Ut.scissor(lt.set(t,e,n,i))},this.setScissorTest=function(t){Ut.setScissorTest(ht=t)},this.getClearColor=function(){return it},this.setClearColor=function(t,e){it.set(t),rt=void 0!==e?e:1,n(it.r,it.g,it.b,rt)},this.getClearAlpha=function(){return rt},this.setClearAlpha=function(t){rt=t,n(it.r,it.g,it.b,rt)},this.clear=function(t,e,n){var i=0;(void 0===t||t)&&(i|=Ct.COLOR_BUFFER_BIT),(void 0===e||e)&&(i|=Ct.DEPTH_BUFFER_BIT),(void 0===n||n)&&(i|=Ct.STENCIL_BUFFER_BIT),Ct.clear(i)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.clearTarget=function(t,e,n,i){this.setRenderTarget(t),this.clear(e,n,i)},this.resetGLState=a,this.dispose=function(){U=[],N=-1,P=[],I=-1,_.removeEventListener("webglcontextlost",o,!1)},this.renderBufferImmediate=function(t,e,n){Ut.initAttributes();var i=Nt.get(t);if(t.hasPositions&&!i.position&&(i.position=Ct.createBuffer()),t.hasNormals&&!i.normal&&(i.normal=Ct.createBuffer()),t.hasUvs&&!i.uv&&(i.uv=Ct.createBuffer()),t.hasColors&&!i.color&&(i.color=Ct.createBuffer()),e=e.getAttributes(),t.hasPositions&&(Ct.bindBuffer(Ct.ARRAY_BUFFER,i.position),Ct.bufferData(Ct.ARRAY_BUFFER,t.positionArray,Ct.DYNAMIC_DRAW),Ut.enableAttribute(e.position),Ct.vertexAttribPointer(e.position,3,Ct.FLOAT,!1,0,0)),t.hasNormals){if(Ct.bindBuffer(Ct.ARRAY_BUFFER,i.normal),!n.isMeshPhongMaterial&&!n.isMeshStandardMaterial&&1===n.shading)for(var r=0,a=3*t.count;r<a;r+=9){var o=t.normalArray,s=(o[r+0]+o[r+3]+o[r+6])/3,c=(o[r+1]+o[r+4]+o[r+7])/3,l=(o[r+2]+o[r+5]+o[r+8])/3;o[r+0]=s,o[r+1]=c,o[r+2]=l,o[r+3]=s,o[r+4]=c,o[r+5]=l,o[r+6]=s,o[r+7]=c,o[r+8]=l}Ct.bufferData(Ct.ARRAY_BUFFER,t.normalArray,Ct.DYNAMIC_DRAW),Ut.enableAttribute(e.normal),Ct.vertexAttribPointer(e.normal,3,Ct.FLOAT,!1,0,0)}t.hasUvs&&n.map&&(Ct.bindBuffer(Ct.ARRAY_BUFFER,i.uv),Ct.bufferData(Ct.ARRAY_BUFFER,t.uvArray,Ct.DYNAMIC_DRAW),Ut.enableAttribute(e.uv),Ct.vertexAttribPointer(e.uv,2,Ct.FLOAT,!1,0,0)),t.hasColors&&0!==n.vertexColors&&(Ct.bindBuffer(Ct.ARRAY_BUFFER,i.color),Ct.bufferData(Ct.ARRAY_BUFFER,t.colorArray,Ct.DYNAMIC_DRAW),Ut.enableAttribute(e.color),Ct.vertexAttribPointer(e.color,3,Ct.FLOAT,!1,0,0)),Ut.disableUnusedAttributes(),Ct.drawArrays(Ct.TRIANGLES,0,t.count),t.count=0},this.renderBufferDirect=function(t,e,n,i,r,a){y(i);var o=x(t,e,i,r),s=!1;if(t=n.id+"_"+o.id+"_"+i.wireframe,t!==Y&&(Y=t,s=!0),e=r.morphTargetInfluences,void 0!==e){var c=[];t=0;for(var l=e.length;t<l;t++)s=e[t],c.push([s,t]);c.sort(u),8<c.length&&(c.length=8);var h=n.morphAttributes;for(t=0,l=c.length;t<l;t++)s=c[t],D[t]=s[0],0!==s[0]?(e=s[1],!0===i.morphTargets&&h.position&&n.addAttribute("morphTarget"+t,h.position[e]),!0===i.morphNormals&&h.normal&&n.addAttribute("morphNormal"+t,h.normal[e])):(!0===i.morphTargets&&n.removeAttribute("morphTarget"+t),!0===i.morphNormals&&n.removeAttribute("morphNormal"+t));for(t=c.length,e=D.length;t<e;t++)D[t]=0;o.getUniforms().setValue(Ct,"morphTargetInfluences",D),s=!0}if(e=n.index,l=n.attributes.position,c=1,!0===i.wireframe&&(e=Ft.getWireframeAttribute(n),c=2),null!==e?(t=Yt,t.setIndex(e)):t=qt,s){var d,s=void 0;if(n&&n.isInstancedBufferGeometry&&(d=Pt.get("ANGLE_instanced_arrays"),null===d))console.error("THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");else{void 0===s&&(s=0),Ut.initAttributes();var p,h=n.attributes,o=o.getAttributes(),f=i.defaultAttributeValues;for(p in o){var m=o[p];if(0<=m){var g=h[p];if(void 0!==g){var v=Ct.FLOAT,b=g.array,w=g.normalized;b instanceof Float32Array?v=Ct.FLOAT:b instanceof Float64Array?console.warn("Unsupported data buffer format: Float64Array"):b instanceof Uint16Array?v=Ct.UNSIGNED_SHORT:b instanceof Int16Array?v=Ct.SHORT:b instanceof Uint32Array?v=Ct.UNSIGNED_INT:b instanceof Int32Array?v=Ct.INT:b instanceof Int8Array?v=Ct.BYTE:b instanceof Uint8Array&&(v=Ct.UNSIGNED_BYTE);var b=g.itemSize,_=Ft.getAttributeBuffer(g);if(g&&g.isInterleavedBufferAttribute){var M=g.data,E=M.stride,g=g.offset;M&&M.isInstancedInterleavedBuffer?(Ut.enableAttributeAndDivisor(m,M.meshPerAttribute,d),void 0===n.maxInstancedCount&&(n.maxInstancedCount=M.meshPerAttribute*M.count)):Ut.enableAttribute(m),Ct.bindBuffer(Ct.ARRAY_BUFFER,_),Ct.vertexAttribPointer(m,b,v,w,E*M.array.BYTES_PER_ELEMENT,(s*E+g)*M.array.BYTES_PER_ELEMENT)}else g&&g.isInstancedBufferAttribute?(Ut.enableAttributeAndDivisor(m,g.meshPerAttribute,d),void 0===n.maxInstancedCount&&(n.maxInstancedCount=g.meshPerAttribute*g.count)):Ut.enableAttribute(m),Ct.bindBuffer(Ct.ARRAY_BUFFER,_),Ct.vertexAttribPointer(m,b,v,w,0,s*b*g.array.BYTES_PER_ELEMENT)}else if(void 0!==f&&(v=f[p],void 0!==v))switch(v.length){case 2:Ct.vertexAttrib2fv(m,v);break;case 3:Ct.vertexAttrib3fv(m,v);break;case 4:Ct.vertexAttrib4fv(m,v);break;default:Ct.vertexAttrib1fv(m,v)}}}Ut.disableUnusedAttributes()}null!==e&&Ct.bindBuffer(Ct.ELEMENT_ARRAY_BUFFER,Ft.getAttributeBuffer(e))}if(d=0,null!==e?d=e.count:void 0!==l&&(d=l.count),e=n.drawRange.start*c,l=null!==a?a.start*c:0,p=Math.max(e,l),a=Math.max(0,Math.min(d,e+n.drawRange.count*c,l+(null!==a?a.count*c:1/0))-1-p+1),0!==a){if(r.isMesh)if(!0===i.wireframe)Ut.setLineWidth(i.wireframeLinewidth*(null===H?st:1)),t.setMode(Ct.LINES);else switch(r.drawMode){case 0:t.setMode(Ct.TRIANGLES);break;case 1:t.setMode(Ct.TRIANGLE_STRIP);break;case 2:t.setMode(Ct.TRIANGLE_FAN)}else r.isLine?(i=i.linewidth,void 0===i&&(i=1),Ut.setLineWidth(i*(null===H?st:1)),r.isLineSegments?t.setMode(Ct.LINES):t.setMode(Ct.LINE_STRIP)):r.isPoints&&t.setMode(Ct.POINTS);n&&n.isInstancedBufferGeometry?0<n.maxInstancedCount&&t.renderInstances(n,p,a):t.render(p,a)}},this.render=function(t,e,i,r){if(void 0!==e&&!0!==e.isCamera)console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");else{var a=t.fog;Y="",X=-1,Z=null,!0===t.autoUpdate&&t.updateMatrixWorld(),null===e.parent&&e.updateMatrixWorld(),e.matrixWorldInverse.getInverse(e.matrixWorld),St.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),dt.setFromMatrix(St),C.length=0,N=I=-1,F.length=0,O.length=0,xt=this.localClippingEnabled,ft=pt.init(this.clippingPlanes,xt,e),g(t,e),P.length=I+1,U.length=N+1,!0===B.sortObjects&&(P.sort(d),U.sort(p)),ft&&pt.beginShadows();for(var o=C,s=0,c=0,h=o.length;c<h;c++){var u=o[c];u.castShadow&&(Rt.shadows[s++]=u)}Rt.shadows.length=s,$t.render(t,e);for(var f,m,y,x,o=C,b=u=0,w=0,_=e.matrixWorldInverse,M=0,E=0,T=0,S=0,s=0,c=o.length;s<c;s++)if(h=o[s],f=h.color,m=h.intensity,y=h.distance,x=h.shadow&&h.shadow.map?h.shadow.map.texture:null,h.isAmbientLight)u+=f.r*m,b+=f.g*m,w+=f.b*m;else if(h.isDirectionalLight){var A=zt.get(h);A.color.copy(h.color).multiplyScalar(h.intensity),A.direction.setFromMatrixPosition(h.matrixWorld),At.setFromMatrixPosition(h.target.matrixWorld),A.direction.sub(At),A.direction.transformDirection(_),(A.shadow=h.castShadow)&&(A.shadowBias=h.shadow.bias,A.shadowRadius=h.shadow.radius,A.shadowMapSize=h.shadow.mapSize),Rt.directionalShadowMap[M]=x,Rt.directionalShadowMatrix[M]=h.shadow.matrix,Rt.directional[M++]=A}else h.isSpotLight?(A=zt.get(h),A.position.setFromMatrixPosition(h.matrixWorld),A.position.applyMatrix4(_),A.color.copy(f).multiplyScalar(m),A.distance=y,A.direction.setFromMatrixPosition(h.matrixWorld),At.setFromMatrixPosition(h.target.matrixWorld),A.direction.sub(At),A.direction.transformDirection(_),A.coneCos=Math.cos(h.angle),A.penumbraCos=Math.cos(h.angle*(1-h.penumbra)),A.decay=0===h.distance?0:h.decay,(A.shadow=h.castShadow)&&(A.shadowBias=h.shadow.bias,A.shadowRadius=h.shadow.radius,A.shadowMapSize=h.shadow.mapSize),Rt.spotShadowMap[T]=x,Rt.spotShadowMatrix[T]=h.shadow.matrix,Rt.spot[T++]=A):h.isPointLight?(A=zt.get(h),A.position.setFromMatrixPosition(h.matrixWorld),A.position.applyMatrix4(_),A.color.copy(h.color).multiplyScalar(h.intensity),A.distance=h.distance,A.decay=0===h.distance?0:h.decay,(A.shadow=h.castShadow)&&(A.shadowBias=h.shadow.bias,A.shadowRadius=h.shadow.radius,A.shadowMapSize=h.shadow.mapSize),Rt.pointShadowMap[E]=x,void 0===Rt.pointShadowMatrix[E]&&(Rt.pointShadowMatrix[E]=new l),At.setFromMatrixPosition(h.matrixWorld).negate(),Rt.pointShadowMatrix[E].identity().setPosition(At),Rt.point[E++]=A):h.isHemisphereLight&&(A=zt.get(h),A.direction.setFromMatrixPosition(h.matrixWorld),A.direction.transformDirection(_),A.direction.normalize(),A.skyColor.copy(h.color).multiplyScalar(m),A.groundColor.copy(h.groundColor).multiplyScalar(m),Rt.hemi[S++]=A);Rt.ambient[0]=u,Rt.ambient[1]=b,Rt.ambient[2]=w,Rt.directional.length=M,Rt.spot.length=T,Rt.point.length=E,Rt.hemi.length=S,Rt.hash=M+","+E+","+T+","+S+","+Rt.shadows.length,ft&&pt.endShadows(),Lt.calls=0,Lt.vertices=0,Lt.faces=0,Lt.points=0,void 0===i&&(i=null),this.setRenderTarget(i),o=t.background,null===o?n(it.r,it.g,it.b,rt):o&&o.isColor&&(n(o.r,o.g,o.b,1),r=!0),(this.autoClear||r)&&this.clear(this.autoClearColor,this.autoClearDepth,this.autoClearStencil),o&&o.isCubeTexture?(Jt.projectionMatrix.copy(e.projectionMatrix),Jt.matrixWorld.extractRotation(e.matrixWorld),Jt.matrixWorldInverse.getInverse(Jt.matrixWorld),Kt.material.uniforms.tCube.value=o,Kt.modelViewMatrix.multiplyMatrices(Jt.matrixWorldInverse,Kt.matrixWorld),Ft.update(Kt),B.renderBufferDirect(Jt,null,Kt.geometry,Kt.material,Kt,null)):o&&o.isTexture&&(Qt.material.map=o,Ft.update(Qt),B.renderBufferDirect(Zt,null,Qt.geometry,Qt.material,Qt,null)),t.overrideMaterial?(r=t.overrideMaterial,v(P,e,a,r),v(U,e,a,r)):(Ut.setBlending(0),v(P,e,a),v(U,e,a)),te.render(t,e),ee.render(t,e,et),i&&Dt.updateRenderTargetMipmap(i),Ut.setDepthTest(!0),Ut.setDepthWrite(!0),Ut.setColorWrite(!0)}},this.setFaceCulling=function(t,e){Ut.setCullFace(t),Ut.setFlipSided(0===e)},this.allocTextureUnit=function(){var t=nt;return t>=It.maxTextures&&console.warn("WebGLRenderer: trying to use "+t+" texture units while this GPU supports only "+It.maxTextures),nt+=1,t},this.setTexture2D=function(){var t=!1;return function(e,n){e&&e.isWebGLRenderTarget&&(t||(console.warn("THREE.WebGLRenderer.setTexture2D: don't use render targets as textures. Use their .texture property instead."),t=!0),e=e.texture),Dt.setTexture2D(e,n)}}(),this.setTexture=function(){var t=!1;return function(e,n){t||(console.warn("THREE.WebGLRenderer: .setTexture is deprecated, use setTexture2D instead."),t=!0),Dt.setTexture2D(e,n)}}(),this.setTextureCube=function(){var t=!1;return function(e,n){e&&e.isWebGLRenderTargetCube&&(t||(console.warn("THREE.WebGLRenderer.setTextureCube: don't use cube render targets as textures. Use their .texture property instead."),t=!0),e=e.texture),e&&e.isCubeTexture||Array.isArray(e.image)&&6===e.image.length?Dt.setTextureCube(e,n):Dt.setTextureCubeDynamic(e,n)}}(),this.getCurrentRenderTarget=function(){return H},this.setRenderTarget=function(t){(H=t)&&void 0===Nt.get(t).__webglFramebuffer&&Dt.setupRenderTarget(t);var e,n=t&&t.isWebGLRenderTargetCube;t?(e=Nt.get(t),e=n?e.__webglFramebuffer[t.activeCubeFace]:e.__webglFramebuffer,Q.copy(t.scissor),K=t.scissorTest,et.copy(t.viewport)):(e=null,Q.copy(lt).multiplyScalar(st),K=ht,et.copy(ut).multiplyScalar(st)),V!==e&&(Ct.bindFramebuffer(Ct.FRAMEBUFFER,e),V=e),Ut.scissor(Q),Ut.setScissorTest(K),Ut.viewport(et),n&&(n=Nt.get(t.texture),Ct.framebufferTexture2D(Ct.FRAMEBUFFER,Ct.COLOR_ATTACHMENT0,Ct.TEXTURE_CUBE_MAP_POSITIVE_X+t.activeCubeFace,n.__webglTexture,t.activeMipMapLevel))},this.readRenderTargetPixels=function(t,e,n,i,r,a){if(!1===(t&&t.isWebGLRenderTarget))console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");else{var o=Nt.get(t).__webglFramebuffer;if(o){var s=!1;o!==V&&(Ct.bindFramebuffer(Ct.FRAMEBUFFER,o),s=!0);try{var c=t.texture,l=c.format,h=c.type;1023!==l&&w(l)!==Ct.getParameter(Ct.IMPLEMENTATION_COLOR_READ_FORMAT)?console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format."):1009===h||w(h)===Ct.getParameter(Ct.IMPLEMENTATION_COLOR_READ_TYPE)||1015===h&&(Pt.get("OES_texture_float")||Pt.get("WEBGL_color_buffer_float"))||1016===h&&Pt.get("EXT_color_buffer_half_float")?Ct.checkFramebufferStatus(Ct.FRAMEBUFFER)===Ct.FRAMEBUFFER_COMPLETE?0<=e&&e<=t.width-i&&0<=n&&n<=t.height-r&&Ct.readPixels(e,n,i,r,w(l),w(h),a):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete."):console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.")}finally{s&&Ct.bindFramebuffer(Ct.FRAMEBUFFER,V)}}}}}function Yt(t,e){this.name="",this.color=new k(t),this.density=void 0!==e?e:25e-5}function Zt(t,e,n){this.name="",this.color=new k(t),this.near=void 0!==e?e:1,this.far=void 0!==n?n:1e3}function Jt(){rt.call(this),this.type="Scene",this.overrideMaterial=this.fog=this.background=null,this.autoUpdate=!0}function Qt(t,e,n,i,r){rt.call(this),this.lensFlares=[],this.positionScreen=new c,this.customUpdateCallback=void 0,void 0!==t&&this.add(t,e,n,i,r)}function Kt(t){X.call(this),this.type="SpriteMaterial",this.color=new k(16777215),this.map=null,this.rotation=0,this.lights=this.fog=!1,this.setValues(t)}function $t(t){rt.call(this),this.type="Sprite",this.material=void 0!==t?t:new Kt}function te(){rt.call(this),this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}})}function ee(t,e,n,r,a,o,s,c,l,h,u,d){i.call(this,null,o,s,c,l,h,r,a,u,d),this.image={data:t,width:e,height:n},this.magFilter=void 0!==l?l:1003,this.minFilter=void 0!==h?h:1003,this.generateMipmaps=this.flipY=!1}function ne(e,n,i){if(this.useVertexTexture=void 0===i||i,this.identityMatrix=new l,e=e||[],this.bones=e.slice(0),this.useVertexTexture?(e=Math.sqrt(4*this.bones.length),e=t.Math.nextPowerOfTwo(Math.ceil(e)),this.boneTextureHeight=this.boneTextureWidth=e=Math.max(e,4),this.boneMatrices=new Float32Array(this.boneTextureWidth*this.boneTextureHeight*4),this.boneTexture=new ee(this.boneMatrices,this.boneTextureWidth,this.boneTextureHeight,1023,1015)):this.boneMatrices=new Float32Array(16*this.bones.length),void 0===n)this.calculateInverses();else if(this.bones.length===n.length)this.boneInverses=n.slice(0);else for(console.warn("THREE.Skeleton bonInverses is the wrong length."),this.boneInverses=[],n=0,e=this.bones.length;n<e;n++)this.boneInverses.push(new l)}function ie(t){rt.call(this),this.type="Bone",this.skin=t}function re(t,e,n){if(gt.call(this,t,e),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new l,this.bindMatrixInverse=new l,t=[],this.geometry&&void 0!==this.geometry.bones){for(var i,r=0,a=this.geometry.bones.length;r<a;++r)i=this.geometry.bones[r],e=new ie(this),t.push(e),e.name=i.name,e.position.fromArray(i.pos),e.quaternion.fromArray(i.rotq),void 0!==i.scl&&e.scale.fromArray(i.scl);for(r=0,a=this.geometry.bones.length;r<a;++r)i=this.geometry.bones[r],-1!==i.parent&&null!==i.parent&&void 0!==t[i.parent]?t[i.parent].add(t[r]):this.add(t[r])}this.normalizeSkinWeights(),this.updateMatrixWorld(!0),this.bind(new ne(t,(void 0),n),this.matrixWorld)}function ae(t){X.call(this),this.type="LineBasicMaterial",this.color=new k(16777215),this.linewidth=1,this.linejoin=this.linecap="round",this.lights=!1,this.setValues(t)}function oe(t,e,n){return 1===n?(console.warn("THREE.Line: parameter THREE.LinePieces no longer supported. Created THREE.LineSegments instead."),new se(t,e)):(rt.call(this),this.type="Line",this.geometry=void 0!==t?t:new mt,void(this.material=void 0!==e?e:new ae({color:16777215*Math.random()})))}function se(t,e){oe.call(this,t,e),this.type="LineSegments"}function ce(t){X.call(this),this.type="PointsMaterial",this.color=new k(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.lights=!1,this.setValues(t)}function le(t,e){rt.call(this),this.type="Points",this.geometry=void 0!==t?t:new mt,this.material=void 0!==e?e:new ce({color:16777215*Math.random()})}function he(){rt.call(this),this.type="Group"}function ue(t,e,n,r,a,o,s,c,l){function h(){requestAnimationFrame(h),t.readyState>=t.HAVE_CURRENT_DATA&&(u.needsUpdate=!0)}i.call(this,t,e,n,r,a,o,s,c,l),this.generateMipmaps=!1;var u=this;h()}function de(t,e,n,r,a,o,s,c,l,h,u,d){i.call(this,null,o,s,c,l,h,r,a,u,d),this.image={width:e,height:n},this.mipmaps=t,this.generateMipmaps=this.flipY=!1}function pe(t,e,n,r,a,o,s,c,l){i.call(this,t,e,n,r,a,o,s,c,l),this.needsUpdate=!0}function fe(t,e,n,r,a,o,s,c,l,h){if(h=void 0!==h?h:1026,1026!==h&&1027!==h)throw Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");i.call(this,null,r,a,o,s,c,h,n,l),this.image={width:t,height:e},this.type=void 0!==n?n:1012,this.magFilter=void 0!==s?s:1003,this.minFilter=void 0!==c?c:1003,this.generateMipmaps=this.flipY=!1}function me(t){function e(t,e){return t-e}mt.call(this);var n=[0,0],i={},r=["a","b","c"];if(t&&t.isGeometry){var a=t.vertices,o=t.faces,s=0,c=new Uint32Array(6*o.length);t=0;for(var l=o.length;t<l;t++)for(var h=o[t],u=0;3>u;u++){n[0]=h[r[u]],n[1]=h[r[(u+1)%3]],n.sort(e);var d=n.toString();void 0===i[d]&&(c[2*s]=n[0],c[2*s+1]=n[1],i[d]=!0,s++)}for(n=new Float32Array(6*s),t=0,l=s;t<l;t++)for(u=0;2>u;u++)i=a[c[2*t+u]],s=6*t+3*u,n[s+0]=i.x,n[s+1]=i.y,n[s+2]=i.z;this.addAttribute("position",new lt(n,3))}else if(t&&t.isBufferGeometry){if(null!==t.index){for(l=t.index.array,a=t.attributes.position,r=t.groups,s=0,0===r.length&&t.addGroup(0,l.length),c=new Uint32Array(2*l.length),o=0,h=r.length;o<h;++o){t=r[o],u=t.start,d=t.count,t=u;for(var p=u+d;t<p;t+=3)for(u=0;3>u;u++)n[0]=l[t+u],n[1]=l[t+(u+1)%3],n.sort(e),d=n.toString(),void 0===i[d]&&(c[2*s]=n[0],c[2*s+1]=n[1],i[d]=!0,s++)}for(n=new Float32Array(6*s),t=0,l=s;t<l;t++)for(u=0;2>u;u++)s=6*t+3*u,i=c[2*t+u],n[s+0]=a.getX(i),n[s+1]=a.getY(i),n[s+2]=a.getZ(i)}else for(a=t.attributes.position.array,s=a.length/3,c=s/3,n=new Float32Array(6*s),t=0,l=c;t<l;t++)for(u=0;3>u;u++)s=18*t+6*u,c=9*t+3*u,n[s+0]=a[c],n[s+1]=a[c+1],n[s+2]=a[c+2],i=9*t+(u+1)%3*3,n[s+3]=a[i],n[s+4]=a[i+1],n[s+5]=a[i+2];this.addAttribute("position",new lt(n,3))}}function ge(t,e,i){pt.call(this),this.type="ParametricGeometry",this.parameters={func:t,slices:e,stacks:i};var r,a,o,s,c=this.vertices,l=this.faces,h=this.faceVertexUvs[0],u=e+1;for(r=0;r<=i;r++)for(s=r/i,a=0;a<=e;a++)o=a/e,o=t(o,s),c.push(o);var d,p,f,m;for(r=0;r<i;r++)for(a=0;a<e;a++)t=r*u+a,c=r*u+a+1,s=(r+1)*u+a+1,o=(r+1)*u+a,d=new n(a/e,r/i),p=new n((a+1)/e,r/i),f=new n((a+1)/e,(r+1)/i),m=new n(a/e,(r+1)/i),l.push(new st(t,c,o)),h.push([d,p,m]),l.push(new st(c,s,o)),h.push([p.clone(),f,m.clone()]);this.computeFaceNormals(),this.computeVertexNormals()}function ve(t,e,i,r){function a(t){var e=t.normalize().clone();return e.index=h.vertices.push(e)-1,e.uv=new n(Math.atan2(t.z,-t.x)/2/Math.PI+.5,1-(Math.atan2(-t.y,Math.sqrt(t.x*t.x+t.z*t.z))/Math.PI+.5)),e}function o(t,e,n){var i=new st(t.index,e.index,n.index,[t.clone(),e.clone(),n.clone()]);h.faces.push(i),y.copy(t).add(e).add(n).divideScalar(3),i=Math.atan2(y.z,-y.x),h.faceVertexUvs[0].push([l(t.uv,t,i),l(e.uv,e,i),l(n.uv,n,i)])}function s(t,e){for(var n=Math.pow(2,e),i=a(h.vertices[t.a]),r=a(h.vertices[t.b]),s=a(h.vertices[t.c]),c=[],l=0;l<=n;l++){c[l]=[];for(var u=a(i.clone().lerp(s,l/n)),d=a(r.clone().lerp(s,l/n)),p=n-l,f=0;f<=p;f++)c[l][f]=0===f&&l===n?u:a(u.clone().lerp(d,f/p))}for(l=0;l<n;l++)for(f=0;f<2*(n-l)-1;f++)i=Math.floor(f/2),0===f%2?o(c[l][i+1],c[l+1][i],c[l][i]):o(c[l][i+1],c[l+1][i+1],c[l+1][i])}function l(t,e,i){return 0>i&&1===t.x&&(t=new n(t.x-1,t.y)),0===e.x&&0===e.z&&(t=new n(i/2/Math.PI+.5,t.y)),t.clone()}pt.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:t,indices:e,radius:i,detail:r},i=i||1,r=r||0;for(var h=this,u=0,d=t.length;u<d;u+=3)a(new c(t[u],t[u+1],t[u+2]));t=this.vertices;for(var p=[],f=u=0,d=e.length;u<d;u+=3,f++){var m=t[e[u]],g=t[e[u+1]],v=t[e[u+2]];p[f]=new st(m.index,g.index,v.index,[m.clone(),g.clone(),v.clone()])}for(var y=new c,u=0,d=p.length;u<d;u++)s(p[u],r);for(u=0,d=this.faceVertexUvs[0].length;u<d;u++)e=this.faceVertexUvs[0][u],r=e[0].x,t=e[1].x,p=e[2].x,f=Math.min(r,t,p),.9<Math.max(r,t,p)&&.1>f&&(.2>r&&(e[0].x+=1),.2>t&&(e[1].x+=1),.2>p&&(e[2].x+=1));for(u=0,d=this.vertices.length;u<d;u++)this.vertices[u].multiplyScalar(i);this.mergeVertices(),this.computeFaceNormals(),this.boundingSphere=new J(new c,i)}function ye(t,e){ve.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],t,e),this.type="TetrahedronGeometry",this.parameters={radius:t,detail:e}}function xe(t,e){ve.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],t,e),this.type="OctahedronGeometry",this.parameters={radius:t,detail:e}}function be(t,e){var n=(1+Math.sqrt(5))/2;ve.call(this,[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],t,e),this.type="IcosahedronGeometry",this.parameters={radius:t,detail:e}}function we(t,e){var n=(1+Math.sqrt(5))/2,i=1/n;ve.call(this,[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-i,-n,0,-i,n,0,i,-n,0,i,n,-i,-n,0,-i,n,0,i,-n,0,i,n,0,-n,0,-i,n,0,-i,-n,0,i,n,0,i],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],t,e),this.type="DodecahedronGeometry",this.parameters={radius:t,detail:e}}function _e(t,e,i,r,a,o){pt.call(this),this.type="TubeGeometry",this.parameters={path:t,segments:e,radius:i,radialSegments:r,closed:a,taper:o},e=e||64,i=i||1,r=r||8,a=a||!1,o=o||_e.NoTaper;var s,l,h,u,d,p,f,m,g,v,y=[],x=e+1,b=new c;for(m=new _e.FrenetFrames(t,e,a),g=m.normals,v=m.binormals,this.tangents=m.tangents,this.normals=g,this.binormals=v,m=0;m<x;m++)for(y[m]=[],h=m/(x-1),f=t.getPointAt(h),s=g[m],l=v[m],d=i*o(h),h=0;h<r;h++)u=h/r*2*Math.PI,p=-d*Math.cos(u),u=d*Math.sin(u),b.copy(f),b.x+=p*s.x+u*l.x,b.y+=p*s.y+u*l.y,b.z+=p*s.z+u*l.z,y[m][h]=this.vertices.push(new c(b.x,b.y,b.z))-1;for(m=0;m<e;m++)for(h=0;h<r;h++)o=a?(m+1)%e:m+1,x=(h+1)%r,t=y[m][h],i=y[o][h],o=y[o][x],x=y[m][x],b=new n(m/e,h/r),g=new n((m+1)/e,h/r),v=new n((m+1)/e,(h+1)/r),s=new n(m/e,(h+1)/r),this.faces.push(new st(t,i,x)),this.faceVertexUvs[0].push([b,g,s]),this.faces.push(new st(i,o,x)),this.faceVertexUvs[0].push([g.clone(),v,s.clone()]);
this.computeFaceNormals(),this.computeVertexNormals()}function Me(t,e,i,r,a,o){function s(t,e,n,i,r){var a=Math.sin(t);e=n/e*t,n=Math.cos(e),r.x=i*(2+n)*.5*Math.cos(t),r.y=i*(2+n)*a*.5,r.z=i*Math.sin(e)*.5}mt.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:t,tube:e,tubularSegments:i,radialSegments:r,p:a,q:o},t=t||100,e=e||40,i=Math.floor(i)||64,r=Math.floor(r)||8,a=a||2,o=o||3;var l,h,u=(r+1)*(i+1),d=r*i*6,d=new lt(new(65535<d?Uint32Array:Uint16Array)(d),1),p=new lt(new Float32Array(3*u),3),f=new lt(new Float32Array(3*u),3),u=new lt(new Float32Array(2*u),2),m=0,g=0,v=new c,y=new c,x=new n,b=new c,w=new c,_=new c,M=new c,E=new c;for(l=0;l<=i;++l)for(h=l/i*a*Math.PI*2,s(h,a,o,t,b),s(h+.01,a,o,t,w),M.subVectors(w,b),E.addVectors(w,b),_.crossVectors(M,E),E.crossVectors(_,M),_.normalize(),E.normalize(),h=0;h<=r;++h){var T=h/r*Math.PI*2,S=-e*Math.cos(T),T=e*Math.sin(T);v.x=b.x+(S*E.x+T*_.x),v.y=b.y+(S*E.y+T*_.y),v.z=b.z+(S*E.z+T*_.z),p.setXYZ(m,v.x,v.y,v.z),y.subVectors(v,b).normalize(),f.setXYZ(m,y.x,y.y,y.z),x.x=l/i,x.y=h/r,u.setXY(m,x.x,x.y),m++}for(h=1;h<=i;h++)for(l=1;l<=r;l++)t=(r+1)*h+(l-1),e=(r+1)*h+l,a=(r+1)*(h-1)+l,d.setX(g,(r+1)*(h-1)+(l-1)),g++,d.setX(g,t),g++,d.setX(g,a),g++,d.setX(g,t),g++,d.setX(g,e),g++,d.setX(g,a),g++;this.setIndex(d),this.addAttribute("position",p),this.addAttribute("normal",f),this.addAttribute("uv",u)}function Ee(t,e,n,i,r,a,o){pt.call(this),this.type="TorusKnotGeometry",this.parameters={radius:t,tube:e,tubularSegments:n,radialSegments:i,p:r,q:a},void 0!==o&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new Me(t,e,n,i,r,a)),this.mergeVertices()}function Te(t,e,n,i,r){mt.call(this),this.type="TorusBufferGeometry",this.parameters={radius:t,tube:e,radialSegments:n,tubularSegments:i,arc:r},t=t||100,e=e||40,n=Math.floor(n)||8,i=Math.floor(i)||6,r=r||2*Math.PI;var a,o,s=(n+1)*(i+1),l=n*i*6,l=new(65535<l?Uint32Array:Uint16Array)(l),h=new Float32Array(3*s),u=new Float32Array(3*s),s=new Float32Array(2*s),d=0,p=0,f=0,m=new c,g=new c,v=new c;for(a=0;a<=n;a++)for(o=0;o<=i;o++){var y=o/i*r,x=a/n*Math.PI*2;g.x=(t+e*Math.cos(x))*Math.cos(y),g.y=(t+e*Math.cos(x))*Math.sin(y),g.z=e*Math.sin(x),h[d]=g.x,h[d+1]=g.y,h[d+2]=g.z,m.x=t*Math.cos(y),m.y=t*Math.sin(y),v.subVectors(g,m).normalize(),u[d]=v.x,u[d+1]=v.y,u[d+2]=v.z,s[p]=o/i,s[p+1]=a/n,d+=3,p+=2}for(a=1;a<=n;a++)for(o=1;o<=i;o++)t=(i+1)*(a-1)+o-1,e=(i+1)*(a-1)+o,r=(i+1)*a+o,l[f]=(i+1)*a+o-1,l[f+1]=t,l[f+2]=r,l[f+3]=t,l[f+4]=e,l[f+5]=r,f+=6;this.setIndex(new lt(l,1)),this.addAttribute("position",new lt(h,3)),this.addAttribute("normal",new lt(u,3)),this.addAttribute("uv",new lt(s,2))}function Se(t,e,n,i,r){pt.call(this),this.type="TorusGeometry",this.parameters={radius:t,tube:e,radialSegments:n,tubularSegments:i,arc:r},this.fromBufferGeometry(new Te(t,e,n,i,r))}function Ae(t,e){"undefined"!=typeof t&&(pt.call(this),this.type="ExtrudeGeometry",t=Array.isArray(t)?t:[t],this.addShapeList(t,e),this.computeFaceNormals())}function Re(t,e){e=e||{};var n=e.font;return!1===(n&&n.isFont)?(console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new pt):(n=n.generateShapes(t,e.size,e.curveSegments),e.amount=void 0!==e.height?e.height:50,void 0===e.bevelThickness&&(e.bevelThickness=10),void 0===e.bevelSize&&(e.bevelSize=8),void 0===e.bevelEnabled&&(e.bevelEnabled=!1),Ae.call(this,n,e),void(this.type="TextGeometry"))}function Le(t,e,n,i,r,a,o){mt.call(this),this.type="SphereBufferGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:n,phiStart:i,phiLength:r,thetaStart:a,thetaLength:o},t=t||50,e=Math.max(3,Math.floor(e)||8),n=Math.max(2,Math.floor(n)||6),i=void 0!==i?i:0,r=void 0!==r?r:2*Math.PI,a=void 0!==a?a:0,o=void 0!==o?o:Math.PI;for(var s=a+o,l=(e+1)*(n+1),h=new lt(new Float32Array(3*l),3),u=new lt(new Float32Array(3*l),3),l=new lt(new Float32Array(2*l),2),d=0,p=[],f=new c,m=0;m<=n;m++){for(var g=[],v=m/n,y=0;y<=e;y++){var x=y/e,b=-t*Math.cos(i+x*r)*Math.sin(a+v*o),w=t*Math.cos(a+v*o),_=t*Math.sin(i+x*r)*Math.sin(a+v*o);f.set(b,w,_).normalize(),h.setXYZ(d,b,w,_),u.setXYZ(d,f.x,f.y,f.z),l.setXY(d,x,1-v),g.push(d),d++}p.push(g)}for(i=[],m=0;m<n;m++)for(y=0;y<e;y++)r=p[m][y+1],o=p[m][y],d=p[m+1][y],f=p[m+1][y+1],(0!==m||0<a)&&i.push(r,o,f),(m!==n-1||s<Math.PI)&&i.push(o,d,f);this.setIndex(new(65535<h.count?ut:ht)(i,1)),this.addAttribute("position",h),this.addAttribute("normal",u),this.addAttribute("uv",l),this.boundingSphere=new J(new c,t)}function Ce(t,e,n,i,r,a,o){pt.call(this),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:n,phiStart:i,phiLength:r,thetaStart:a,thetaLength:o},this.fromBufferGeometry(new Le(t,e,n,i,r,a,o))}function Pe(t,e,i,r,a,o){mt.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:i,phiSegments:r,thetaStart:a,thetaLength:o},t=t||20,e=e||50,a=void 0!==a?a:0,o=void 0!==o?o:2*Math.PI,i=void 0!==i?Math.max(3,i):8,r=void 0!==r?Math.max(1,r):1;var s,l,h=(i+1)*(r+1),u=i*r*6,u=new lt(new(65535<u?Uint32Array:Uint16Array)(u),1),d=new lt(new Float32Array(3*h),3),p=new lt(new Float32Array(3*h),3),h=new lt(new Float32Array(2*h),2),f=0,m=0,g=t,v=(e-t)/r,y=new c,x=new n;for(t=0;t<=r;t++){for(l=0;l<=i;l++)s=a+l/i*o,y.x=g*Math.cos(s),y.y=g*Math.sin(s),d.setXYZ(f,y.x,y.y,y.z),p.setXYZ(f,0,0,1),x.x=(y.x/e+1)/2,x.y=(y.y/e+1)/2,h.setXY(f,x.x,x.y),f++;g+=v}for(t=0;t<r;t++)for(e=t*(i+1),l=0;l<i;l++)a=s=l+e,o=s+i+1,f=s+i+2,s+=1,u.setX(m,a),m++,u.setX(m,o),m++,u.setX(m,f),m++,u.setX(m,a),m++,u.setX(m,f),m++,u.setX(m,s),m++;this.setIndex(u),this.addAttribute("position",d),this.addAttribute("normal",p),this.addAttribute("uv",h)}function Ie(t,e,n,i,r,a){pt.call(this),this.type="RingGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:n,phiSegments:i,thetaStart:r,thetaLength:a},this.fromBufferGeometry(new Pe(t,e,n,i,r,a))}function Ue(t,e,n,i){pt.call(this),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:n,heightSegments:i},this.fromBufferGeometry(new yt(t,e,n,i))}function Ne(e,i,r,a){mt.call(this),this.type="LatheBufferGeometry",this.parameters={points:e,segments:i,phiStart:r,phiLength:a},i=Math.floor(i)||12,r=r||0,a=a||2*Math.PI,a=t.Math.clamp(a,0,2*Math.PI);for(var o=(i+1)*e.length,s=i*e.length*6,l=new lt(new(65535<s?Uint32Array:Uint16Array)(s),1),h=new lt(new Float32Array(3*o),3),u=new lt(new Float32Array(2*o),2),d=0,p=0,f=1/i,m=new c,g=new n,o=0;o<=i;o++)for(var s=r+o*f*a,v=Math.sin(s),y=Math.cos(s),s=0;s<=e.length-1;s++)m.x=e[s].x*v,m.y=e[s].y,m.z=e[s].x*y,h.setXYZ(d,m.x,m.y,m.z),g.x=o/i,g.y=s/(e.length-1),u.setXY(d,g.x,g.y),d++;for(o=0;o<i;o++)for(s=0;s<e.length-1;s++)r=s+o*e.length,d=r+e.length,f=r+e.length+1,m=r+1,l.setX(p,r),p++,l.setX(p,d),p++,l.setX(p,m),p++,l.setX(p,d),p++,l.setX(p,f),p++,l.setX(p,m),p++;if(this.setIndex(l),this.addAttribute("position",h),this.addAttribute("uv",u),this.computeVertexNormals(),a===2*Math.PI)for(a=this.attributes.normal.array,l=new c,h=new c,u=new c,r=i*e.length*3,s=o=0;o<e.length;o++,s+=3)l.x=a[s+0],l.y=a[s+1],l.z=a[s+2],h.x=a[r+s+0],h.y=a[r+s+1],h.z=a[r+s+2],u.addVectors(l,h).normalize(),a[s+0]=a[r+s+0]=u.x,a[s+1]=a[r+s+1]=u.y,a[s+2]=a[r+s+2]=u.z}function De(t,e,n,i){pt.call(this),this.type="LatheGeometry",this.parameters={points:t,segments:e,phiStart:n,phiLength:i},this.fromBufferGeometry(new Ne(t,e,n,i)),this.mergeVertices()}function Fe(t,e){pt.call(this),this.type="ShapeGeometry",!1===Array.isArray(t)&&(t=[t]),this.addShapeList(t,e),this.computeFaceNormals()}function Oe(e,n){function i(t,e){return t-e}mt.call(this);var r,a=Math.cos(t.Math.DEG2RAD*(void 0!==n?n:1)),o=[0,0],s={},c=["a","b","c"];e&&e.isBufferGeometry?(r=new pt,r.fromBufferGeometry(e)):r=e.clone(),r.mergeVertices(),r.computeFaceNormals();var l=r.vertices;r=r.faces;for(var h=0,u=r.length;h<u;h++)for(var d=r[h],p=0;3>p;p++){o[0]=d[c[p]],o[1]=d[c[(p+1)%3]],o.sort(i);var f=o.toString();void 0===s[f]?s[f]={vert1:o[0],vert2:o[1],face1:h,face2:void 0}:s[f].face2=h}o=[];for(f in s)c=s[f],(void 0===c.face2||r[c.face1].normal.dot(r[c.face2].normal)<=a)&&(h=l[c.vert1],o.push(h.x),o.push(h.y),o.push(h.z),h=l[c.vert2],o.push(h.x),o.push(h.y),o.push(h.z));this.addAttribute("position",new lt(new Float32Array(o),3))}function Be(t,e,i,r,a,o,s,l){function h(i){var a,o,h,d=new n,p=new c,f=0,w=!0===i?t:e,E=!0===i?1:-1;for(o=x,a=1;a<=r;a++)g.setXYZ(x,0,_*E,0),v.setXYZ(x,0,E,0),d.x=.5,d.y=.5,y.setXY(x,d.x,d.y),x++;for(h=x,a=0;a<=r;a++){var T=a/r*l+s,S=Math.cos(T),T=Math.sin(T);p.x=w*T,p.y=_*E,p.z=w*S,g.setXYZ(x,p.x,p.y,p.z),v.setXYZ(x,0,E,0),d.x=.5*S+.5,d.y=.5*T*E+.5,y.setXY(x,d.x,d.y),x++}for(a=0;a<r;a++)d=o+a,p=h+a,!0===i?(m.setX(b,p),b++,m.setX(b,p+1)):(m.setX(b,p+1),b++,m.setX(b,p)),b++,m.setX(b,d),b++,f+=3;u.addGroup(M,f,!0===i?1:2),M+=f}mt.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:i,radialSegments:r,heightSegments:a,openEnded:o,thetaStart:s,thetaLength:l};var u=this;t=void 0!==t?t:20,e=void 0!==e?e:20,i=void 0!==i?i:100,r=Math.floor(r)||8,a=Math.floor(a)||1,o=void 0!==o&&o,s=void 0!==s?s:0,l=void 0!==l?l:2*Math.PI;var d=0;!1===o&&(0<t&&d++,0<e&&d++);var p=function(){var t=(r+1)*(a+1);return!1===o&&(t+=(r+1)*d+r*d),t}(),f=function(){var t=r*a*6;return!1===o&&(t+=r*d*3),t}(),m=new lt(new(65535<f?Uint32Array:Uint16Array)(f),1),g=new lt(new Float32Array(3*p),3),v=new lt(new Float32Array(3*p),3),y=new lt(new Float32Array(2*p),2),x=0,b=0,w=[],_=i/2,M=0;!function(){var n,o,h=new c,d=new c,p=0,f=(e-t)/i;for(o=0;o<=a;o++){var E=[],T=o/a,S=T*(e-t)+t;for(n=0;n<=r;n++){var A=n/r,R=A*l+s,L=Math.sin(R),R=Math.cos(R);d.x=S*L,d.y=-T*i+_,d.z=S*R,g.setXYZ(x,d.x,d.y,d.z),h.set(L,f,R).normalize(),v.setXYZ(x,h.x,h.y,h.z),y.setXY(x,A,1-T),E.push(x),x++}w.push(E)}for(n=0;n<r;n++)for(o=0;o<a;o++)h=w[o+1][n],d=w[o+1][n+1],f=w[o][n+1],m.setX(b,w[o][n]),b++,m.setX(b,h),b++,m.setX(b,f),b++,m.setX(b,h),b++,m.setX(b,d),b++,m.setX(b,f),b++,p+=6;u.addGroup(M,p,0),M+=p}(),!1===o&&(0<t&&h(!0),0<e&&h(!1)),this.setIndex(m),this.addAttribute("position",g),this.addAttribute("normal",v),this.addAttribute("uv",y)}function ze(t,e,n,i,r,a,o,s){pt.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:n,radialSegments:i,heightSegments:r,openEnded:a,thetaStart:o,thetaLength:s},this.fromBufferGeometry(new Be(t,e,n,i,r,a,o,s)),this.mergeVertices()}function He(t,e,n,i,r,a,o){ze.call(this,0,t,e,n,i,r,a,o),this.type="ConeGeometry",this.parameters={radius:t,height:e,radialSegments:n,heightSegments:i,openEnded:r,thetaStart:a,thetaLength:o}}function Ge(t,e,n,i,r,a,o){Be.call(this,0,t,e,n,i,r,a,o),this.type="ConeBufferGeometry",this.parameters={radius:t,height:e,radialSegments:n,heightSegments:i,thetaStart:a,thetaLength:o}}function ke(t,e,n,i){mt.call(this),this.type="CircleBufferGeometry",this.parameters={radius:t,segments:e,thetaStart:n,thetaLength:i},t=t||50,e=void 0!==e?Math.max(3,e):8,n=void 0!==n?n:0,i=void 0!==i?i:2*Math.PI;var r=e+2,a=new Float32Array(3*r),o=new Float32Array(3*r),r=new Float32Array(2*r);o[2]=1,r[0]=.5,r[1]=.5;for(var s=0,l=3,h=2;s<=e;s++,l+=3,h+=2){var u=n+s/e*i;a[l]=t*Math.cos(u),a[l+1]=t*Math.sin(u),o[l+2]=1,r[h]=(a[l]/t+1)/2,r[h+1]=(a[l+1]/t+1)/2}for(n=[],l=1;l<=e;l++)n.push(l,l+1,0);this.setIndex(new lt(new Uint16Array(n),1)),this.addAttribute("position",new lt(a,3)),this.addAttribute("normal",new lt(o,3)),this.addAttribute("uv",new lt(r,2)),this.boundingSphere=new J(new c,t)}function Ve(t,e,n,i){pt.call(this),this.type="CircleGeometry",this.parameters={radius:t,segments:e,thetaStart:n,thetaLength:i},this.fromBufferGeometry(new ke(t,e,n,i))}function je(t,e,n,i,r,a){pt.call(this),this.type="BoxGeometry",this.parameters={width:t,height:e,depth:n,widthSegments:i,heightSegments:r,depthSegments:a},this.fromBufferGeometry(new vt(t,e,n,i,r,a)),this.mergeVertices()}function We(){q.call(this,{uniforms:t.UniformsUtils.merge([Xi.lights,{opacity:{value:1}}]),vertexShader:Wi.shadow_vert,fragmentShader:Wi.shadow_frag}),this.transparent=this.lights=!0,Object.defineProperties(this,{opacity:{enumerable:!0,get:function(){return this.uniforms.opacity.value},set:function(t){this.uniforms.opacity.value=t}}})}function Xe(t){q.call(this,t),this.type="RawShaderMaterial"}function qe(e){this.uuid=t.Math.generateUUID(),this.type="MultiMaterial",this.materials=e instanceof Array?e:[],this.visible=!0}function Ye(t){X.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new k(16777215),this.metalness=this.roughness=.5,this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new k(0),this.emissiveIntensity=1,this.bumpMap=this.emissiveMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new n(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.envMap=this.alphaMap=this.metalnessMap=this.roughnessMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(t)}function Ze(t){Ye.call(this),this.defines={PHYSICAL:""},this.type="MeshPhysicalMaterial",this.reflectivity=.5,this.clearCoatRoughness=this.clearCoat=0,this.setValues(t)}function Je(t){X.call(this),this.type="MeshPhongMaterial",this.color=new k(16777215),this.specular=new k(1118481),this.shininess=30,this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new k(0),this.emissiveIntensity=1,this.bumpMap=this.emissiveMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new n(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.envMap=this.alphaMap=this.specularMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(t)}function Qe(t){X.call(this,t),this.type="MeshNormalMaterial",this.wireframe=!1,this.wireframeLinewidth=1,this.morphTargets=this.lights=this.fog=!1,this.setValues(t)}function Ke(t){X.call(this),this.type="MeshLambertMaterial",this.color=new k(16777215),this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new k(0),this.emissiveIntensity=1,this.envMap=this.alphaMap=this.specularMap=this.emissiveMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(t)}function $e(t){X.call(this),this.type="LineDashedMaterial",this.color=new k(16777215),this.scale=this.linewidth=1,this.dashSize=3,this.gapSize=1,this.lights=!1,this.setValues(t)}function tn(t,e,n){var i=this,r=!1,a=0,o=0;this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=n,this.itemStart=function(t){o++,!1===r&&void 0!==i.onStart&&i.onStart(t,a,o),r=!0},this.itemEnd=function(t){a++,void 0!==i.onProgress&&i.onProgress(t,a,o),a===o&&(r=!1,void 0!==i.onLoad)&&i.onLoad()},this.itemError=function(t){void 0!==i.onError&&i.onError(t)}}function en(e){this.manager=void 0!==e?e:t.DefaultLoadingManager}function nn(e){this.manager=void 0!==e?e:t.DefaultLoadingManager,this._parser=null}function rn(e){this.manager=void 0!==e?e:t.DefaultLoadingManager,this._parser=null}function an(e){this.manager=void 0!==e?e:t.DefaultLoadingManager}function on(e){this.manager=void 0!==e?e:t.DefaultLoadingManager}function sn(e){this.manager=void 0!==e?e:t.DefaultLoadingManager}function cn(t,e){rt.call(this),this.type="Light",this.color=new k(t),this.intensity=void 0!==e?e:1,this.receiveShadow=void 0}function ln(t,e,n){cn.call(this,t,n),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(rt.DefaultUp),this.updateMatrix(),this.groundColor=new k(e)}function hn(t){this.camera=t,this.bias=0,this.radius=1,this.mapSize=new n(512,512),this.map=null,this.matrix=new l}function un(){hn.call(this,new bt(50,1,.5,500))}function dn(t,e,n,i,r,a){cn.call(this,t,e),this.type="SpotLight",this.position.copy(rt.DefaultUp),this.updateMatrix(),this.target=new rt,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(t){this.intensity=t/Math.PI}}),this.distance=void 0!==n?n:0,this.angle=void 0!==i?i:Math.PI/3,this.penumbra=void 0!==r?r:0,this.decay=void 0!==a?a:1,this.shadow=new un}function pn(t,e,n,i){cn.call(this,t,e),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(t){this.intensity=t/(4*Math.PI)}}),this.distance=void 0!==n?n:0,this.decay=void 0!==i?i:1,this.shadow=new hn(new bt(90,1,.5,500))}function fn(t){hn.call(this,new wt((-5),5,5,(-5),.5,500))}function mn(t,e){cn.call(this,t,e),this.type="DirectionalLight",this.position.copy(rt.DefaultUp),this.updateMatrix(),this.target=new rt,this.shadow=new fn}function gn(t,e){cn.call(this,t,e),this.type="AmbientLight",this.castShadow=void 0}function vn(t,e,n,i){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==i?i:new e.constructor(n),this.sampleValues=e,this.valueSize=n}function yn(t,e,n,i){vn.call(this,t,e,n,i),this._offsetNext=this._weightNext=this._offsetPrev=this._weightPrev=-0}function xn(t,e,n,i){vn.call(this,t,e,n,i)}function bn(t,e,n,i){vn.call(this,t,e,n,i)}function wn(e,n,i,r){if(void 0===e)throw Error("track name is undefined");if(void 0===n||0===n.length)throw Error("no keyframes in track named "+e);this.name=e,this.times=t.AnimationUtils.convertArray(n,this.TimeBufferType),this.values=t.AnimationUtils.convertArray(i,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation),this.validate(),this.optimize()}function _n(t,e,n,i){wn.call(this,t,e,n,i)}function Mn(t,e,n,i){vn.call(this,t,e,n,i)}function En(t,e,n,i){wn.call(this,t,e,n,i)}function Tn(t,e,n,i){wn.call(this,t,e,n,i)}function Sn(t,e,n,i){wn.call(this,t,e,n,i)}function An(t,e,n){wn.call(this,t,e,n)}function Rn(t,e,n,i){wn.call(this,t,e,n,i)}function Ln(t,e,n,i){wn.apply(this,arguments)}function Cn(e,n,i){this.name=e,this.tracks=i,this.duration=void 0!==n?n:-1,this.uuid=t.Math.generateUUID(),0>this.duration&&this.resetDuration(),this.optimize()}function Pn(e){this.manager=void 0!==e?e:t.DefaultLoadingManager,this.textures={}}function In(e){this.manager=void 0!==e?e:t.DefaultLoadingManager}function Un(){this.onLoadStart=function(){},this.onLoadProgress=function(){},this.onLoadComplete=function(){}}function Nn(e){"boolean"==typeof e&&(console.warn("THREE.JSONLoader: showStatus parameter has been removed from constructor."),e=void 0),this.manager=void 0!==e?e:t.DefaultLoadingManager,this.withCredentials=!1}function Dn(e){this.manager=void 0!==e?e:t.DefaultLoadingManager,this.texturePath=""}function Fn(){}function On(t,e){this.v1=t,this.v2=e}function Bn(){this.curves=[],this.autoClose=!1}function zn(t,e,n,i,r,a,o,s){this.aX=t,this.aY=e,this.xRadius=n,this.yRadius=i,this.aStartAngle=r,this.aEndAngle=a,this.aClockwise=o,this.aRotation=s||0}function Hn(t){this.points=void 0===t?[]:t}function Gn(t,e,n,i){this.v0=t,this.v1=e,this.v2=n,this.v3=i}function kn(t,e,n){this.v0=t,this.v1=e,this.v2=n}function Vn(){jn.apply(this,arguments),this.holes=[]}function jn(t){Bn.call(this),this.currentPoint=new n,t&&this.fromPoints(t)}function Wn(){this.subPaths=[],this.currentPath=null}function Xn(t){this.data=t}function qn(e){this.manager=void 0!==e?e:t.DefaultLoadingManager}function Yn(){return void 0===nr&&(nr=new(window.AudioContext||window.webkitAudioContext)),nr}function Zn(e){this.manager=void 0!==e?e:t.DefaultLoadingManager}function Jn(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new bt,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new bt,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1}function Qn(t,e,n){rt.call(this),this.type="CubeCamera";var i=new bt(90,1,t,e);i.up.set(0,-1,0),i.lookAt(new c(1,0,0)),this.add(i);var r=new bt(90,1,t,e);r.up.set(0,-1,0),r.lookAt(new c((-1),0,0)),this.add(r);var a=new bt(90,1,t,e);a.up.set(0,0,1),a.lookAt(new c(0,1,0)),this.add(a);var s=new bt(90,1,t,e);s.up.set(0,0,-1),s.lookAt(new c(0,(-1),0)),this.add(s);var l=new bt(90,1,t,e);l.up.set(0,-1,0),l.lookAt(new c(0,0,1)),this.add(l);var h=new bt(90,1,t,e);h.up.set(0,-1,0),h.lookAt(new c(0,0,(-1))),this.add(h),this.renderTarget=new o(n,n,{format:1022,magFilter:1006,minFilter:1006}),this.updateCubeMap=function(t,e){null===this.parent&&this.updateMatrixWorld();var n=this.renderTarget,o=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,n.activeCubeFace=0,t.render(e,i,n),n.activeCubeFace=1,t.render(e,r,n),n.activeCubeFace=2,t.render(e,a,n),n.activeCubeFace=3,t.render(e,s,n),n.activeCubeFace=4,t.render(e,l,n),n.texture.generateMipmaps=o,n.activeCubeFace=5,t.render(e,h,n),t.setRenderTarget(null)}}function Kn(){rt.call(this),this.type="AudioListener",this.context=Yn(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null}function $n(t){rt.call(this),this.type="Audio",this.context=t.context,this.source=this.context.createBufferSource(),this.source.onended=this.onEnded.bind(this),this.gain=this.context.createGain(),this.gain.connect(t.getInput()),this.autoplay=!1,this.startTime=0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this.filters=[]}function ti(t){$n.call(this,t),this.panner=this.context.createPanner(),this.panner.connect(this.gain)}function ei(t,e){this.analyser=t.context.createAnalyser(),this.analyser.fftSize=void 0!==e?e:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)}function ni(t,e,n){switch(this.binding=t,this.valueSize=n,t=Float64Array,e){case"quaternion":e=this._slerp;break;case"string":case"bool":t=Array,e=this._select;break;default:e=this._lerp}this.buffer=new t(4*n),this._mixBufferRegion=e,this.referenceCount=this.useCount=this.cumulativeWeight=0}function ii(t,e,n){this.path=e,this.parsedPath=n||ii.parseTrackName(e),this.node=ii.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t}function ri(e){this.uuid=t.Math.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var n={};this._indicesByUUID=n;for(var i=0,r=arguments.length;i!==r;++i)n[arguments[i].uuid]=i;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var a=this;this.stats={objects:{get total(){return a._objects.length},get inUse(){return this.total-a.nCachedObjects_}},get bindingsPerObject(){return a._bindings.length}}}function ai(t,e,n){this._mixer=t,this._clip=e,this._localRoot=n||null,t=e.tracks,e=t.length,n=Array(e);for(var i={endingStart:2400,endingEnd:2400},r=0;r!==e;++r){var a=t[r].createInterpolant(null);n[r]=a,a.settings=i}this._interpolantSettings=i,this._interpolants=n,this._propertyBindings=Array(e),this._weightInterpolant=this._timeScaleInterpolant=this._byClipCacheIndex=this._cacheIndex=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this._effectiveWeight=this.weight=this._effectiveTimeScale=this.timeScale=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtEnd=this.zeroSlopeAtStart=!0}function oi(t){this._root=t,this._initMemoryManager(),this.time=this._accuIndex=0,this.timeScale=1}function si(t,e){"string"==typeof t&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),t=e),this.value=t,this.dynamic=!1}function ci(){mt.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0}function li(e,n,i,r){this.uuid=t.Math.generateUUID(),this.data=e,this.itemSize=n,this.offset=i,this.normalized=!0===r}function hi(e,n){this.uuid=t.Math.generateUUID(),this.array=e,this.stride=n,this.count=void 0!==e?e.length/n:0,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0}function ui(t,e,n){hi.call(this,t,e),this.meshPerAttribute=n||1}function di(t,e,n){lt.call(this,t,e),this.meshPerAttribute=n||1}function pi(t,e,n,i){this.ray=new et(t,e),this.near=n||0,this.far=i||1/0,this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function fi(t,e){return t.distance-e.distance}function mi(t,e,n,i){if(!1!==t.visible&&(t.raycast(e,n),!0===i)){t=t.children,i=0;for(var r=t.length;i<r;i++)mi(t[i],e,n,!0)}}function gi(t){this.autoStart=void 0===t||t,this.elapsedTime=this.oldTime=this.startTime=0,this.running=!1}function vi(t,e,n){return this.radius=void 0!==t?t:1,this.phi=void 0!==e?e:0,this.theta=void 0!==n?n:0,this}function yi(t,e){gt.call(this,t,e),this.animationsMap={},this.animationsList=[];var n=this.geometry.morphTargets.length;this.createAnimation("__default",0,n-1,n/1),this.setAnimationWeight("__default",1)}function xi(t){rt.call(this),this.material=t,this.render=function(t){}}function bi(t,e,n,i){this.object=t,this.size=void 0!==e?e:1,t=void 0!==n?n:16711680,i=void 0!==i?i:1,e=0,(n=this.object.geometry)&&n.isGeometry?e=3*n.faces.length:n&&n.isBufferGeometry&&(e=n.attributes.normal.count),n=new mt,e=new dt(6*e,3),n.addAttribute("position",e),se.call(this,n,new ae({color:t,linewidth:i})),this.matrixAutoUpdate=!1,this.update()}function wi(t){rt.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,t=new mt;for(var e=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],n=0,i=1;32>n;n++,i++){var r=n/32*Math.PI*2,a=i/32*Math.PI*2;e.push(Math.cos(r),Math.sin(r),1,Math.cos(a),Math.sin(a),1)}t.addAttribute("position",new dt(e,3)),e=new ae({fog:!1}),this.cone=new se(t,e),this.add(this.cone),this.update()}function _i(t){this.bones=this.getBoneList(t);for(var e=new pt,n=0;n<this.bones.length;n++){var i=this.bones[n];i.parent&&i.parent.isBone&&(e.vertices.push(new c),e.vertices.push(new c),e.colors.push(new k(0,0,1)),e.colors.push(new k(0,1,0)))}e.dynamic=!0,n=new ae({vertexColors:2,depthTest:!1,depthWrite:!1,transparent:!0}),se.call(this,e,n),this.root=t,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.update()}function Mi(t,e){this.light=t,this.light.updateMatrixWorld();var n=new Le(e,4,2),i=new ct({wireframe:!0,fog:!1});i.color.copy(this.light.color).multiplyScalar(this.light.intensity),gt.call(this,n,i),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1}function Ei(t,e){rt.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.colors=[new k,new k];var n=new Ce(e,4,2);n.rotateX(-Math.PI/2);for(var i=0;8>i;i++)n.faces[i].color=this.colors[4>i?0:1];i=new ct({vertexColors:1,wireframe:!0}),this.lightSphere=new gt(n,i),this.add(this.lightSphere),this.update()}function Ti(t,e,n,i){e=e||1,n=new k(void 0!==n?n:4473924),i=new k(void 0!==i?i:8947848);for(var r=e/2,a=2*t/e,o=[],s=[],c=0,l=0,h=-t;c<=e;c++,h+=a){o.push(-t,0,h,t,0,h),o.push(h,0,-t,h,0,t);var u=c===r?n:i;u.toArray(s,l),l+=3,u.toArray(s,l),l+=3,u.toArray(s,l),l+=3,u.toArray(s,l),l+=3}t=new mt,t.addAttribute("position",new dt(o,3)),t.addAttribute("color",new dt(s,3)),o=new ae({vertexColors:2}),se.call(this,t,o)}function Si(t,e,n,i){this.object=t,this.size=void 0!==e?e:1,t=void 0!==n?n:16776960,i=void 0!==i?i:1,e=0,(n=this.object.geometry)&&n.isGeometry?e=n.faces.length:console.warn("THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead."),n=new mt,e=new dt(6*e,3),n.addAttribute("position",e),se.call(this,n,new ae({color:t,linewidth:i})),this.matrixAutoUpdate=!1,this.update()}function Ai(t,e){rt.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,void 0===e&&(e=1);var n=new mt;n.addAttribute("position",new dt([-e,e,0,e,e,0,e,-e,0,-e,-e,0,-e,e,0],3));var i=new ae({fog:!1});this.add(new oe(n,i)),n=new mt,n.addAttribute("position",new dt([0,0,0,0,0,1],3)),this.add(new oe(n,i)),this.update()}function Ri(t){function e(t,e,i){n(t,i),n(e,i)}function n(t,e){i.vertices.push(new c),i.colors.push(new k(e)),void 0===a[t]&&(a[t]=[]),a[t].push(i.vertices.length-1)}var i=new pt,r=new ae({color:16777215,vertexColors:1}),a={};e("n1","n2",16755200),e("n2","n4",16755200),e("n4","n3",16755200),e("n3","n1",16755200),e("f1","f2",16755200),e("f2","f4",16755200),e("f4","f3",16755200),e("f3","f1",16755200),e("n1","f1",16755200),e("n2","f2",16755200),e("n3","f3",16755200),e("n4","f4",16755200),e("p","n1",16711680),e("p","n2",16711680),e("p","n3",16711680),e("p","n4",16711680),e("u1","u2",43775),e("u2","u3",43775),e("u3","u1",43775),e("c","t",16777215),e("p","c",3355443),e("cn1","cn2",3355443),e("cn3","cn4",3355443),e("cf1","cf2",3355443),e("cf3","cf4",3355443),se.call(this,i,r),this.camera=t,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=a,this.update()}function Li(t,e){var n=void 0!==e?e:8947848;this.object=t,this.box=new Z,gt.call(this,new je(1,1,1),new ct({color:n,wireframe:!0}))}function Ci(t,e){void 0===e&&(e=16776960);var n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new Float32Array(24),r=new mt;r.setIndex(new lt(n,1)),r.addAttribute("position",new lt(i,3)),se.call(this,r,new ae({color:e})),void 0!==t&&this.update(t)}function Pi(t,e,n,i,r,a){rt.call(this),void 0===i&&(i=16776960),void 0===n&&(n=1),void 0===r&&(r=.2*n),void 0===a&&(a=.2*r),this.position.copy(e),this.line=new oe(ir,new ae({color:i})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new gt(rr,new ct({color:i})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(t),this.setLength(n,r,a)}function Ii(t){t=t||1;var e=new Float32Array([0,0,0,t,0,0,0,0,0,0,t,0,0,0,0,0,0,t]),n=new Float32Array([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1]);t=new mt,t.addAttribute("position",new lt(e,3)),t.addAttribute("color",new lt(n,3)),e=new ae({vertexColors:2}),se.call(this,t,e)}function Ui(e){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Please use THREE.CatmullRomCurve3."),t.CatmullRomCurve3.call(this,e),this.type="catmullrom",this.closed=!0}function Ni(t,e,n,i,r,a){zn.call(this,t,e,n,n,i,r,a)}void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Math.sign&&(Math.sign=function(t){return 0>t?-1:0<t?1:+t}),void 0===Function.prototype.name&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*(\S*)\s*\(/)[1]}}),void 0===Object.assign&&function(){Object.assign=function(t){if(void 0===t||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),n=1;n<arguments.length;n++){var i=arguments[n];if(void 0!==i&&null!==i)for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}}(),Object.assign(e.prototype,{addEventListener:function(t,e){void 0===this._listeners&&(this._listeners={});var n=this._listeners;void 0===n[t]&&(n[t]=[]),-1===n[t].indexOf(e)&&n[t].push(e)},hasEventListener:function(t,e){if(void 0===this._listeners)return!1;var n=this._listeners;return void 0!==n[t]&&-1!==n[t].indexOf(e)},removeEventListener:function(t,e){if(void 0!==this._listeners){var n=this._listeners[t];if(void 0!==n){var i=n.indexOf(e);-1!==i&&n.splice(i,1)}}},dispatchEvent:function(t){if(void 0!==this._listeners){var e=this._listeners[t.type];if(void 0!==e){t.target=this;var n,i=[],r=e.length;for(n=0;n<r;n++)i[n]=e[n];for(n=0;n<r;n++)i[n].call(this,t)}}}});var Di={NoBlending:0,NormalBlending:1,AdditiveBlending:2,SubtractiveBlending:3,MultiplyBlending:4,CustomBlending:5},Fi={UVMapping:300,CubeReflectionMapping:301,CubeRefractionMapping:302,EquirectangularReflectionMapping:303,EquirectangularRefractionMapping:304,SphericalReflectionMapping:305,CubeUVReflectionMapping:306,CubeUVRefractionMapping:307
},Oi={RepeatWrapping:1e3,ClampToEdgeWrapping:1001,MirroredRepeatWrapping:1002},Bi={NearestFilter:1003,NearestMipMapNearestFilter:1004,NearestMipMapLinearFilter:1005,LinearFilter:1006,LinearMipMapNearestFilter:1007,LinearMipMapLinearFilter:1008};t.Math={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var t,e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),n=Array(36),i=0;return function(){for(var r=0;36>r;r++)8===r||13===r||18===r||23===r?n[r]="-":14===r?n[r]="4":(2>=i&&(i=33554432+16777216*Math.random()|0),t=15&i,i>>=4,n[r]=e[19===r?3&t|8:t]);return n.join("")}}(),clamp:function(t,e,n){return Math.max(e,Math.min(n,t))},euclideanModulo:function(t,e){return(t%e+e)%e},mapLinear:function(t,e,n,i,r){return i+(t-e)*(r-i)/(n-e)},smoothstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e),t*t*(3-2*t))},smootherstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e),t*t*t*(t*(6*t-15)+10))},random16:function(){return console.warn("THREE.Math.random16() has been deprecated. Use Math.random() instead."),Math.random()},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},degToRad:function(e){return e*t.Math.DEG2RAD},radToDeg:function(e){return e*t.Math.RAD2DEG},isPowerOfTwo:function(t){return 0===(t&t-1)&&0!==t},nearestPowerOfTwo:function(t){return Math.pow(2,Math.round(Math.log(t)/Math.LN2))},nextPowerOfTwo:function(t){return t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,t++,t}},n.prototype={constructor:n,isVector2:!0,get width(){return this.x},set width(t){this.x=t},get height(){return this.y},set height(t){this.y=t},set:function(t,e){return this.x=t,this.y=e,this},setScalar:function(t){return this.y=this.x=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw Error("index is out of range: "+t)}},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(t){return this.x=t.x,this.y=t.y,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this)},addScalar:function(t){return this.x+=t,this.y+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this)},subScalar:function(t){return this.x-=t,this.y-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this},multiplyScalar:function(t){return isFinite(t)?(this.x*=t,this.y*=t):this.y=this.x=0,this},divide:function(t){return this.x/=t.x,this.y/=t.y,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this},clampScalar:function(){var t,e;return function(i,r){return void 0===t&&(t=new n,e=new n),t.set(i,i),e.set(r,r),this.clamp(t,e)}}(),clampLength:function(t,e){var n=this.length();return this.multiplyScalar(Math.max(t,Math.min(e,n))/n)},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(t){return this.x*t.x+this.y*t.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length())},angle:function(){var t=Math.atan2(this.y,this.x);return 0>t&&(t+=2*Math.PI),t},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x;return t=this.y-t.y,e*e+t*t},distanceToManhattan:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)},setLength:function(t){return this.multiplyScalar(t/this.length())},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t},fromAttribute:function(t,e,n){return void 0===n&&(n=0),e=e*t.itemSize+n,this.x=t.array[e],this.y=t.array[e+1],this},rotateAround:function(t,e){var n=Math.cos(e),i=Math.sin(e),r=this.x-t.x,a=this.y-t.y;return this.x=r*n-a*i+t.x,this.y=r*i+a*n+t.y,this}},i.DEFAULT_IMAGE=void 0,i.DEFAULT_MAPPING=300,i.prototype={constructor:i,isTexture:!0,set needsUpdate(t){!0===t&&this.version++},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this},toJSON:function(e){if(void 0!==e.textures[this.uuid])return e.textures[this.uuid];var n={metadata:{version:4.4,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],wrap:[this.wrapS,this.wrapT],minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY};if(void 0!==this.image){var i=this.image;if(void 0===i.uuid&&(i.uuid=t.Math.generateUUID()),void 0===e.images[i.uuid]){var r,a=e.images,o=i.uuid,s=i.uuid;void 0!==i.toDataURL?r=i:(r=document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),r.width=i.width,r.height=i.height,r.getContext("2d").drawImage(i,0,0,i.width,i.height)),r=2048<r.width||2048<r.height?r.toDataURL("image/jpeg",.6):r.toDataURL("image/png"),a[o]={uuid:s,url:r}}n.image=i.uuid}return e.textures[this.uuid]=n},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(t){if(300===this.mapping){if(t.multiply(this.repeat),t.add(this.offset),0>t.x||1<t.x)switch(this.wrapS){case 1e3:t.x-=Math.floor(t.x);break;case 1001:t.x=0>t.x?0:1;break;case 1002:t.x=1===Math.abs(Math.floor(t.x)%2)?Math.ceil(t.x)-t.x:t.x-Math.floor(t.x)}if(0>t.y||1<t.y)switch(this.wrapT){case 1e3:t.y-=Math.floor(t.y);break;case 1001:t.y=0>t.y?0:1;break;case 1002:t.y=1===Math.abs(Math.floor(t.y)%2)?Math.ceil(t.y)-t.y:t.y-Math.floor(t.y)}this.flipY&&(t.y=1-t.y)}}},Object.assign(i.prototype,e.prototype);var zi=0;r.prototype={constructor:r,isVector4:!0,set:function(t,e,n,i){return this.x=t,this.y=e,this.z=n,this.w=i,this},setScalar:function(t){return this.w=this.z=this.y=this.x=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setW:function(t){return this.w=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw Error("index is out of range: "+t)}},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this},multiplyScalar:function(t){return isFinite(t)?(this.x*=t,this.y*=t,this.z*=t,this.w*=t):this.w=this.z=this.y=this.x=0,this},applyMatrix4:function(t){var e=this.x,n=this.y,i=this.z,r=this.w;return t=t.elements,this.x=t[0]*e+t[4]*n+t[8]*i+t[12]*r,this.y=t[1]*e+t[5]*n+t[9]*i+t[13]*r,this.z=t[2]*e+t[6]*n+t[10]*i+t[14]*r,this.w=t[3]*e+t[7]*n+t[11]*i+t[15]*r,this},divideScalar:function(t){return this.multiplyScalar(1/t)},setAxisAngleFromQuaternion:function(t){this.w=2*Math.acos(t.w);var e=Math.sqrt(1-t.w*t.w);return 1e-4>e?(this.x=1,this.z=this.y=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this},setAxisAngleFromRotationMatrix:function(t){var e,n,i;t=t.elements;var r=t[0];i=t[4];var a=t[8],o=t[1],s=t[5],c=t[9];n=t[2],e=t[6];var l=t[10];return.01>Math.abs(i-o)&&.01>Math.abs(a-n)&&.01>Math.abs(c-e)?.1>Math.abs(i+o)&&.1>Math.abs(a+n)&&.1>Math.abs(c+e)&&.1>Math.abs(r+s+l-3)?(this.set(1,0,0,0),this):(t=Math.PI,r=(r+1)/2,s=(s+1)/2,l=(l+1)/2,i=(i+o)/4,a=(a+n)/4,c=(c+e)/4,r>s&&r>l?.01>r?(e=0,i=n=.707106781):(e=Math.sqrt(r),n=i/e,i=a/e):s>l?.01>s?(e=.707106781,n=0,i=.707106781):(n=Math.sqrt(s),e=i/n,i=c/n):.01>l?(n=e=.707106781,i=0):(i=Math.sqrt(l),e=a/i,n=c/i),this.set(e,n,i,t),this):(t=Math.sqrt((e-c)*(e-c)+(a-n)*(a-n)+(o-i)*(o-i)),.001>Math.abs(t)&&(t=1),this.x=(e-c)/t,this.y=(a-n)/t,this.z=(o-i)/t,this.w=Math.acos((r+s+l-1)/2),this)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this},clampScalar:function(){var t,e;return function(n,i){return void 0===t&&(t=new r,e=new r),t.set(n,n,n,n),e.set(i,i,i,i),this.clamp(t,e)}}(),floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z),this.w=0>this.w?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length())},setLength:function(t){return this.multiplyScalar(t/this.length())},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t},fromAttribute:function(t,e,n){return void 0===n&&(n=0),e=e*t.itemSize+n,this.x=t.array[e],this.y=t.array[e+1],this.z=t.array[e+2],this.w=t.array[e+3],this}},Object.assign(a.prototype,e.prototype,{isWebGLRenderTarget:!0,setSize:function(t,e){this.width===t&&this.height===e||(this.width=t,this.height=e,this.dispose()),this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.width=t.width,this.height=t.height,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.depthTexture=t.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),o.prototype=Object.create(a.prototype),o.prototype.constructor=o,o.prototype.isWebGLRenderTargetCube=!0,s.prototype={constructor:s,get x(){return this._x},set x(t){this._x=t,this.onChangeCallback()},get y(){return this._y},set y(t){this._y=t,this.onChangeCallback()},get z(){return this._z},set z(t){this._z=t,this.onChangeCallback()},get w(){return this._w},set w(t){this._w=t,this.onChangeCallback()},set:function(t,e,n,i){return this._x=t,this._y=e,this._z=n,this._w=i,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this.onChangeCallback(),this},setFromEuler:function(t,e){if(!1===(t&&t.isEuler))throw Error("THREE.Quaternion: .setFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var n=Math.cos(t._x/2),i=Math.cos(t._y/2),r=Math.cos(t._z/2),a=Math.sin(t._x/2),o=Math.sin(t._y/2),s=Math.sin(t._z/2),c=t.order;return"XYZ"===c?(this._x=a*i*r+n*o*s,this._y=n*o*r-a*i*s,this._z=n*i*s+a*o*r,this._w=n*i*r-a*o*s):"YXZ"===c?(this._x=a*i*r+n*o*s,this._y=n*o*r-a*i*s,this._z=n*i*s-a*o*r,this._w=n*i*r+a*o*s):"ZXY"===c?(this._x=a*i*r-n*o*s,this._y=n*o*r+a*i*s,this._z=n*i*s+a*o*r,this._w=n*i*r-a*o*s):"ZYX"===c?(this._x=a*i*r-n*o*s,this._y=n*o*r+a*i*s,this._z=n*i*s-a*o*r,this._w=n*i*r+a*o*s):"YZX"===c?(this._x=a*i*r+n*o*s,this._y=n*o*r+a*i*s,this._z=n*i*s-a*o*r,this._w=n*i*r-a*o*s):"XZY"===c&&(this._x=a*i*r-n*o*s,this._y=n*o*r-a*i*s,this._z=n*i*s+a*o*r,this._w=n*i*r+a*o*s),!1!==e&&this.onChangeCallback(),this},setFromAxisAngle:function(t,e){var n=e/2,i=Math.sin(n);return this._x=t.x*i,this._y=t.y*i,this._z=t.z*i,this._w=Math.cos(n),this.onChangeCallback(),this},setFromRotationMatrix:function(t){var e=t.elements,n=e[0];t=e[4];var i=e[8],r=e[1],a=e[5],o=e[9],s=e[2],c=e[6],e=e[10],l=n+a+e;return 0<l?(n=.5/Math.sqrt(l+1),this._w=.25/n,this._x=(c-o)*n,this._y=(i-s)*n,this._z=(r-t)*n):n>a&&n>e?(n=2*Math.sqrt(1+n-a-e),this._w=(c-o)/n,this._x=.25*n,this._y=(t+r)/n,this._z=(i+s)/n):a>e?(n=2*Math.sqrt(1+a-n-e),this._w=(i-s)/n,this._x=(t+r)/n,this._y=.25*n,this._z=(o+c)/n):(n=2*Math.sqrt(1+e-n-a),this._w=(r-t)/n,this._x=(i+s)/n,this._y=(o+c)/n,this._z=.25*n),this.onChangeCallback(),this},setFromUnitVectors:function(){var t,e;return function(n,i){return void 0===t&&(t=new c),e=n.dot(i)+1,1e-6>e?(e=0,Math.abs(n.x)>Math.abs(n.z)?t.set(-n.y,n.x,0):t.set(0,-n.z,n.y)):t.crossVectors(n,i),this._x=t.x,this._y=t.y,this._z=t.z,this._w=e,this.normalize()}}(),inverse:function(){return this.conjugate().normalize()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},dot:function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var t=this.length();return 0===t?(this._z=this._y=this._x=0,this._w=1):(t=1/t,this._x*=t,this._y*=t,this._z*=t,this._w*=t),this.onChangeCallback(),this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t)},premultiply:function(t){return this.multiplyQuaternions(t,this)},multiplyQuaternions:function(t,e){var n=t._x,i=t._y,r=t._z,a=t._w,o=e._x,s=e._y,c=e._z,l=e._w;return this._x=n*l+a*o+i*c-r*s,this._y=i*l+a*s+r*o-n*c,this._z=r*l+a*c+n*s-i*o,this._w=a*l-n*o-i*s-r*c,this.onChangeCallback(),this},slerp:function(t,e){if(0===e)return this;if(1===e)return this.copy(t);var n=this._x,i=this._y,r=this._z,a=this._w,o=a*t._w+n*t._x+i*t._y+r*t._z;if(0>o?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,o=-o):this.copy(t),1<=o)return this._w=a,this._x=n,this._y=i,this._z=r,this;var s=Math.sqrt(1-o*o);if(.001>Math.abs(s))return this._w=.5*(a+this._w),this._x=.5*(n+this._x),this._y=.5*(i+this._y),this._z=.5*(r+this._z),this;var c=Math.atan2(s,o),o=Math.sin((1-e)*c)/s,s=Math.sin(e*c)/s;return this._w=a*o+this._w*s,this._x=n*o+this._x*s,this._y=i*o+this._y*s,this._z=r*o+this._z*s,this.onChangeCallback(),this},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},fromArray:function(t,e){return void 0===e&&(e=0),this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this.onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t},onChange:function(t){return this.onChangeCallback=t,this},onChangeCallback:function(){}},Object.assign(s,{slerp:function(t,e,n,i){return n.copy(t).slerp(e,i)},slerpFlat:function(t,e,n,i,r,a,o){var s=n[i+0],c=n[i+1],l=n[i+2];n=n[i+3],i=r[a+0];var h=r[a+1],u=r[a+2];if(r=r[a+3],n!==r||s!==i||c!==h||l!==u){a=1-o;var d=s*i+c*h+l*u+n*r,p=0<=d?1:-1,f=1-d*d;f>Number.EPSILON&&(f=Math.sqrt(f),d=Math.atan2(f,d*p),a=Math.sin(a*d)/f,o=Math.sin(o*d)/f),p*=o,s=s*a+i*p,c=c*a+h*p,l=l*a+u*p,n=n*a+r*p,a===1-o&&(o=1/Math.sqrt(s*s+c*c+l*l+n*n),s*=o,c*=o,l*=o,n*=o)}t[e]=s,t[e+1]=c,t[e+2]=l,t[e+3]=n}}),c.prototype={constructor:c,isVector3:!0,set:function(t,e,n){return this.x=t,this.y=e,this.z=n,this},setScalar:function(t){return this.z=this.y=this.x=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw Error("index is out of range: "+t)}},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,e)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},multiplyScalar:function(t){return isFinite(t)?(this.x*=t,this.y*=t,this.z*=t):this.z=this.y=this.x=0,this},multiplyVectors:function(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this},applyEuler:function(){var t;return function(e){return!1===(e&&e.isEuler)&&console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),void 0===t&&(t=new s),this.applyQuaternion(t.setFromEuler(e))}}(),applyAxisAngle:function(){var t;return function(e,n){return void 0===t&&(t=new s),this.applyQuaternion(t.setFromAxisAngle(e,n))}}(),applyMatrix3:function(t){var e=this.x,n=this.y,i=this.z;return t=t.elements,this.x=t[0]*e+t[3]*n+t[6]*i,this.y=t[1]*e+t[4]*n+t[7]*i,this.z=t[2]*e+t[5]*n+t[8]*i,this},applyMatrix4:function(t){var e=this.x,n=this.y,i=this.z;return t=t.elements,this.x=t[0]*e+t[4]*n+t[8]*i+t[12],this.y=t[1]*e+t[5]*n+t[9]*i+t[13],this.z=t[2]*e+t[6]*n+t[10]*i+t[14],this},applyProjection:function(t){var e=this.x,n=this.y,i=this.z;t=t.elements;var r=1/(t[3]*e+t[7]*n+t[11]*i+t[15]);return this.x=(t[0]*e+t[4]*n+t[8]*i+t[12])*r,this.y=(t[1]*e+t[5]*n+t[9]*i+t[13])*r,this.z=(t[2]*e+t[6]*n+t[10]*i+t[14])*r,this},applyQuaternion:function(t){var e=this.x,n=this.y,i=this.z,r=t.x,a=t.y,o=t.z;t=t.w;var s=t*e+a*i-o*n,c=t*n+o*e-r*i,l=t*i+r*n-a*e,e=-r*e-a*n-o*i;return this.x=s*t+e*-r+c*-o-l*-a,this.y=c*t+e*-a+l*-r-s*-o,this.z=l*t+e*-o+s*-a-c*-r,this},project:function(){var t;return function(e){return void 0===t&&(t=new l),t.multiplyMatrices(e.projectionMatrix,t.getInverse(e.matrixWorld)),this.applyProjection(t)}}(),unproject:function(){var t;return function(e){return void 0===t&&(t=new l),t.multiplyMatrices(e.matrixWorld,t.getInverse(e.projectionMatrix)),this.applyProjection(t)}}(),transformDirection:function(t){var e=this.x,n=this.y,i=this.z;return t=t.elements,this.x=t[0]*e+t[4]*n+t[8]*i,this.y=t[1]*e+t[5]*n+t[9]*i,this.z=t[2]*e+t[6]*n+t[10]*i,this.normalize()},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this},clampScalar:function(){var t,e;return function(n,i){return void 0===t&&(t=new c,e=new c),t.set(n,n,n),e.set(i,i,i),this.clamp(t,e)}}(),clampLength:function(t,e){var n=this.length();return this.multiplyScalar(Math.max(t,Math.min(e,n))/n)},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},setLength:function(t){return this.multiplyScalar(t/this.length())},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},cross:function(t,e){if(void 0!==e)return console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,e);var n=this.x,i=this.y,r=this.z;return this.x=i*t.z-r*t.y,this.y=r*t.x-n*t.z,this.z=n*t.y-i*t.x,this},crossVectors:function(t,e){var n=t.x,i=t.y,r=t.z,a=e.x,o=e.y,s=e.z;return this.x=i*s-r*o,this.y=r*a-n*s,this.z=n*o-i*a,this},projectOnVector:function(t){var e=t.dot(this)/t.lengthSq();return this.copy(t).multiplyScalar(e)},projectOnPlane:function(){var t;return function(e){return void 0===t&&(t=new c),t.copy(this).projectOnVector(e),this.sub(t)}}(),reflect:function(){var t;return function(e){return void 0===t&&(t=new c),this.sub(t.copy(e).multiplyScalar(2*this.dot(e)))}}(),angleTo:function(e){return e=this.dot(e)/Math.sqrt(this.lengthSq()*e.lengthSq()),Math.acos(t.Math.clamp(e,-1,1))},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,n=this.y-t.y;return t=this.z-t.z,e*e+n*n+t*t},distanceToManhattan:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)},setFromSpherical:function(t){var e=Math.sin(t.phi)*t.radius;return this.x=e*Math.sin(t.theta),this.y=Math.cos(t.phi)*t.radius,this.z=e*Math.cos(t.theta),this},setFromMatrixPosition:function(t){return this.setFromMatrixColumn(t,3)},setFromMatrixScale:function(t){var e=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length();return t=this.setFromMatrixColumn(t,2).length(),this.x=e,this.y=n,this.z=t,this},setFromMatrixColumn:function(t,e){if("number"==typeof t){console.warn("THREE.Vector3: setFromMatrixColumn now expects ( matrix, index ).");var n=t;t=e,e=n}return this.fromArray(t.elements,4*e)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t},fromAttribute:function(t,e,n){return void 0===n&&(n=0),e=e*t.itemSize+n,this.x=t.array[e],this.y=t.array[e+1],this.z=t.array[e+2],this}},l.prototype={constructor:l,isMatrix4:!0,set:function(t,e,n,i,r,a,o,s,c,l,h,u,d,p,f,m){var g=this.elements;return g[0]=t,g[4]=e,g[8]=n,g[12]=i,g[1]=r,g[5]=a,g[9]=o,g[13]=s,g[2]=c,g[6]=l,g[10]=h,g[14]=u,g[3]=d,g[7]=p,g[11]=f,g[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new l).fromArray(this.elements)},copy:function(t){return this.elements.set(t.elements),this},copyPosition:function(t){var e=this.elements;return t=t.elements,e[12]=t[12],e[13]=t[13],e[14]=t[14],this},extractBasis:function(t,e,n){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this},makeBasis:function(t,e,n){return this.set(t.x,e.x,n.x,0,t.y,e.y,n.y,0,t.z,e.z,n.z,0,0,0,0,1),this},extractRotation:function(){var t;return function(e){void 0===t&&(t=new c);var n=this.elements,i=e.elements,r=1/t.setFromMatrixColumn(e,0).length(),a=1/t.setFromMatrixColumn(e,1).length();return e=1/t.setFromMatrixColumn(e,2).length(),n[0]=i[0]*r,n[1]=i[1]*r,n[2]=i[2]*r,n[4]=i[4]*a,n[5]=i[5]*a,n[6]=i[6]*a,n[8]=i[8]*e,n[9]=i[9]*e,n[10]=i[10]*e,this}}(),makeRotationFromEuler:function(t){!1===(t&&t.isEuler)&&console.error("THREE.Matrix: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var e=this.elements,n=t.x,i=t.y,r=t.z,a=Math.cos(n),n=Math.sin(n),o=Math.cos(i),i=Math.sin(i),s=Math.cos(r),r=Math.sin(r);if("XYZ"===t.order){t=a*s;var c=a*r,l=n*s,h=n*r;e[0]=o*s,e[4]=-o*r,e[8]=i,e[1]=c+l*i,e[5]=t-h*i,e[9]=-n*o,e[2]=h-t*i,e[6]=l+c*i,e[10]=a*o}else"YXZ"===t.order?(t=o*s,c=o*r,l=i*s,h=i*r,e[0]=t+h*n,e[4]=l*n-c,e[8]=a*i,e[1]=a*r,e[5]=a*s,e[9]=-n,e[2]=c*n-l,e[6]=h+t*n,e[10]=a*o):"ZXY"===t.order?(t=o*s,c=o*r,l=i*s,h=i*r,e[0]=t-h*n,e[4]=-a*r,e[8]=l+c*n,e[1]=c+l*n,e[5]=a*s,e[9]=h-t*n,e[2]=-a*i,e[6]=n,e[10]=a*o):"ZYX"===t.order?(t=a*s,c=a*r,l=n*s,h=n*r,e[0]=o*s,e[4]=l*i-c,e[8]=t*i+h,e[1]=o*r,e[5]=h*i+t,e[9]=c*i-l,e[2]=-i,e[6]=n*o,e[10]=a*o):"YZX"===t.order?(t=a*o,c=a*i,l=n*o,h=n*i,e[0]=o*s,e[4]=h-t*r,e[8]=l*r+c,e[1]=r,e[5]=a*s,e[9]=-n*s,e[2]=-i*s,e[6]=c*r+l,e[10]=t-h*r):"XZY"===t.order&&(t=a*o,c=a*i,l=n*o,h=n*i,e[0]=o*s,e[4]=-r,e[8]=i*s,e[1]=t*r+h,e[5]=a*s,e[9]=c*r-l,e[2]=l*r-c,e[6]=n*s,e[10]=h*r+t);return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},makeRotationFromQuaternion:function(t){var e=this.elements,n=t.x,i=t.y,r=t.z,a=t.w,o=n+n,s=i+i,c=r+r;t=n*o;var l=n*s,n=n*c,h=i*s,i=i*c,r=r*c,o=a*o,s=a*s,a=a*c;return e[0]=1-(h+r),e[4]=l-a,e[8]=n+s,e[1]=l+a,e[5]=1-(t+r),e[9]=i-o,e[2]=n-s,e[6]=i+o,e[10]=1-(t+h),e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},lookAt:function(){var t,e,n;return function(i,r,a){void 0===t&&(t=new c,e=new c,n=new c);var o=this.elements;return n.subVectors(i,r).normalize(),0===n.lengthSq()&&(n.z=1),t.crossVectors(a,n).normalize(),0===t.lengthSq()&&(n.z+=1e-4,t.crossVectors(a,n).normalize()),e.crossVectors(n,t),o[0]=t.x,o[4]=e.x,o[8]=n.x,o[1]=t.y,o[5]=e.y,o[9]=n.y,o[2]=t.z,o[6]=e.z,o[10]=n.z,this}}(),multiply:function(t,e){return void 0!==e?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,e)):this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var n=t.elements,i=e.elements,r=this.elements,a=n[0],o=n[4],s=n[8],c=n[12],l=n[1],h=n[5],u=n[9],d=n[13],p=n[2],f=n[6],m=n[10],g=n[14],v=n[3],y=n[7],x=n[11],n=n[15],b=i[0],w=i[4],_=i[8],M=i[12],E=i[1],T=i[5],S=i[9],A=i[13],R=i[2],L=i[6],C=i[10],P=i[14],I=i[3],U=i[7],N=i[11],i=i[15];return r[0]=a*b+o*E+s*R+c*I,r[4]=a*w+o*T+s*L+c*U,r[8]=a*_+o*S+s*C+c*N,r[12]=a*M+o*A+s*P+c*i,r[1]=l*b+h*E+u*R+d*I,r[5]=l*w+h*T+u*L+d*U,r[9]=l*_+h*S+u*C+d*N,r[13]=l*M+h*A+u*P+d*i,r[2]=p*b+f*E+m*R+g*I,r[6]=p*w+f*T+m*L+g*U,r[10]=p*_+f*S+m*C+g*N,r[14]=p*M+f*A+m*P+g*i,r[3]=v*b+y*E+x*R+n*I,r[7]=v*w+y*T+x*L+n*U,r[11]=v*_+y*S+x*C+n*N,r[15]=v*M+y*A+x*P+n*i,this},multiplyToArray:function(t,e,n){var i=this.elements;return this.multiplyMatrices(t,e),n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=i[3],n[4]=i[4],n[5]=i[5],n[6]=i[6],n[7]=i[7],n[8]=i[8],n[9]=i[9],n[10]=i[10],n[11]=i[11],n[12]=i[12],n[13]=i[13],n[14]=i[14],n[15]=i[15],this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this},applyToVector3Array:function(){var t;return function(e,n,i){void 0===t&&(t=new c),void 0===n&&(n=0),void 0===i&&(i=e.length);for(var r=0;r<i;r+=3,n+=3)t.fromArray(e,n),t.applyMatrix4(this),t.toArray(e,n);return e}}(),applyToBuffer:function(){var t;return function(e,n,i){void 0===t&&(t=new c),void 0===n&&(n=0),void 0===i&&(i=e.length/e.itemSize);for(var r=0;r<i;r++,n++)t.x=e.getX(n),t.y=e.getY(n),t.z=e.getZ(n),t.applyMatrix4(this),e.setXYZ(t.x,t.y,t.z);return e}}(),determinant:function(){var t=this.elements,e=t[0],n=t[4],i=t[8],r=t[12],a=t[1],o=t[5],s=t[9],c=t[13],l=t[2],h=t[6],u=t[10],d=t[14];return t[3]*(+r*s*h-i*c*h-r*o*u+n*c*u+i*o*d-n*s*d)+t[7]*(+e*s*d-e*c*u+r*a*u-i*a*d+i*c*l-r*s*l)+t[11]*(+e*c*h-e*o*d-r*a*h+n*a*d+r*o*l-n*c*l)+t[15]*(-i*o*l-e*s*h+e*o*u+i*a*h-n*a*u+n*s*l)},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],
e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this},flattenToArrayOffset:function(t,e){return console.warn("THREE.Matrix3: .flattenToArrayOffset is deprecated - just use .toArray instead."),this.toArray(t,e)},getPosition:function(){var t;return function(){return void 0===t&&(t=new c),console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),t.setFromMatrixColumn(this,3)}}(),setPosition:function(t){var e=this.elements;return e[12]=t.x,e[13]=t.y,e[14]=t.z,this},getInverse:function(t,e){var n=this.elements,i=t.elements,r=i[0],a=i[1],o=i[2],s=i[3],c=i[4],l=i[5],h=i[6],u=i[7],d=i[8],p=i[9],f=i[10],m=i[11],g=i[12],v=i[13],y=i[14],i=i[15],x=p*y*u-v*f*u+v*h*m-l*y*m-p*h*i+l*f*i,b=g*f*u-d*y*u-g*h*m+c*y*m+d*h*i-c*f*i,w=d*v*u-g*p*u+g*l*m-c*v*m-d*l*i+c*p*i,_=g*p*h-d*v*h-g*l*f+c*v*f+d*l*y-c*p*y,M=r*x+a*b+o*w+s*_;if(0===M){if(!0===e)throw Error("THREE.Matrix4.getInverse(): can't invert matrix, determinant is 0");return console.warn("THREE.Matrix4.getInverse(): can't invert matrix, determinant is 0"),this.identity()}return M=1/M,n[0]=x*M,n[1]=(v*f*s-p*y*s-v*o*m+a*y*m+p*o*i-a*f*i)*M,n[2]=(l*y*s-v*h*s+v*o*u-a*y*u-l*o*i+a*h*i)*M,n[3]=(p*h*s-l*f*s-p*o*u+a*f*u+l*o*m-a*h*m)*M,n[4]=b*M,n[5]=(d*y*s-g*f*s+g*o*m-r*y*m-d*o*i+r*f*i)*M,n[6]=(g*h*s-c*y*s-g*o*u+r*y*u+c*o*i-r*h*i)*M,n[7]=(c*f*s-d*h*s+d*o*u-r*f*u-c*o*m+r*h*m)*M,n[8]=w*M,n[9]=(g*p*s-d*v*s-g*a*m+r*v*m+d*a*i-r*p*i)*M,n[10]=(c*v*s-g*l*s+g*a*u-r*v*u-c*a*i+r*l*i)*M,n[11]=(d*l*s-c*p*s-d*a*u+r*p*u+c*a*m-r*l*m)*M,n[12]=_*M,n[13]=(d*v*o-g*p*o+g*a*f-r*v*f-d*a*y+r*p*y)*M,n[14]=(g*l*o-c*v*o-g*a*h+r*v*h+c*a*y-r*l*y)*M,n[15]=(c*p*o-d*l*o+d*a*h-r*p*h-c*a*f+r*l*f)*M,this},scale:function(t){var e=this.elements,n=t.x,i=t.y;return t=t.z,e[0]*=n,e[4]*=i,e[8]*=t,e[1]*=n,e[5]*=i,e[9]*=t,e[2]*=n,e[6]*=i,e[10]*=t,e[3]*=n,e[7]*=i,e[11]*=t,this},getMaxScaleOnAxis:function(){var t=this.elements;return Math.sqrt(Math.max(t[0]*t[0]+t[1]*t[1]+t[2]*t[2],t[4]*t[4]+t[5]*t[5]+t[6]*t[6],t[8]*t[8]+t[9]*t[9]+t[10]*t[10]))},makeTranslation:function(t,e,n){return this.set(1,0,0,t,0,1,0,e,0,0,1,n,0,0,0,1),this},makeRotationX:function(t){var e=Math.cos(t);return t=Math.sin(t),this.set(1,0,0,0,0,e,-t,0,0,t,e,0,0,0,0,1),this},makeRotationY:function(t){var e=Math.cos(t);return t=Math.sin(t),this.set(e,0,t,0,0,1,0,0,-t,0,e,0,0,0,0,1),this},makeRotationZ:function(t){var e=Math.cos(t);return t=Math.sin(t),this.set(e,-t,0,0,t,e,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,e){var n=Math.cos(e),i=Math.sin(e),r=1-n,a=t.x,o=t.y,s=t.z,c=r*a,l=r*o;return this.set(c*a+n,c*o-i*s,c*s+i*o,0,c*o+i*s,l*o+n,l*s-i*a,0,c*s-i*o,l*s+i*a,r*s*s+n,0,0,0,0,1),this},makeScale:function(t,e,n){return this.set(t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1),this},compose:function(t,e,n){return this.makeRotationFromQuaternion(e),this.scale(n),this.setPosition(t),this},decompose:function(){var t,e;return function(n,i,r){void 0===t&&(t=new c,e=new l);var a=this.elements,o=t.set(a[0],a[1],a[2]).length(),s=t.set(a[4],a[5],a[6]).length(),h=t.set(a[8],a[9],a[10]).length();0>this.determinant()&&(o=-o),n.x=a[12],n.y=a[13],n.z=a[14],e.elements.set(this.elements),n=1/o;var a=1/s,u=1/h;return e.elements[0]*=n,e.elements[1]*=n,e.elements[2]*=n,e.elements[4]*=a,e.elements[5]*=a,e.elements[6]*=a,e.elements[8]*=u,e.elements[9]*=u,e.elements[10]*=u,i.setFromRotationMatrix(e),r.x=o,r.y=s,r.z=h,this}}(),makeFrustum:function(t,e,n,i,r,a){var o=this.elements;return o[0]=2*r/(e-t),o[4]=0,o[8]=(e+t)/(e-t),o[12]=0,o[1]=0,o[5]=2*r/(i-n),o[9]=(i+n)/(i-n),o[13]=0,o[2]=0,o[6]=0,o[10]=-(a+r)/(a-r),o[14]=-2*a*r/(a-r),o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this},makePerspective:function(e,n,i,r){e=i*Math.tan(t.Math.DEG2RAD*e*.5);var a=-e;return this.makeFrustum(a*n,e*n,a,e,i,r)},makeOrthographic:function(t,e,n,i,r,a){var o=this.elements,s=1/(e-t),c=1/(n-i),l=1/(a-r);return o[0]=2*s,o[4]=0,o[8]=0,o[12]=-((e+t)*s),o[1]=0,o[5]=2*c,o[9]=0,o[13]=-((n+i)*c),o[2]=0,o[6]=0,o[10]=-2*l,o[14]=-((a+r)*l),o[3]=0,o[7]=0,o[11]=0,o[15]=1,this},equals:function(t){var e=this.elements;t=t.elements;for(var n=0;16>n;n++)if(e[n]!==t[n])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(var n=0;16>n;n++)this.elements[n]=t[n+e];return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t[e+9]=n[9],t[e+10]=n[10],t[e+11]=n[11],t[e+12]=n[12],t[e+13]=n[13],t[e+14]=n[14],t[e+15]=n[15],t}},h.prototype=Object.create(i.prototype),h.prototype.constructor=h,h.prototype.isCubeTexture=!0,Object.defineProperty(h.prototype,"images",{get:function(){return this.image},set:function(t){this.image=t}});var Hi=new i,Gi=new h,ki=[],Vi=[];H.prototype.setValue=function(t,e){for(var n=this.seq,i=0,r=n.length;i!==r;++i){var a=n[i];a.setValue(t,e[a.id])}};var ji=/([\w\d_]+)(\])?(\[|\.)?/g;G.prototype.setValue=function(t,e,n){e=this.map[e],void 0!==e&&e.setValue(t,n,this.renderer)},G.prototype.set=function(t,e,n){var i=this.map[n];void 0!==i&&i.setValue(t,e[n],this.renderer)},G.prototype.setOptional=function(t,e,n){e=e[n],void 0!==e&&this.setValue(t,n,e)},G.upload=function(t,e,n,i){for(var r=0,a=e.length;r!==a;++r){var o=e[r],s=n[o.id];!1!==s.needsUpdate&&o.setValue(t,s.value,i)}},G.seqWithValue=function(t,e){for(var n=[],i=0,r=t.length;i!==r;++i){var a=t[i];a.id in e&&n.push(a)}return n},G.splitDynamic=function(t,e){for(var n=null,i=t.length,r=0,a=0;a!==i;++a){var o=t[a],s=e[o.id];s&&!0===s.dynamic?(null===n&&(n=[]),n.push(o)):(r<a&&(t[r]=o),++r)}return r<i&&(t.length=r),n},G.evalDynamic=function(t,e,n,i,r){for(var a=0,o=t.length;a!==o;++a){var s=e[t[a].id],c=s.onUpdateCallback;void 0!==c&&c.call(s,n,i,r)}},t.UniformsUtils={merge:function(t){for(var e={},n=0;n<t.length;n++){var i,r=this.clone(t[n]);for(i in r)e[i]=r[i]}return e},clone:function(t){var e,n={};for(e in t){n[e]={};for(var i in t[e]){var r=t[e][i];r&&r.isColor||r&&r.isVector2||r&&r.isVector3||r&&r.isVector4||r&&r.isMatrix3||r&&r.isMatrix4||r&&r.isTexture?n[e][i]=r.clone():Array.isArray(r)?n[e][i]=r.slice():n[e][i]=r}}return n}};var Wi={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif\n",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif\n",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif\n",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif\n",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"\nvec3 transformed = vec3( position );\n",beginnormal_vertex:"\nvec3 objectNormal = vec3( normal );\n",bsdfs:"bool testLightInRange( const in float lightDistance, const in float cutoffDistance ) {\n\treturn any( bvec2( cutoffDistance == 0.0, lightDistance < cutoffDistance ) );\n}\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t\tif( decayExponent > 0.0 ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\t\tfloat maxDistanceCutoffFactor = pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t\treturn distanceFalloff * maxDistanceCutoffFactor;\n#else\n\t\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n#endif\n\t\t}\n\t\treturn 1.0;\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 AB = vec2( -1.04, 1.04 ) * a004 + r.zw;\n\treturn specularColor * AB.x + AB.y;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = dFdx( surf_pos );\n\t\tvec3 vSigmaY = dFdy( surf_pos );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif\n",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tfor ( int i = 0; i < NUM_CLIPPING_PLANES; ++ i ) {\n\t\tvec4 plane = clippingPlanes[ i ];\n\t\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\n\t}\n#endif\n",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\t#if ! defined( PHYSICAL ) && ! defined( PHONG )\n\t\tvarying vec3 vViewPosition;\n\t#endif\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif\n",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvarying vec3 vViewPosition;\n#endif\n",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n",color_fragment:"#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif\n",color_pars_vertex:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_vertex:"#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",common:"#define PI 3.14159265359\n#define PI2 6.28318530718\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\n",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_textureSize (1024.0)\nint getFaceFromDirection(vec3 direction) {\n\tvec3 absDirection = abs(direction);\n\tint face = -1;\n\tif( absDirection.x > absDirection.z ) {\n\t\tif(absDirection.x > absDirection.y )\n\t\t\tface = direction.x > 0.0 ? 0 : 3;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\telse {\n\t\tif(absDirection.z > absDirection.y )\n\t\t\tface = direction.z > 0.0 ? 2 : 5;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\treturn face;\n}\n#define cubeUV_maxLods1  (log2(cubeUV_textureSize*0.25) - 1.0)\n#define cubeUV_rangeClamp (exp2((6.0 - 1.0) * 2.0))\nvec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {\n\tfloat scale = exp2(cubeUV_maxLods1 - roughnessLevel);\n\tfloat dxRoughness = dFdx(roughness);\n\tfloat dyRoughness = dFdy(roughness);\n\tvec3 dx = dFdx( vec * scale * dxRoughness );\n\tvec3 dy = dFdy( vec * scale * dyRoughness );\n\tfloat d = max( dot( dx, dx ), dot( dy, dy ) );\n\td = clamp(d, 1.0, cubeUV_rangeClamp);\n\tfloat mipLevel = 0.5 * log2(d);\n\treturn vec2(floor(mipLevel), fract(mipLevel));\n}\n#define cubeUV_maxLods2 (log2(cubeUV_textureSize*0.25) - 2.0)\n#define cubeUV_rcpTextureSize (1.0 / cubeUV_textureSize)\nvec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {\n\tmipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;\n\tfloat a = 16.0 * cubeUV_rcpTextureSize;\n\tvec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );\n\tvec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;\n\tfloat powScale = exp2_packed.x * exp2_packed.y;\n\tfloat scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;\n\tfloat mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;\n\tbool bRes = mipLevel == 0.0;\n\tscale =  bRes && (scale < a) ? a : scale;\n\tvec3 r;\n\tvec2 offset;\n\tint face = getFaceFromDirection(direction);\n\tfloat rcpPowScale = 1.0 / powScale;\n\tif( face == 0) {\n\t\tr = vec3(direction.x, -direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ?  a : offset.y;\n\t}\n\telse if( face == 1) {\n\t\tr = vec3(direction.y, direction.x, direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ?  a : offset.y;\n\t}\n\telse if( face == 2) {\n\t\tr = vec3(direction.z, direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ?  a : offset.y;\n\t}\n\telse if( face == 3) {\n\t\tr = vec3(direction.x, direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ?  0.0 : offset.y;\n\t}\n\telse if( face == 4) {\n\t\tr = vec3(direction.y, direction.x, -direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ?  0.0 : offset.y;\n\t}\n\telse {\n\t\tr = vec3(direction.z, -direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ?  0.0 : offset.y;\n\t}\n\tr = normalize(r);\n\tfloat texelOffset = 0.5 * cubeUV_rcpTextureSize;\n\tvec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;\n\tvec2 base = offset + vec2( texelOffset );\n\treturn base + s * ( scale - 2.0 * texelOffset );\n}\n#define cubeUV_maxLods3 (log2(cubeUV_textureSize*0.25) - 3.0)\nvec4 textureCubeUV(vec3 reflectedDirection, float roughness ) {\n\tfloat roughnessVal = roughness* cubeUV_maxLods3;\n\tfloat r1 = floor(roughnessVal);\n\tfloat r2 = r1 + 1.0;\n\tfloat t = fract(roughnessVal);\n\tvec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);\n\tfloat s = mipInfo.y;\n\tfloat level0 = mipInfo.x;\n\tfloat level1 = level0 + 1.0;\n\tlevel1 = level1 > 5.0 ? 5.0 : level1;\n\tlevel0 += min( floor( s + 0.5 ), 5.0 );\n\tvec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);\n\tvec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));\n\tvec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);\n\tvec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));\n\tvec4 result = mix(color10, color20, t);\n\treturn vec4(result.rgb, 1.0);\n}\n#endif\n",defaultnormal_vertex:"#ifdef FLIP_SIDED\n\tobjectNormal = -objectNormal;\n#endif\nvec3 transformedNormal = normalMatrix * objectNormal;\n",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif\n",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normal * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\n#endif\n",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif\n",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif\n",encodings_fragment:"  gl_FragColor = linearToOutputTexel( gl_FragColor );\n",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n  return value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n  return vec4( pow( value.xyz, vec3( gammaFactor ) ), value.w );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n  return vec4( pow( value.xyz, vec3( 1.0 / gammaFactor ) ), value.w );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n  return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n  return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n  return vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n  float maxComponent = max( max( value.r, value.g ), value.b );\n  float fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n  return vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n  return vec4( value.xyz * value.w * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n  float maxRGB = max( value.x, max( value.g, value.b ) );\n  float M      = clamp( maxRGB / maxRange, 0.0, 1.0 );\n  M            = ceil( M * 255.0 ) / 255.0;\n  return vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n    return vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n    float maxRGB = max( value.x, max( value.g, value.b ) );\n    float D      = max( maxRange / maxRGB, 1.0 );\n    D            = min( floor( D ) / 255.0, 1.0 );\n    return vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n  vec3 Xp_Y_XYZp = value.rgb * cLogLuvM;\n  Xp_Y_XYZp = max(Xp_Y_XYZp, vec3(1e-6, 1e-6, 1e-6));\n  vec4 vResult;\n  vResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n  float Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n  vResult.w = fract(Le);\n  vResult.z = (Le - (floor(vResult.w*255.0))/255.0)/255.0;\n  return vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n  float Le = value.z * 255.0 + value.w;\n  vec3 Xp_Y_XYZp;\n  Xp_Y_XYZp.y = exp2((Le - 127.0) / 2.0);\n  Xp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n  Xp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n  vec3 vRGB = Xp_Y_XYZp.rgb * cLogLuvInverseM;\n  return vec4( max(vRGB, 0.0), 1.0 );\n}\n",envmap_fragment:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\tsampleUV.y = saturate( flipNormal * reflectVec.y * 0.5 + 0.5 );\n\t\tsampleUV.x = atan( flipNormal * reflectVec.z, flipNormal * reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\tvec3 reflectView = flipNormal * normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\tenvColor = envMapTexelToLinear( envColor );\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif\n",envmap_pars_fragment:"#if defined( USE_ENVMAP ) || defined( PHYSICAL )\n\tuniform float reflectivity;\n\tuniform float envMapIntenstiy;\n#endif\n#ifdef USE_ENVMAP\n\t#if ! defined( PHYSICAL ) && ( defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) )\n\t\tvarying vec3 vWorldPosition;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\tuniform float flipEnvMap;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( PHYSICAL )\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif\n",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif\n",envmap_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif\n",fog_fragment:"#ifdef USE_FOG\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tfloat depth = gl_FragDepthEXT / gl_FragCoord.w;\n\t#else\n\t\tfloat depth = gl_FragCoord.z / gl_FragCoord.w;\n\t#endif\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * depth * depth * LOG2 ) );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, depth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif\n",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\treflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n#endif\n",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_DIR_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvLightFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n#endif\n",lights_pars:"uniform vec3 ambientLightColor;\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tif ( testLightInRange( lightDistance, pointLight.distance ) ) {\n\t\t\tdirectLight.color = pointLight.color;\n\t\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( all( bvec2( angleCos > spotLight.coneCos, testLightInRange( lightDistance, spotLight.distance ) ) ) ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif\n#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\t#include <normal_flip>\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = flipNormal * vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryVec = flipNormal * vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( queryVec, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar - 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\n\t\t#endif\n\t\t#include <normal_flip>\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryReflectVec = flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\tvec4 envMapColor = textureCubeUV(queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent));\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = saturate( flipNormal * reflectVec.y * 0.5 + 0.5 );\n\t\t\tsampleUV.x = atan( flipNormal * reflectVec.z, flipNormal * reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = flipNormal * normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif\n",
lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;\n",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)\n",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\n#ifdef STANDARD\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.clearCoat = saturate( clearCoat );\tmaterial.clearCoatRoughness = clamp( clearCoatRoughness, 0.04, 1.0 );\n#endif\n",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n\t#ifndef STANDARD\n\t\tfloat clearCoat;\n\t\tfloat clearCoatRoughness;\n\t#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearCoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifndef STANDARD\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.directSpecular += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );\n\treflectedLight.directDiffuse += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\t#ifndef STANDARD\n\t\treflectedLight.directSpecular += irradiance * material.clearCoat * BRDF_Specular_GGX( directLight, geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 clearCoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifndef STANDARD\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\tfloat dotNL = dotNV;\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.indirectSpecular += ( 1.0 - clearCoatDHR ) * radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );\n\t#ifndef STANDARD\n\t\treflectedLight.indirectSpecular += clearCoatRadiance * material.clearCoat * BRDF_Specular_GGX_Environment( geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\n#define Material_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.specularRoughness )\n#define Material_ClearCoat_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.clearCoatRoughness )\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}\n",lights_template:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = normalize( vViewPosition );\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#ifdef USE_LIGHTMAP\n\t\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t \tirradiance += getLightProbeIndirectIrradiance( geometry, 8 );\n\t#endif\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tvec3 radiance = getLightProbeIndirectRadiance( geometry, Material_BlinnShininessExponent( material ), 8 );\n\t#ifndef STANDARD\n\t\tvec3 clearCoatRadiance = getLightProbeIndirectRadiance( geometry, Material_ClearCoat_BlinnShininessExponent( material ), 8 );\n\t#else\n\t\tvec3 clearCoatRadiance = vec3( 0.0 );\n\t#endif\n\t\t\n\tRE_IndirectSpecular( radiance, clearCoatRadiance, geometry, material, reflectedLight );\n#endif\n",logdepthbuf_fragment:"#if defined(USE_LOGDEPTHBUF) && defined(USE_LOGDEPTHBUF_EXT)\n\tgl_FragDepthEXT = log2(vFragDepth) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#ifdef USE_LOGDEPTHBUF\n\tuniform float logDepthBufFC;\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n#endif\n",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n\tuniform float logDepthBufFC;\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\tgl_Position.z = log2(max( EPSILON, gl_Position.w + 1.0 )) * logDepthBufFC;\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t#else\n\t\tgl_Position.z = (gl_Position.z - 1.0) * gl_Position.w;\n\t#endif\n#endif\n",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif\n",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n",map_particle_fragment:"#ifdef USE_MAP\n\tvec4 mapTexel = texture2D( map, vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y ) * offsetRepeat.zw + offsetRepeat.xy );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n",map_particle_pars_fragment:"#ifdef USE_MAP\n\tuniform vec4 offsetRepeat;\n\tuniform sampler2D map;\n#endif\n",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.r;\n#endif\n",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n#endif\n",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\t#endif\n#endif\n",normal_flip:"#ifdef DOUBLE_SIDED\n\tfloat flipNormal = ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n#else\n\tfloat flipNormal = 1.0;\n#endif\n",normal_fragment:"#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal ) * flipNormal;\n#endif\n#ifdef USE_NORMALMAP\n\tnormal = perturbNormal2Arb( -vViewPosition, normal );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif\n",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 S = normalize( q0 * st1.t - q1 * st0.t );\n\t\tvec3 T = normalize( -q0 * st1.s + q1 * st0.s );\n\t\tvec3 N = normalize( surf_norm );\n\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\tmapN.xy = normalScale * mapN.xy;\n\t\tmat3 tsn = mat3( S, T, N );\n\t\treturn normalize( tsn * mapN );\n\t}\n#endif\n",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n  return normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n  return 1.0 - 2.0 * rgb.xyz;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n  return ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n  return linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n  return (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n  return ( near * far ) / ( ( far - near ) * invClipZ - far );\n}\n",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif\n",project_vertex:"#ifdef USE_SKINNING\n\tvec4 mvPosition = modelViewMatrix * skinned;\n#else\n\tvec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\n#endif\ngl_Position = projectionMatrix * mvPosition;\n",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.r;\n#endif\n",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\n\t\tconst vec2 offset = vec2( 0.0, 1.0 );\n\t\tvec2 texelSize = vec2( 1.0 ) / size;\n\t\tvec2 centroidUV = floor( uv * size + 0.5 ) / size;\n\t\tfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\n\t\tfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\n\t\tfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\n\t\tfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\n\t\tvec2 f = fract( uv * size + 0.5 );\n\t\tfloat a = mix( lb, lt, f.y );\n\t\tfloat b = mix( rb, rt, f.y );\n\t\tfloat c = mix( a, b, f.x );\n\t\treturn c;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\treturn (\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn 1.0;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\tfloat dp = ( length( lightToPosition ) - shadowBias ) / 1000.0;\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif\n",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n#endif\n",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n#endif\n",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tDirectionalLight directionalLight;\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tshadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tSpotLight spotLight;\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tshadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tPointLight pointLight;\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tshadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#endif\n\treturn shadow;\n}\n",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform sampler2D boneTexture;\n\t\tuniform int boneTextureWidth;\n\t\tuniform int boneTextureHeight;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureWidth ) );\n\t\t\tfloat y = floor( j / float( boneTextureWidth ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureWidth );\n\t\t\tfloat dy = 1.0 / float( boneTextureHeight );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif\n",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\tskinned  = bindMatrixInverse * skinned;\n#endif\n",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n#endif\n",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n  gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif\n",tonemapping_pars_fragment:"#define saturate(a) clamp( a, 0.0, 1.0 )\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n  return toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n  color *= toneMappingExposure;\n  return saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n  color *= toneMappingExposure;\n  return saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n  color *= toneMappingExposure;\n  color = max( vec3( 0.0 ), color - 0.004 );\n  return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\n",uv_pars_fragment:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n\tuniform vec4 offsetRepeat;\n#endif\n",uv_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvUv = uv * offsetRepeat.zw + offsetRepeat.xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = uv2;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( PHYSICAL ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )\n\t#ifdef USE_SKINNING\n\t\tvec4 worldPosition = modelMatrix * skinned;\n\t#else\n\t\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n\t#endif\n#endif\n",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\n\tgl_FragColor.a *= opacity;\n}\n",cube_vert:"varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}\n",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( gl_FragCoord.z ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\n\t#endif\n}\n",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#include <begin_vertex>\n\t#include <displacementmap_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n",distanceRGBA_frag:"uniform vec3 lightPos;\nvarying vec4 vWorldPosition;\n#include <common>\n#include <packing>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tgl_FragColor = packDepthToRGBA( length( vWorldPosition.xyz - lightPos.xyz ) / 1000.0 );\n}\n",distanceRGBA_vert:"varying vec4 vWorldPosition;\n#include <common>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <skinbase_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition;\n}\n",equirect_frag:"uniform sampler2D tEquirect;\nuniform float tFlip;\nvarying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldPosition );\n\tvec2 sampleUV;\n\tsampleUV.y = saturate( tFlip * direction.y * -0.5 + 0.5 );\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n}\n",equirect_vert:"varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}\n",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",
linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\tvLineDistance = scale * lineDistance;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight;\n\treflectedLight.directDiffuse = vec3( 0.0 );\n\treflectedLight.directSpecular = vec3( 0.0 );\n\treflectedLight.indirectDiffuse = diffuseColor.rgb;\n\treflectedLight.indirectSpecular = vec3( 0.0 );\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <normal_flip>\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n}\n",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <normal_flip>\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars>\n#include <color_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n}\n",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_flip>\n\t#include <normal_fragment>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_template>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <displacementmap_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n}\n",meshphysical_frag:"#define PHYSICAL\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifndef STANDARD\n\tuniform float clearCoat;\n\tuniform float clearCoatRoughness;\n#endif\nuniform float envMapIntensity;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <lights_pars>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_flip>\n\t#include <normal_fragment>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_template>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",meshphysical_vert:"#define PHYSICAL\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <displacementmap_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n}\n",normal_frag:"uniform float opacity;\nvarying vec3 vNormal;\n#include <common>\n#include <packing>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tgl_FragColor = vec4( packNormalToRGB( vNormal ), opacity );\n\t#include <logdepthbuf_fragment>\n}\n",normal_vert:"varying vec3 vNormal;\n#include <common>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvNormal = normalize( normalMatrix * normal );\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#ifdef USE_SIZEATTENUATION\n\t\tgl_PointSize = size * ( scale / - mvPosition.z );\n\t#else\n\t\tgl_PointSize = size;\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n}\n",shadow_frag:"uniform float opacity;\n#include <common>\n#include <packing>\n#include <bsdfs>\n#include <lights_pars>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( 0.0, 0.0, 0.0, opacity * ( 1.0  - getShadowMask() ) );\n}\n",shadow_vert:"#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n}\n"};k.prototype={constructor:k,isColor:!0,r:1,g:1,b:1,set:function(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this},setScalar:function(t){this.b=this.g=this.r=t},setHex:function(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this},setRGB:function(t,e,n){return this.r=t,this.g=e,this.b=n,this},setHSL:function(){function e(t,e,n){return 0>n&&(n+=1),1<n&&--n,n<1/6?t+6*(e-t)*n:.5>n?e:n<2/3?t+6*(e-t)*(2/3-n):t}return function(n,i,r){return n=t.Math.euclideanModulo(n,1),i=t.Math.clamp(i,0,1),r=t.Math.clamp(r,0,1),0===i?this.r=this.g=this.b=r:(i=.5>=r?r*(1+i):r+i-r*i,r=2*r-i,this.r=e(r,i,n+1/3),this.g=e(r,i,n),this.b=e(r,i,n-1/3)),this}}(),setStyle:function(e){function n(t){void 0!==t&&1>parseFloat(t)&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}var i;if(i=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(e)){var r=i[2];switch(i[1]){case"rgb":case"rgba":if(i=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(r))return this.r=Math.min(255,parseInt(i[1],10))/255,this.g=Math.min(255,parseInt(i[2],10))/255,this.b=Math.min(255,parseInt(i[3],10))/255,n(i[5]),this;if(i=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(r))return this.r=Math.min(100,parseInt(i[1],10))/100,this.g=Math.min(100,parseInt(i[2],10))/100,this.b=Math.min(100,parseInt(i[3],10))/100,n(i[5]),this;break;case"hsl":case"hsla":if(i=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(r)){var r=parseFloat(i[1])/360,a=parseInt(i[2],10)/100,o=parseInt(i[3],10)/100;return n(i[5]),this.setHSL(r,a,o)}}}else if(i=/^\#([A-Fa-f0-9]+)$/.exec(e)){if(i=i[1],r=i.length,3===r)return this.r=parseInt(i.charAt(0)+i.charAt(0),16)/255,this.g=parseInt(i.charAt(1)+i.charAt(1),16)/255,this.b=parseInt(i.charAt(2)+i.charAt(2),16)/255,this;if(6===r)return this.r=parseInt(i.charAt(0)+i.charAt(1),16)/255,this.g=parseInt(i.charAt(2)+i.charAt(3),16)/255,this.b=parseInt(i.charAt(4)+i.charAt(5),16)/255,this}return e&&0<e.length&&(i=t.ColorKeywords[e],void 0!==i?this.setHex(i):console.warn("THREE.Color: Unknown color "+e)),this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},copyGammaToLinear:function(t,e){return void 0===e&&(e=2),this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this},copyLinearToGamma:function(t,e){void 0===e&&(e=2);var n=0<e?1/e:1;return this.r=Math.pow(t.r,n),this.g=Math.pow(t.g,n),this.b=Math.pow(t.b,n),this},convertGammaToLinear:function(){var t=this.r,e=this.g,n=this.b;return this.r=t*t,this.g=e*e,this.b=n*n,this},convertLinearToGamma:function(){return this.r=Math.sqrt(this.r),this.g=Math.sqrt(this.g),this.b=Math.sqrt(this.b),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(t){t=t||{h:0,s:0,l:0};var e,n=this.r,i=this.g,r=this.b,a=Math.max(n,i,r),o=Math.min(n,i,r),s=(o+a)/2;if(o===a)o=e=0;else{var c=a-o,o=.5>=s?c/(a+o):c/(2-a-o);switch(a){case n:e=(i-r)/c+(i<r?6:0);break;case i:e=(r-n)/c+2;break;case r:e=(n-i)/c+4}e/=6}return t.h=e,t.s=o,t.l=s,t},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(t,e,n){var i=this.getHSL();return i.h+=t,i.s+=e,i.l+=n,this.setHSL(i.h,i.s,i.l),this},add:function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this},addColors:function(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this},addScalar:function(t){return this.r+=t,this.g+=t,this.b+=t,this},sub:function(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this},multiply:function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this},multiplyScalar:function(t){return this.r*=t,this.g*=t,this.b*=t,this},lerp:function(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this},equals:function(t){return t.r===this.r&&t.g===this.g&&t.b===this.b},fromArray:function(t,e){return void 0===e&&(e=0),this.r=t[e],this.g=t[e+1],this.b=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t},toJSON:function(){return this.getHex()}},t.ColorKeywords={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};var Xi={common:{diffuse:{value:new k(15658734)},opacity:{value:1},map:{value:null},offsetRepeat:{value:new r(0,0,1,1)},specularMap:{value:null},alphaMap:{value:null},envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new n(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new k(16777215)}},lights:{ambientLightColor:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}}},points:{diffuse:{value:new k(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},offsetRepeat:{value:new r(0,0,1,1)}}},qi={basic:{uniforms:t.UniformsUtils.merge([Xi.common,Xi.aomap,Xi.fog]),vertexShader:Wi.meshbasic_vert,fragmentShader:Wi.meshbasic_frag},lambert:{uniforms:t.UniformsUtils.merge([Xi.common,Xi.aomap,Xi.lightmap,Xi.emissivemap,Xi.fog,Xi.lights,{emissive:{value:new k(0)}}]),vertexShader:Wi.meshlambert_vert,fragmentShader:Wi.meshlambert_frag},phong:{uniforms:t.UniformsUtils.merge([Xi.common,Xi.aomap,Xi.lightmap,Xi.emissivemap,Xi.bumpmap,Xi.normalmap,Xi.displacementmap,Xi.fog,Xi.lights,{emissive:{value:new k(0)},specular:{value:new k(1118481)},shininess:{value:30}}]),vertexShader:Wi.meshphong_vert,fragmentShader:Wi.meshphong_frag},standard:{uniforms:t.UniformsUtils.merge([Xi.common,Xi.aomap,Xi.lightmap,Xi.emissivemap,Xi.bumpmap,Xi.normalmap,Xi.displacementmap,Xi.roughnessmap,Xi.metalnessmap,Xi.fog,Xi.lights,{emissive:{value:new k(0)},roughness:{value:.5},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Wi.meshphysical_vert,fragmentShader:Wi.meshphysical_frag},points:{uniforms:t.UniformsUtils.merge([Xi.points,Xi.fog]),vertexShader:Wi.points_vert,fragmentShader:Wi.points_frag},dashed:{uniforms:t.UniformsUtils.merge([Xi.common,Xi.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Wi.linedashed_vert,fragmentShader:Wi.linedashed_frag},depth:{uniforms:t.UniformsUtils.merge([Xi.common,Xi.displacementmap]),vertexShader:Wi.depth_vert,fragmentShader:Wi.depth_frag},normal:{uniforms:{opacity:{value:1}},vertexShader:Wi.normal_vert,fragmentShader:Wi.normal_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Wi.cube_vert,fragmentShader:Wi.cube_frag},equirect:{uniforms:{tEquirect:{value:null},tFlip:{value:-1}},vertexShader:Wi.equirect_vert,fragmentShader:Wi.equirect_frag},distanceRGBA:{uniforms:{lightPos:{value:new c}},vertexShader:Wi.distanceRGBA_vert,fragmentShader:Wi.distanceRGBA_frag}};qi.physical={uniforms:t.UniformsUtils.merge([qi.standard.uniforms,{clearCoat:{value:0},clearCoatRoughness:{value:0}}]),vertexShader:Wi.meshphysical_vert,fragmentShader:Wi.meshphysical_frag},V.prototype={constructor:V,set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromPoints:function(t){this.makeEmpty();for(var e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:function(){var t=new n;return function(e,n){var i=t.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-(1/0),this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(t){return t=t||new n,this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){return t=t||new n,this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y},getParameter:function(t,e){return(e||new n).set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)},clampPoint:function(t,e){return(e||new n).copy(t).clamp(this.min,this.max)},distanceToPoint:function(){var t=new n;return function(e){return t.copy(e).clamp(this.min,this.max).sub(e).length()}}(),intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}},X.prototype={constructor:X,isMaterial:!0,get needsUpdate(){return this._needsUpdate},set needsUpdate(t){!0===t&&this.update(),this._needsUpdate=t},setValues:function(t){if(void 0!==t)for(var e in t){var n=t[e];if(void 0===n)console.warn("THREE.Material: '"+e+"' parameter is undefined.");else{var i=this[e];void 0===i?console.warn("THREE."+this.type+": '"+e+"' is not a property of this material."):i&&i.isColor?i.set(n):i&&i.isVector3&&n&&n.isVector3?i.copy(n):this[e]="overdraw"===e?Number(n):n}}},toJSON:function(t){function e(t){var e,n=[];for(e in t){var i=t[e];delete i.metadata,n.push(i)}return n}var n=void 0===t;n&&(t={textures:{},images:{}});var i={metadata:{version:4.4,type:"Material",generator:"Material.toJSON"}};return i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),void 0!==this.roughness&&(i.roughness=this.roughness),void 0!==this.metalness&&(i.metalness=this.metalness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),void 0!==this.shininess&&(i.shininess=this.shininess),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(t).uuid),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(t).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(t).uuid,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(t).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(t).uuid,i.reflectivity=this.reflectivity),void 0!==this.size&&(i.size=this.size),void 0!==this.sizeAttenuation&&(i.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(i.blending=this.blending),2!==this.shading&&(i.shading=this.shading),0!==this.side&&(i.side=this.side),0!==this.vertexColors&&(i.vertexColors=this.vertexColors),1>this.opacity&&(i.opacity=this.opacity),!0===this.transparent&&(i.transparent=this.transparent),i.depthFunc=this.depthFunc,i.depthTest=this.depthTest,i.depthWrite=this.depthWrite,0<this.alphaTest&&(i.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(i.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(i.wireframe=this.wireframe),1<this.wireframeLinewidth&&(i.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(i.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(i.wireframeLinejoin=this.wireframeLinejoin),i.skinning=this.skinning,i.morphTargets=this.morphTargets,n&&(n=e(t.textures),t=e(t.images),0<n.length&&(i.textures=n),0<t.length&&(i.images=t)),i},clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.name=t.name,this.fog=t.fog,this.lights=t.lights,this.blending=t.blending,this.side=t.side,this.shading=t.shading,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.alphaTest=t.alphaTest,this.premultipliedAlpha=t.premultipliedAlpha,this.overdraw=t.overdraw,this.visible=t.visible,this.clipShadows=t.clipShadows,t=t.clippingPlanes;var e=null;if(null!==t)for(var n=t.length,e=Array(n),i=0;i!==n;++i)e[i]=t[i].clone();return this.clippingPlanes=e,this;
},update:function(){this.dispatchEvent({type:"update"})},dispose:function(){this.dispatchEvent({type:"dispose"})}},Object.assign(X.prototype,e.prototype);var Yi=0;q.prototype=Object.create(X.prototype),q.prototype.constructor=q,q.prototype.isShaderMaterial=!0,q.prototype.copy=function(e){return X.prototype.copy.call(this,e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=t.UniformsUtils.clone(e.uniforms),this.defines=e.defines,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.extensions=e.extensions,this},q.prototype.toJSON=function(t){return t=X.prototype.toJSON.call(this,t),t.uniforms=this.uniforms,t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t},Y.prototype=Object.create(X.prototype),Y.prototype.constructor=Y,Y.prototype.isMeshDepthMaterial=!0,Y.prototype.copy=function(t){return X.prototype.copy.call(this,t),this.depthPacking=t.depthPacking,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this},Z.prototype={constructor:Z,isBox3:!0,set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromArray:function(t){for(var e=1/0,n=1/0,i=1/0,r=-(1/0),a=-(1/0),o=-(1/0),s=0,c=t.length;s<c;s+=3){var l=t[s],h=t[s+1],u=t[s+2];l<e&&(e=l),h<n&&(n=h),u<i&&(i=u),l>r&&(r=l),h>a&&(a=h),u>o&&(o=u)}this.min.set(e,n,i),this.max.set(r,a,o)},setFromPoints:function(t){this.makeEmpty();for(var e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:function(){var t=new c;return function(e,n){var i=t.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}}(),setFromObject:function(){var t=new c;return function(e){var n=this;return e.updateMatrixWorld(!0),this.makeEmpty(),e.traverse(function(e){var i=e.geometry;if(void 0!==i)if(i&&i.isGeometry)for(var i=i.vertices,r=0,a=i.length;r<a;r++)t.copy(i[r]),t.applyMatrix4(e.matrixWorld),n.expandByPoint(t);else if(i&&i.isBufferGeometry&&(a=i.attributes.position,void 0!==a)){var o;for(a&&a.isInterleavedBufferAttribute?(i=a.data.array,r=a.offset,o=a.data.stride):(i=a.array,r=0,o=3),a=i.length;r<a;r+=o)t.fromArray(i,r),t.applyMatrix4(e.matrixWorld),n.expandByPoint(t)}}),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-(1/0),this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(t){return t=t||new c,this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){return t=t||new c,this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z},getParameter:function(t,e){return(e||new c).set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)},intersectsSphere:function(){var t;return function(e){return void 0===t&&(t=new c),this.clampPoint(e.center,t),t.distanceToSquared(e.center)<=e.radius*e.radius}}(),intersectsPlane:function(t){var e,n;return 0<t.normal.x?(e=t.normal.x*this.min.x,n=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,n=t.normal.x*this.min.x),0<t.normal.y?(e+=t.normal.y*this.min.y,n+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,n+=t.normal.y*this.min.y),0<t.normal.z?(e+=t.normal.z*this.min.z,n+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,n+=t.normal.z*this.min.z),e<=t.constant&&n>=t.constant},clampPoint:function(t,e){return(e||new c).copy(t).clamp(this.min,this.max)},distanceToPoint:function(){var t=new c;return function(e){return t.copy(e).clamp(this.min,this.max).sub(e).length()}}(),getBoundingSphere:function(){var t=new c;return function(e){return e=e||new J,this.getCenter(e.center),e.radius=.5*this.size(t).length(),e}}(),intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},applyMatrix4:function(){var t=[new c,new c,new c,new c,new c,new c,new c,new c];return function(e){return this.isEmpty()?this:(t[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),t[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),t[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),t[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),t[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),t[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),t[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),t[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(t),this)}}(),translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}},J.prototype={constructor:J,set:function(t,e){return this.center.copy(t),this.radius=e,this},setFromPoints:function(){var t=new Z;return function(e,n){var i=this.center;void 0!==n?i.copy(n):t.setFromPoints(e).getCenter(i);for(var r=0,a=0,o=e.length;a<o;a++)r=Math.max(r,i.distanceToSquared(e[a]));return this.radius=Math.sqrt(r),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.center.copy(t.center),this.radius=t.radius,this},empty:function(){return 0>=this.radius},containsPoint:function(t){return t.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(t){return t.distanceTo(this.center)-this.radius},intersectsSphere:function(t){var e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e},intersectsBox:function(t){return t.intersectsSphere(this)},intersectsPlane:function(t){return Math.abs(this.center.dot(t.normal)-t.constant)<=this.radius},clampPoint:function(t,e){var n=this.center.distanceToSquared(t),i=e||new c;return i.copy(t),n>this.radius*this.radius&&(i.sub(this.center).normalize(),i.multiplyScalar(this.radius).add(this.center)),i},getBoundingBox:function(t){return t=t||new Z,t.set(this.center,this.center),t.expandByScalar(this.radius),t},applyMatrix4:function(t){return this.center.applyMatrix4(t),this.radius*=t.getMaxScaleOnAxis(),this},translate:function(t){return this.center.add(t),this},equals:function(t){return t.center.equals(this.center)&&t.radius===this.radius}},Q.prototype={constructor:Q,isMatrix3:!0,set:function(t,e,n,i,r,a,o,s,c){var l=this.elements;return l[0]=t,l[1]=i,l[2]=o,l[3]=e,l[4]=r,l[5]=s,l[6]=n,l[7]=a,l[8]=c,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(t){return t=t.elements,this.set(t[0],t[3],t[6],t[1],t[4],t[7],t[2],t[5],t[8]),this},setFromMatrix4:function(t){return t=t.elements,this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this},applyToVector3Array:function(){var t;return function(e,n,i){void 0===t&&(t=new c),void 0===n&&(n=0),void 0===i&&(i=e.length);for(var r=0;r<i;r+=3,n+=3)t.fromArray(e,n),t.applyMatrix3(this),t.toArray(e,n);return e}}(),applyToBuffer:function(){var t;return function(e,n,i){void 0===t&&(t=new c),void 0===n&&(n=0),void 0===i&&(i=e.length/e.itemSize);for(var r=0;r<i;r++,n++)t.x=e.getX(n),t.y=e.getY(n),t.z=e.getZ(n),t.applyMatrix3(this),e.setXYZ(t.x,t.y,t.z);return e}}(),multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this},determinant:function(){var t=this.elements,e=t[0],n=t[1],i=t[2],r=t[3],a=t[4],o=t[5],s=t[6],c=t[7],t=t[8];return e*a*t-e*o*c-n*r*t+n*o*s+i*r*c-i*a*s},getInverse:function(t,e){t&&t.isMatrix4&&console.error("THREE.Matrix3.getInverse no longer takes a Matrix4 argument.");var n=t.elements,i=this.elements,r=n[0],a=n[1],o=n[2],s=n[3],c=n[4],l=n[5],h=n[6],u=n[7],n=n[8],d=n*c-l*u,p=l*h-n*s,f=u*s-c*h,m=r*d+a*p+o*f;if(0===m){if(!0===e)throw Error("THREE.Matrix3.getInverse(): can't invert matrix, determinant is 0");return console.warn("THREE.Matrix3.getInverse(): can't invert matrix, determinant is 0"),this.identity()}return m=1/m,i[0]=d*m,i[1]=(o*u-n*a)*m,i[2]=(l*a-o*c)*m,i[3]=p*m,i[4]=(n*r-o*h)*m,i[5]=(o*s-l*r)*m,i[6]=f*m,i[7]=(a*h-u*r)*m,i[8]=(c*r-a*s)*m,this},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this},flattenToArrayOffset:function(t,e){return console.warn("THREE.Matrix3: .flattenToArrayOffset is deprecated - just use .toArray instead."),this.toArray(t,e)},getNormalMatrix:function(t){return this.setFromMatrix4(t).getInverse(this).transpose()},transposeIntoArray:function(t){var e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this},fromArray:function(t,e){void 0===e&&(e=0);for(var n=0;9>n;n++)this.elements[n]=t[n+e];return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t}},K.prototype={constructor:K,set:function(t,e){return this.normal.copy(t),this.constant=e,this},setComponents:function(t,e,n,i){return this.normal.set(t,e,n),this.constant=i,this},setFromNormalAndCoplanarPoint:function(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this},setFromCoplanarPoints:function(){var t=new c,e=new c;return function(n,i,r){return i=t.subVectors(r,i).cross(e.subVectors(n,i)).normalize(),this.setFromNormalAndCoplanarPoint(i,n),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.normal.copy(t.normal),this.constant=t.constant,this},normalize:function(){var t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(t){return this.normal.dot(t)+this.constant},distanceToSphere:function(t){return this.distanceToPoint(t.center)-t.radius},projectPoint:function(t,e){return this.orthoPoint(t,e).sub(t).negate()},orthoPoint:function(t,e){var n=this.distanceToPoint(t);return(e||new c).copy(this.normal).multiplyScalar(n)},intersectLine:function(){var t=new c;return function(e,n){var i=n||new c,r=e.delta(t),a=this.normal.dot(r);return 0!==a?(a=-(e.start.dot(this.normal)+this.constant)/a,0>a||1<a?void 0:i.copy(r).multiplyScalar(a).add(e.start)):0===this.distanceToPoint(e.start)?i.copy(e.start):void 0}}(),intersectsLine:function(t){var e=this.distanceToPoint(t.start);return t=this.distanceToPoint(t.end),0>e&&0<t||0>t&&0<e},intersectsBox:function(t){return t.intersectsPlane(this)},intersectsSphere:function(t){return t.intersectsPlane(this)},coplanarPoint:function(t){return(t||new c).copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var t=new c,e=new Q;return function(n,i){var r=this.coplanarPoint(t).applyMatrix4(n),a=i||e.getNormalMatrix(n),a=this.normal.applyMatrix3(a).normalize();return this.constant=-r.dot(a),this}}(),translate:function(t){return this.constant-=t.dot(this.normal),this},equals:function(t){return t.normal.equals(this.normal)&&t.constant===this.constant}},$.prototype={constructor:$,set:function(t,e,n,i,r,a){var o=this.planes;return o[0].copy(t),o[1].copy(e),o[2].copy(n),o[3].copy(i),o[4].copy(r),o[5].copy(a),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){for(var e=this.planes,n=0;6>n;n++)e[n].copy(t.planes[n]);return this},setFromMatrix:function(t){var e=this.planes,n=t.elements;t=n[0];var i=n[1],r=n[2],a=n[3],o=n[4],s=n[5],c=n[6],l=n[7],h=n[8],u=n[9],d=n[10],p=n[11],f=n[12],m=n[13],g=n[14],n=n[15];return e[0].setComponents(a-t,l-o,p-h,n-f).normalize(),e[1].setComponents(a+t,l+o,p+h,n+f).normalize(),e[2].setComponents(a+i,l+s,p+u,n+m).normalize(),e[3].setComponents(a-i,l-s,p-u,n-m).normalize(),e[4].setComponents(a-r,l-c,p-d,n-g).normalize(),e[5].setComponents(a+r,l+c,p+d,n+g).normalize(),this},intersectsObject:function(){var t=new J;return function(e){var n=e.geometry;return null===n.boundingSphere&&n.computeBoundingSphere(),t.copy(n.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(t)}}(),intersectsSprite:function(){var t=new J;return function(e){return t.center.set(0,0,0),t.radius=.7071067811865476,t.applyMatrix4(e.matrixWorld),this.intersectsSphere(t)}}(),intersectsSphere:function(t){var e=this.planes,n=t.center;t=-t.radius;for(var i=0;6>i;i++)if(e[i].distanceToPoint(n)<t)return!1;return!0},intersectsBox:function(){var t=new c,e=new c;return function(n){for(var i=this.planes,r=0;6>r;r++){var a=i[r];t.x=0<a.normal.x?n.min.x:n.max.x,e.x=0<a.normal.x?n.max.x:n.min.x,t.y=0<a.normal.y?n.min.y:n.max.y,e.y=0<a.normal.y?n.max.y:n.min.y,t.z=0<a.normal.z?n.min.z:n.max.z,e.z=0<a.normal.z?n.max.z:n.min.z;var o=a.distanceToPoint(t),a=a.distanceToPoint(e);if(0>o&&0>a)return!1}return!0}}(),containsPoint:function(t){for(var e=this.planes,n=0;6>n;n++)if(0>e[n].distanceToPoint(t))return!1;return!0}},et.prototype={constructor:et,set:function(t,e){return this.origin.copy(t),this.direction.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this},at:function(t,e){return(e||new c).copy(this.direction).multiplyScalar(t).add(this.origin)},lookAt:function(t){return this.direction.copy(t).sub(this.origin).normalize(),this},recast:function(){var t=new c;return function(e){return this.origin.copy(this.at(e,t)),this}}(),closestPointToPoint:function(t,e){var n=e||new c;n.subVectors(t,this.origin);var i=n.dot(this.direction);return 0>i?n.copy(this.origin):n.copy(this.direction).multiplyScalar(i).add(this.origin)},distanceToPoint:function(t){return Math.sqrt(this.distanceSqToPoint(t))},distanceSqToPoint:function(){var t=new c;return function(e){var n=t.subVectors(e,this.origin).dot(this.direction);return 0>n?this.origin.distanceToSquared(e):(t.copy(this.direction).multiplyScalar(n).add(this.origin),t.distanceToSquared(e))}}(),distanceSqToSegment:function(){var t=new c,e=new c,n=new c;return function(i,r,a,o){t.copy(i).add(r).multiplyScalar(.5),e.copy(r).sub(i).normalize(),n.copy(this.origin).sub(t);var s,c=.5*i.distanceTo(r),l=-this.direction.dot(e),h=n.dot(this.direction),u=-n.dot(e),d=n.lengthSq(),p=Math.abs(1-l*l);return 0<p?(i=l*u-h,r=l*h-u,s=c*p,0<=i?r>=-s?r<=s?(c=1/p,i*=c,r*=c,l=i*(i+l*r+2*h)+r*(l*i+r+2*u)+d):(r=c,i=Math.max(0,-(l*r+h)),l=-i*i+r*(r+2*u)+d):(r=-c,i=Math.max(0,-(l*r+h)),l=-i*i+r*(r+2*u)+d):r<=-s?(i=Math.max(0,-(-l*c+h)),r=0<i?-c:Math.min(Math.max(-c,-u),c),l=-i*i+r*(r+2*u)+d):r<=s?(i=0,r=Math.min(Math.max(-c,-u),c),l=r*(r+2*u)+d):(i=Math.max(0,-(l*c+h)),r=0<i?c:Math.min(Math.max(-c,-u),c),l=-i*i+r*(r+2*u)+d)):(r=0<l?-c:c,i=Math.max(0,-(l*r+h)),l=-i*i+r*(r+2*u)+d),a&&a.copy(this.direction).multiplyScalar(i).add(this.origin),o&&o.copy(e).multiplyScalar(r).add(t),l}}(),intersectSphere:function(){var t=new c;return function(e,n){t.subVectors(e.center,this.origin);var i=t.dot(this.direction),r=t.dot(t)-i*i,a=e.radius*e.radius;return r>a?null:(a=Math.sqrt(a-r),r=i-a,i+=a,0>r&&0>i?null:0>r?this.at(i,n):this.at(r,n))}}(),intersectsSphere:function(t){return this.distanceToPoint(t.center)<=t.radius},distanceToPlane:function(t){var e=t.normal.dot(this.direction);return 0===e?0===t.distanceToPoint(this.origin)?0:null:(t=-(this.origin.dot(t.normal)+t.constant)/e,0<=t?t:null)},intersectPlane:function(t,e){var n=this.distanceToPlane(t);return null===n?null:this.at(n,e)},intersectsPlane:function(t){var e=t.distanceToPoint(this.origin);return 0===e||0>t.normal.dot(this.direction)*e},intersectBox:function(t,e){var n,i,r,a,o;i=1/this.direction.x,a=1/this.direction.y,o=1/this.direction.z;var s=this.origin;return 0<=i?(n=(t.min.x-s.x)*i,i*=t.max.x-s.x):(n=(t.max.x-s.x)*i,i*=t.min.x-s.x),0<=a?(r=(t.min.y-s.y)*a,a*=t.max.y-s.y):(r=(t.max.y-s.y)*a,a*=t.min.y-s.y),n>a||r>i?null:((r>n||n!==n)&&(n=r),(a<i||i!==i)&&(i=a),0<=o?(r=(t.min.z-s.z)*o,o*=t.max.z-s.z):(r=(t.max.z-s.z)*o,o*=t.min.z-s.z),n>o||r>i?null:((r>n||n!==n)&&(n=r),(o<i||i!==i)&&(i=o),0>i?null:this.at(0<=n?n:i,e)))},intersectsBox:function(){var t=new c;return function(e){return null!==this.intersectBox(e,t)}}(),intersectTriangle:function(){var t=new c,e=new c,n=new c,i=new c;return function(r,a,o,s,c){if(e.subVectors(a,r),n.subVectors(o,r),i.crossVectors(e,n),a=this.direction.dot(i),0<a){if(s)return null;s=1}else{if(!(0>a))return null;s=-1,a=-a}return t.subVectors(this.origin,r),r=s*this.direction.dot(n.crossVectors(t,n)),0>r?null:(o=s*this.direction.dot(e.cross(t)),0>o||r+o>a?null:(r=-s*t.dot(i),0>r?null:this.at(r/a,c)))}}(),applyMatrix4:function(t){return this.direction.add(this.origin).applyMatrix4(t),this.origin.applyMatrix4(t),this.direction.sub(this.origin),this.direction.normalize(),this},equals:function(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}},nt.RotationOrders="XYZ YZX ZXY XZY YXZ ZYX".split(" "),nt.DefaultOrder="XYZ",nt.prototype={constructor:nt,isEuler:!0,get x(){return this._x},set x(t){this._x=t,this.onChangeCallback()},get y(){return this._y},set y(t){this._y=t,this.onChangeCallback()},get z(){return this._z},set z(t){this._z=t,this.onChangeCallback()},get order(){return this._order},set order(t){this._order=t,this.onChangeCallback()},set:function(t,e,n,i){return this._x=t,this._y=e,this._z=n,this._order=i||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this.onChangeCallback(),this},setFromRotationMatrix:function(e,n,i){var r=t.Math.clamp,a=e.elements;e=a[0];var o=a[4],s=a[8],c=a[1],l=a[5],h=a[9],u=a[2],d=a[6],a=a[10];return n=n||this._order,"XYZ"===n?(this._y=Math.asin(r(s,-1,1)),.99999>Math.abs(s)?(this._x=Math.atan2(-h,a),this._z=Math.atan2(-o,e)):(this._x=Math.atan2(d,l),this._z=0)):"YXZ"===n?(this._x=Math.asin(-r(h,-1,1)),.99999>Math.abs(h)?(this._y=Math.atan2(s,a),this._z=Math.atan2(c,l)):(this._y=Math.atan2(-u,e),this._z=0)):"ZXY"===n?(this._x=Math.asin(r(d,-1,1)),.99999>Math.abs(d)?(this._y=Math.atan2(-u,a),this._z=Math.atan2(-o,l)):(this._y=0,this._z=Math.atan2(c,e))):"ZYX"===n?(this._y=Math.asin(-r(u,-1,1)),.99999>Math.abs(u)?(this._x=Math.atan2(d,a),this._z=Math.atan2(c,e)):(this._x=0,this._z=Math.atan2(-o,l))):"YZX"===n?(this._z=Math.asin(r(c,-1,1)),.99999>Math.abs(c)?(this._x=Math.atan2(-h,l),this._y=Math.atan2(-u,e)):(this._x=0,this._y=Math.atan2(s,a))):"XZY"===n?(this._z=Math.asin(-r(o,-1,1)),.99999>Math.abs(o)?(this._x=Math.atan2(d,l),this._y=Math.atan2(s,e)):(this._x=Math.atan2(-h,a),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+n),this._order=n,!1!==i&&this.onChangeCallback(),this},setFromQuaternion:function(){var t;return function(e,n,i){return void 0===t&&(t=new l),t.makeRotationFromQuaternion(e),this.setFromRotationMatrix(t,n,i)}}(),setFromVector3:function(t,e){return this.set(t.x,t.y,t.z,e||this._order)},reorder:function(){var t=new s;return function(e){return t.setFromEuler(this),this.setFromQuaternion(t,e)}}(),equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order},fromArray:function(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this.onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t},toVector3:function(t){return t?t.set(this._x,this._y,this._z):new c(this._x,this._y,this._z)},onChange:function(t){return this.onChangeCallback=t,this},onChangeCallback:function(){}},it.prototype={constructor:it,set:function(t){this.mask=1<<t},enable:function(t){this.mask|=1<<t},toggle:function(t){this.mask^=1<<t},disable:function(t){this.mask&=~(1<<t)},test:function(t){return 0!==(this.mask&t.mask)}},rt.DefaultUp=new c(0,1,0),rt.DefaultMatrixAutoUpdate=!0,Object.assign(rt.prototype,e.prototype,{isObject3D:!0,applyMatrix:function(t){this.matrix.multiplyMatrices(t,this.matrix),this.matrix.decompose(this.position,this.quaternion,this.scale)},setRotationFromAxisAngle:function(t,e){this.quaternion.setFromAxisAngle(t,e)},setRotationFromEuler:function(t){this.quaternion.setFromEuler(t,!0)},setRotationFromMatrix:function(t){this.quaternion.setFromRotationMatrix(t)},setRotationFromQuaternion:function(t){this.quaternion.copy(t)},rotateOnAxis:function(){var t=new s;return function(e,n){return t.setFromAxisAngle(e,n),this.quaternion.multiply(t),this}}(),rotateX:function(){var t=new c(1,0,0);return function(e){return this.rotateOnAxis(t,e)}}(),rotateY:function(){var t=new c(0,1,0);return function(e){return this.rotateOnAxis(t,e)}}(),rotateZ:function(){var t=new c(0,0,1);return function(e){return this.rotateOnAxis(t,e)}}(),translateOnAxis:function(){var t=new c;return function(e,n){return t.copy(e).applyQuaternion(this.quaternion),this.position.add(t.multiplyScalar(n)),this}}(),translateX:function(){var t=new c(1,0,0);return function(e){return this.translateOnAxis(t,e)}}(),translateY:function(){var t=new c(0,1,0);return function(e){return this.translateOnAxis(t,e)}}(),translateZ:function(){var t=new c(0,0,1);return function(e){return this.translateOnAxis(t,e)}}(),localToWorld:function(t){return t.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var t=new l;return function(e){return e.applyMatrix4(t.getInverse(this.matrixWorld))}}(),lookAt:function(){var t=new l;return function(e){t.lookAt(e,this.position,this.up),this.quaternion.setFromRotationMatrix(t)}}(),add:function(t){if(1<arguments.length){for(var e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,t.dispatchEvent({type:"added"}),this.children.push(t)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)},remove:function(t){if(1<arguments.length)for(var e=0;e<arguments.length;e++)this.remove(arguments[e]);e=this.children.indexOf(t),-1!==e&&(t.parent=null,t.dispatchEvent({type:"removed"}),this.children.splice(e,1))},getObjectById:function(t){return this.getObjectByProperty("id",t)},getObjectByName:function(t){return this.getObjectByProperty("name",t)},getObjectByProperty:function(t,e){if(this[t]===e)return this;for(var n=0,i=this.children.length;n<i;n++){var r=this.children[n].getObjectByProperty(t,e);if(void 0!==r)return r}},getWorldPosition:function(t){return t=t||new c,this.updateMatrixWorld(!0),t.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(){var t=new c,e=new c;return function(n){return n=n||new s,this.updateMatrixWorld(!0),this.matrixWorld.decompose(t,n,e),n}}(),getWorldRotation:function(){var t=new s;return function(e){return e=e||new nt,this.getWorldQuaternion(t),e.setFromQuaternion(t,this.rotation.order,!1)}}(),getWorldScale:function(){var t=new c,e=new s;return function(n){return n=n||new c,this.updateMatrixWorld(!0),this.matrixWorld.decompose(t,e,n),n}}(),getWorldDirection:function(){var t=new s;return function(e){return e=e||new c,this.getWorldQuaternion(t),e.set(0,0,1).applyQuaternion(t)}}(),raycast:function(){},traverse:function(t){t(this);for(var e=this.children,n=0,i=e.length;n<i;n++)e[n].traverse(t)},traverseVisible:function(t){if(!1!==this.visible){t(this);for(var e=this.children,n=0,i=e.length;n<i;n++)e[n].traverseVisible(t)}},traverseAncestors:function(t){var e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(t){!0===this.matrixAutoUpdate&&this.updateMatrix(),!0!==this.matrixWorldNeedsUpdate&&!0!==t||(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);for(var e=this.children,n=0,i=e.length;n<i;n++)e[n].updateMatrixWorld(t)},toJSON:function(t){function e(t){var e,n=[];for(e in t){var i=t[e];delete i.metadata,n.push(i)}return n}var n=void 0===t||""===t,i={};n&&(t={geometries:{},materials:{},textures:{},images:{}},i.metadata={version:4.4,type:"Object",generator:"Object3D.toJSON"});var r={};if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),r.matrix=this.matrix.toArray(),void 0!==this.geometry&&(void 0===t.geometries[this.geometry.uuid]&&(t.geometries[this.geometry.uuid]=this.geometry.toJSON(t)),r.geometry=this.geometry.uuid),void 0!==this.material&&(void 0===t.materials[this.material.uuid]&&(t.materials[this.material.uuid]=this.material.toJSON(t)),r.material=this.material.uuid),0<this.children.length){r.children=[];for(var a=0;a<this.children.length;a++)r.children.push(this.children[a].toJSON(t).object)}if(n){var n=e(t.geometries),a=e(t.materials),o=e(t.textures);t=e(t.images),0<n.length&&(i.geometries=n),0<a.length&&(i.materials=a),0<o.length&&(i.textures=o),0<t.length&&(i.images=t)}return i.object=r,i},clone:function(t){return(new this.constructor).copy(this,t)},copy:function(t,e){if(void 0===e&&(e=!0),this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===e)for(var n=0;n<t.children.length;n++)this.add(t.children[n].clone());return this}});var Zi=0;at.prototype={constructor:at,set:function(t,e){return this.start.copy(t),this.end.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.start.copy(t.start),this.end.copy(t.end),this},getCenter:function(t){return(t||new c).addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(t){return(t||new c).subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(t,e){var n=e||new c;return this.delta(n).multiplyScalar(t).add(this.start)},closestPointToPointParameter:function(){var e=new c,n=new c;return function(i,r){e.subVectors(i,this.start),n.subVectors(this.end,this.start);var a=n.dot(n),a=n.dot(e)/a;return r&&(a=t.Math.clamp(a,0,1)),a}}(),closestPointToPoint:function(t,e,n){return t=this.closestPointToPointParameter(t,e),n=n||new c,this.delta(n).multiplyScalar(t).add(this.start)},applyMatrix4:function(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this},equals:function(t){return t.start.equals(this.start)&&t.end.equals(this.end)}},ot.normal=function(){var t=new c;return function(e,n,i,r){return r=r||new c,r.subVectors(i,n),t.subVectors(e,n),r.cross(t),e=r.lengthSq(),0<e?r.multiplyScalar(1/Math.sqrt(e)):r.set(0,0,0)}}(),ot.barycoordFromPoint=function(){var t=new c,e=new c,n=new c;return function(i,r,a,o,s){t.subVectors(o,r),e.subVectors(a,r),n.subVectors(i,r),i=t.dot(t),r=t.dot(e),a=t.dot(n);var l=e.dot(e);o=e.dot(n);var h=i*l-r*r;return s=s||new c,0===h?s.set(-2,-1,-1):(h=1/h,l=(l*a-r*o)*h,i=(i*o-r*a)*h,s.set(1-l-i,i,l))}}(),ot.containsPoint=function(){var t=new c;return function(e,n,i,r){return e=ot.barycoordFromPoint(e,n,i,r,t),0<=e.x&&0<=e.y&&1>=e.x+e.y}}(),ot.prototype={constructor:ot,set:function(t,e,n){return this.a.copy(t),this.b.copy(e),this.c.copy(n),this},setFromPointsAndIndices:function(t,e,n,i){return this.a.copy(t[e]),this.b.copy(t[n]),this.c.copy(t[i]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this},area:function(){var t=new c,e=new c;return function(){return t.subVectors(this.c,this.b),e.subVectors(this.a,this.b),.5*t.cross(e).length()}}(),midpoint:function(t){return(t||new c).addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},normal:function(t){return ot.normal(this.a,this.b,this.c,t)},plane:function(t){return(t||new K).setFromCoplanarPoints(this.a,this.b,this.c)},barycoordFromPoint:function(t,e){return ot.barycoordFromPoint(t,this.a,this.b,this.c,e)},containsPoint:function(t){return ot.containsPoint(t,this.a,this.b,this.c)},closestPointToPoint:function(){var t,e,n,i;return function(r,a){void 0===t&&(t=new K,e=[new at,new at,new at],n=new c,i=new c);var o=a||new c,s=1/0;if(t.setFromCoplanarPoints(this.a,this.b,this.c),t.projectPoint(r,n),!0===this.containsPoint(n))o.copy(n);else{e[0].set(this.a,this.b),e[1].set(this.b,this.c),e[2].set(this.c,this.a);for(var l=0;l<e.length;l++){e[l].closestPointToPoint(n,!0,i);var h=n.distanceToSquared(i);h<s&&(s=h,o.copy(i))}}return o}}(),equals:function(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}},st.prototype={constructor:st,clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.a=t.a,this.b=t.b,this.c=t.c,this.normal.copy(t.normal),this.color.copy(t.color),this.materialIndex=t.materialIndex;for(var e=0,n=t.vertexNormals.length;e<n;e++)this.vertexNormals[e]=t.vertexNormals[e].clone();for(e=0,n=t.vertexColors.length;e<n;e++)this.vertexColors[e]=t.vertexColors[e].clone();return this}},ct.prototype=Object.create(X.prototype),ct.prototype.constructor=ct,ct.prototype.isMeshBasicMaterial=!0,ct.prototype.copy=function(t){return X.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this},lt.prototype={constructor:lt,isBufferAttribute:!0,set needsUpdate(t){!0===t&&this.version++},setDynamic:function(t){return this.dynamic=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.dynamic=t.dynamic,this},copyAt:function(t,e,n){t*=this.itemSize,n*=e.itemSize;for(var i=0,r=this.itemSize;i<r;i++)this.array[t+i]=e.array[n+i];return this},copyArray:function(t){return this.array.set(t),this},copyColorsArray:function(t){for(var e=this.array,n=0,i=0,r=t.length;i<r;i++){var a=t[i];void 0===a&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",i),a=new k),e[n++]=a.r,e[n++]=a.g,e[n++]=a.b}return this},copyIndicesArray:function(t){for(var e=this.array,n=0,i=0,r=t.length;i<r;i++){
var a=t[i];e[n++]=a.a,e[n++]=a.b,e[n++]=a.c}return this},copyVector2sArray:function(t){for(var e=this.array,i=0,r=0,a=t.length;r<a;r++){var o=t[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",r),o=new n),e[i++]=o.x,e[i++]=o.y}return this},copyVector3sArray:function(t){for(var e=this.array,n=0,i=0,r=t.length;i<r;i++){var a=t[i];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",i),a=new c),e[n++]=a.x,e[n++]=a.y,e[n++]=a.z}return this},copyVector4sArray:function(t){for(var e=this.array,n=0,i=0,a=t.length;i<a;i++){var o=t[i];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",i),o=new r),e[n++]=o.x,e[n++]=o.y,e[n++]=o.z,e[n++]=o.w}return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},getX:function(t){return this.array[t*this.itemSize]},setX:function(t,e){return this.array[t*this.itemSize]=e,this},getY:function(t){return this.array[t*this.itemSize+1]},setY:function(t,e){return this.array[t*this.itemSize+1]=e,this},getZ:function(t){return this.array[t*this.itemSize+2]},setZ:function(t,e){return this.array[t*this.itemSize+2]=e,this},getW:function(t){return this.array[t*this.itemSize+3]},setW:function(t,e){return this.array[t*this.itemSize+3]=e,this},setXY:function(t,e,n){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this},setXYZ:function(t,e,n,i){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=i,this},setXYZW:function(t,e,n,i,r){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=i,this.array[t+3]=r,this},clone:function(){return(new this.constructor).copy(this)}},Object.assign(pt.prototype,e.prototype,{isGeometry:!0,applyMatrix:function(t){for(var e=(new Q).getNormalMatrix(t),n=0,i=this.vertices.length;n<i;n++)this.vertices[n].applyMatrix4(t);for(n=0,i=this.faces.length;n<i;n++){t=this.faces[n],t.normal.applyMatrix3(e).normalize();for(var r=0,a=t.vertexNormals.length;r<a;r++)t.vertexNormals[r].applyMatrix3(e).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.normalsNeedUpdate=this.verticesNeedUpdate=!0,this},rotateX:function(){var t;return function(e){return void 0===t&&(t=new l),t.makeRotationX(e),this.applyMatrix(t),this}}(),rotateY:function(){var t;return function(e){return void 0===t&&(t=new l),t.makeRotationY(e),this.applyMatrix(t),this}}(),rotateZ:function(){var t;return function(e){return void 0===t&&(t=new l),t.makeRotationZ(e),this.applyMatrix(t),this}}(),translate:function(){var t;return function(e,n,i){return void 0===t&&(t=new l),t.makeTranslation(e,n,i),this.applyMatrix(t),this}}(),scale:function(){var t;return function(e,n,i){return void 0===t&&(t=new l),t.makeScale(e,n,i),this.applyMatrix(t),this}}(),lookAt:function(){var t;return function(e){void 0===t&&(t=new rt),t.lookAt(e),t.updateMatrix(),this.applyMatrix(t.matrix)}}(),fromBufferGeometry:function(t){function e(t,e,n,r){var a=void 0!==s?[d[t].clone(),d[e].clone(),d[n].clone()]:[],o=void 0!==l?[i.colors[t].clone(),i.colors[e].clone(),i.colors[n].clone()]:[];r=new st(t,e,n,a,o,r),i.faces.push(r),void 0!==h&&i.faceVertexUvs[0].push([p[t].clone(),p[e].clone(),p[n].clone()]),void 0!==u&&i.faceVertexUvs[1].push([f[t].clone(),f[e].clone(),f[n].clone()])}var i=this,r=null!==t.index?t.index.array:void 0,a=t.attributes,o=a.position.array,s=void 0!==a.normal?a.normal.array:void 0,l=void 0!==a.color?a.color.array:void 0,h=void 0!==a.uv?a.uv.array:void 0,u=void 0!==a.uv2?a.uv2.array:void 0;void 0!==u&&(this.faceVertexUvs[1]=[]);for(var d=[],p=[],f=[],m=a=0;a<o.length;a+=3,m+=2)i.vertices.push(new c(o[a],o[a+1],o[a+2])),void 0!==s&&d.push(new c(s[a],s[a+1],s[a+2])),void 0!==l&&i.colors.push(new k(l[a],l[a+1],l[a+2])),void 0!==h&&p.push(new n(h[m],h[m+1])),void 0!==u&&f.push(new n(u[m],u[m+1]));if(void 0!==r)if(o=t.groups,0<o.length)for(a=0;a<o.length;a++)for(var g=o[a],v=g.start,y=g.count,m=v,v=v+y;m<v;m+=3)e(r[m],r[m+1],r[m+2],g.materialIndex);else for(a=0;a<r.length;a+=3)e(r[a],r[a+1],r[a+2]);else for(a=0;a<o.length/3;a+=3)e(a,a+1,a+2);return this.computeFaceNormals(),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),this},center:function(){this.computeBoundingBox();var t=this.boundingBox.getCenter().negate();return this.translate(t.x,t.y,t.z),t},normalize:function(){this.computeBoundingSphere();var t=this.boundingSphere.center,e=this.boundingSphere.radius,e=0===e?1:1/e,n=new l;return n.set(e,0,0,-e*t.x,0,e,0,-e*t.y,0,0,e,-e*t.z,0,0,0,1),this.applyMatrix(n),this},computeFaceNormals:function(){for(var t=new c,e=new c,n=0,i=this.faces.length;n<i;n++){var r=this.faces[n],a=this.vertices[r.a],o=this.vertices[r.b];t.subVectors(this.vertices[r.c],o),e.subVectors(a,o),t.cross(e),t.normalize(),r.normal.copy(t)}},computeVertexNormals:function(t){void 0===t&&(t=!0);var e,n,i;for(i=Array(this.vertices.length),e=0,n=this.vertices.length;e<n;e++)i[e]=new c;if(t){var r,a,o,s=new c,l=new c;for(t=0,e=this.faces.length;t<e;t++)n=this.faces[t],r=this.vertices[n.a],a=this.vertices[n.b],o=this.vertices[n.c],s.subVectors(o,a),l.subVectors(r,a),s.cross(l),i[n.a].add(s),i[n.b].add(s),i[n.c].add(s)}else for(t=0,e=this.faces.length;t<e;t++)n=this.faces[t],i[n.a].add(n.normal),i[n.b].add(n.normal),i[n.c].add(n.normal);for(e=0,n=this.vertices.length;e<n;e++)i[e].normalize();for(t=0,e=this.faces.length;t<e;t++)n=this.faces[t],r=n.vertexNormals,3===r.length?(r[0].copy(i[n.a]),r[1].copy(i[n.b]),r[2].copy(i[n.c])):(r[0]=i[n.a].clone(),r[1]=i[n.b].clone(),r[2]=i[n.c].clone());0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var t,e,n,i,r;for(n=0,i=this.faces.length;n<i;n++)for(r=this.faces[n],r.__originalFaceNormal?r.__originalFaceNormal.copy(r.normal):r.__originalFaceNormal=r.normal.clone(),r.__originalVertexNormals||(r.__originalVertexNormals=[]),t=0,e=r.vertexNormals.length;t<e;t++)r.__originalVertexNormals[t]?r.__originalVertexNormals[t].copy(r.vertexNormals[t]):r.__originalVertexNormals[t]=r.vertexNormals[t].clone();var a=new pt;for(a.faces=this.faces,t=0,e=this.morphTargets.length;t<e;t++){if(!this.morphNormals[t]){this.morphNormals[t]={},this.morphNormals[t].faceNormals=[],this.morphNormals[t].vertexNormals=[],r=this.morphNormals[t].faceNormals;var o,s,l=this.morphNormals[t].vertexNormals;for(n=0,i=this.faces.length;n<i;n++)o=new c,s={a:new c,b:new c,c:new c},r.push(o),l.push(s)}for(l=this.morphNormals[t],a.vertices=this.morphTargets[t].vertices,a.computeFaceNormals(),a.computeVertexNormals(),n=0,i=this.faces.length;n<i;n++)r=this.faces[n],o=l.faceNormals[n],s=l.vertexNormals[n],o.copy(r.normal),s.a.copy(r.vertexNormals[0]),s.b.copy(r.vertexNormals[1]),s.c.copy(r.vertexNormals[2])}for(n=0,i=this.faces.length;n<i;n++)r=this.faces[n],r.normal=r.__originalFaceNormal,r.vertexNormals=r.__originalVertexNormals},computeTangents:function(){console.warn("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){for(var t=0,e=this.vertices,n=0,i=e.length;n<i;n++)0<n&&(t+=e[n].distanceTo(e[n-1])),this.lineDistances[n]=t},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new Z),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new J),this.boundingSphere.setFromPoints(this.vertices)},merge:function(t,e,n){if(!1===(t&&t.isGeometry))console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",t);else{var i,r=this.vertices.length,a=this.vertices,o=t.vertices,s=this.faces,c=t.faces,l=this.faceVertexUvs[0],h=t.faceVertexUvs[0],u=this.colors,d=t.colors;void 0===n&&(n=0),void 0!==e&&(i=(new Q).getNormalMatrix(e)),t=0;for(var p=o.length;t<p;t++){var f=o[t].clone();void 0!==e&&f.applyMatrix4(e),a.push(f)}for(t=0,p=d.length;t<p;t++)u.push(d[t].clone());for(t=0,p=c.length;t<p;t++){var o=c[t],m=o.vertexNormals,d=o.vertexColors,u=new st(o.a+r,o.b+r,o.c+r);for(u.normal.copy(o.normal),void 0!==i&&u.normal.applyMatrix3(i).normalize(),e=0,a=m.length;e<a;e++)f=m[e].clone(),void 0!==i&&f.applyMatrix3(i).normalize(),u.vertexNormals.push(f);for(u.color.copy(o.color),e=0,a=d.length;e<a;e++)f=d[e],u.vertexColors.push(f.clone());u.materialIndex=o.materialIndex+n,s.push(u)}for(t=0,p=h.length;t<p;t++)if(n=h[t],i=[],void 0!==n){for(e=0,a=n.length;e<a;e++)i.push(n[e].clone());l.push(i)}}},mergeMesh:function(t){!1===(t&&t.isMesh)?console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",t):(t.matrixAutoUpdate&&t.updateMatrix(),this.merge(t.geometry,t.matrix))},mergeVertices:function(){var t,e,n,i={},r=[],a=[],o=Math.pow(10,4);for(e=0,n=this.vertices.length;e<n;e++)t=this.vertices[e],t=Math.round(t.x*o)+"_"+Math.round(t.y*o)+"_"+Math.round(t.z*o),void 0===i[t]?(i[t]=e,r.push(this.vertices[e]),a[e]=r.length-1):a[e]=a[i[t]];for(i=[],e=0,n=this.faces.length;e<n;e++)for(o=this.faces[e],o.a=a[o.a],o.b=a[o.b],o.c=a[o.c],o=[o.a,o.b,o.c],t=0;3>t;t++)if(o[t]===o[(t+1)%3]){i.push(e);break}for(e=i.length-1;0<=e;e--)for(o=i[e],this.faces.splice(o,1),a=0,n=this.faceVertexUvs.length;a<n;a++)this.faceVertexUvs[a].splice(o,1);return e=this.vertices.length-r.length,this.vertices=r,e},sortFacesByMaterialIndex:function(){for(var t=this.faces,e=t.length,n=0;n<e;n++)t[n]._id=n;t.sort(function(t,e){return t.materialIndex-e.materialIndex});var i,r,a=this.faceVertexUvs[0],o=this.faceVertexUvs[1];for(a&&a.length===e&&(i=[]),o&&o.length===e&&(r=[]),n=0;n<e;n++){var s=t[n]._id;i&&i.push(a[s]),r&&r.push(o[s])}i&&(this.faceVertexUvs[0]=i),r&&(this.faceVertexUvs[1]=r)},toJSON:function(){function t(t,e,n){return n?t|1<<e:t&~(1<<e)}function e(t){var e=t.x.toString()+t.y.toString()+t.z.toString();return void 0!==l[e]?l[e]:(l[e]=c.length/3,c.push(t.x,t.y,t.z),l[e])}function n(t){var e=t.r.toString()+t.g.toString()+t.b.toString();return void 0!==u[e]?u[e]:(u[e]=h.length,h.push(t.getHex()),u[e])}function i(t){var e=t.x.toString()+t.y.toString();return void 0!==p[e]?p[e]:(p[e]=d.length/2,d.push(t.x,t.y),p[e])}var r={metadata:{version:4.4,type:"Geometry",generator:"Geometry.toJSON"}};if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),void 0!==this.parameters){var a,o=this.parameters;for(a in o)void 0!==o[a]&&(r[a]=o[a]);return r}for(o=[],a=0;a<this.vertices.length;a++){var s=this.vertices[a];o.push(s.x,s.y,s.z)}var s=[],c=[],l={},h=[],u={},d=[],p={};for(a=0;a<this.faces.length;a++){var f=this.faces[a],m=void 0!==this.faceVertexUvs[0][a],g=0<f.normal.length(),v=0<f.vertexNormals.length,y=1!==f.color.r||1!==f.color.g||1!==f.color.b,x=0<f.vertexColors.length,b=0,b=t(b,0,0),b=t(b,1,!0),b=t(b,2,!1),b=t(b,3,m),b=t(b,4,g),b=t(b,5,v),b=t(b,6,y),b=t(b,7,x);s.push(b),s.push(f.a,f.b,f.c),s.push(f.materialIndex),m&&(m=this.faceVertexUvs[0][a],s.push(i(m[0]),i(m[1]),i(m[2]))),g&&s.push(e(f.normal)),v&&(g=f.vertexNormals,s.push(e(g[0]),e(g[1]),e(g[2]))),y&&s.push(n(f.color)),x&&(f=f.vertexColors,s.push(n(f[0]),n(f[1]),n(f[2])))}return r.data={},r.data.vertices=o,r.data.normals=c,0<h.length&&(r.data.colors=h),0<d.length&&(r.data.uvs=[d]),r.data.faces=s,r},clone:function(){return(new pt).copy(this)},copy:function(t){this.vertices=[],this.faces=[],this.faceVertexUvs=[[]],this.colors=[];for(var e=t.vertices,n=0,i=e.length;n<i;n++)this.vertices.push(e[n].clone());for(e=t.colors,n=0,i=e.length;n<i;n++)this.colors.push(e[n].clone());for(e=t.faces,n=0,i=e.length;n<i;n++)this.faces.push(e[n].clone());for(n=0,i=t.faceVertexUvs.length;n<i;n++){e=t.faceVertexUvs[n],void 0===this.faceVertexUvs[n]&&(this.faceVertexUvs[n]=[]);for(var r=0,a=e.length;r<a;r++){for(var o=e[r],s=[],c=0,l=o.length;c<l;c++)s.push(o[c].clone());this.faceVertexUvs[n].push(s)}}return this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var Ji=0;Object.assign(ft.prototype,e.prototype,{computeBoundingBox:pt.prototype.computeBoundingBox,computeBoundingSphere:pt.prototype.computeBoundingSphere,computeFaceNormals:function(){console.warn("THREE.DirectGeometry: computeFaceNormals() is not a method of this type of geometry.")},computeVertexNormals:function(){console.warn("THREE.DirectGeometry: computeVertexNormals() is not a method of this type of geometry.")},computeGroups:function(t){var e,n,i=[];t=t.faces;for(var r=0;r<t.length;r++){var a=t[r];a.materialIndex!==n&&(n=a.materialIndex,void 0!==e&&(e.count=3*r-e.start,i.push(e)),e={start:3*r,materialIndex:n})}void 0!==e&&(e.count=3*r-e.start,i.push(e)),this.groups=i},fromGeometry:function(t){var e,i=t.faces,r=t.vertices,a=t.faceVertexUvs,o=a[0]&&0<a[0].length,s=a[1]&&0<a[1].length,c=t.morphTargets,l=c.length;if(0<l){e=[];for(var h=0;h<l;h++)e[h]=[];this.morphTargets.position=e}var u,d=t.morphNormals,p=d.length;if(0<p){for(u=[],h=0;h<p;h++)u[h]=[];this.morphTargets.normal=u}for(var f=t.skinIndices,m=t.skinWeights,g=f.length===r.length,v=m.length===r.length,h=0;h<i.length;h++){var y=i[h];this.vertices.push(r[y.a],r[y.b],r[y.c]);var x=y.vertexNormals;for(3===x.length?this.normals.push(x[0],x[1],x[2]):(x=y.normal,this.normals.push(x,x,x)),x=y.vertexColors,3===x.length?this.colors.push(x[0],x[1],x[2]):(x=y.color,this.colors.push(x,x,x)),!0===o&&(x=a[0][h],void 0!==x?this.uvs.push(x[0],x[1],x[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",h),this.uvs.push(new n,new n,new n))),!0===s&&(x=a[1][h],void 0!==x?this.uvs2.push(x[0],x[1],x[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",h),this.uvs2.push(new n,new n,new n))),x=0;x<l;x++){var b=c[x].vertices;e[x].push(b[y.a],b[y.b],b[y.c])}for(x=0;x<p;x++)b=d[x].vertexNormals[h],u[x].push(b.a,b.b,b.c);g&&this.skinIndices.push(f[y.a],f[y.b],f[y.c]),v&&this.skinWeights.push(m[y.a],m[y.b],m[y.c])}return this.computeGroups(t),this.verticesNeedUpdate=t.verticesNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.assign(mt.prototype,e.prototype,{isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(t){this.index=t},addAttribute:function(t,e,n){if(!1===(e&&e.isBufferAttribute)&&!1===(e&&e.isInterleavedBufferAttribute))console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.addAttribute(t,new lt(e,n));else{if("index"!==t)return this.attributes[t]=e,this;console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(e)}},getAttribute:function(t){return this.attributes[t]},removeAttribute:function(t){return delete this.attributes[t],this},addGroup:function(t,e,n){this.groups.push({start:t,count:e,materialIndex:void 0!==n?n:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(t,e){this.drawRange.start=t,this.drawRange.count=e},applyMatrix:function(t){var e=this.attributes.position;return void 0!==e&&(t.applyToVector3Array(e.array),e.needsUpdate=!0),e=this.attributes.normal,void 0!==e&&((new Q).getNormalMatrix(t).applyToVector3Array(e.array),e.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(){var t;return function(e){return void 0===t&&(t=new l),t.makeRotationX(e),this.applyMatrix(t),this}}(),rotateY:function(){var t;return function(e){return void 0===t&&(t=new l),t.makeRotationY(e),this.applyMatrix(t),this}}(),rotateZ:function(){var t;return function(e){return void 0===t&&(t=new l),t.makeRotationZ(e),this.applyMatrix(t),this}}(),translate:function(){var t;return function(e,n,i){return void 0===t&&(t=new l),t.makeTranslation(e,n,i),this.applyMatrix(t),this}}(),scale:function(){var t;return function(e,n,i){return void 0===t&&(t=new l),t.makeScale(e,n,i),this.applyMatrix(t),this}}(),lookAt:function(){var t;return function(e){void 0===t&&(t=new rt),t.lookAt(e),t.updateMatrix(),this.applyMatrix(t.matrix)}}(),center:function(){this.computeBoundingBox();var t=this.boundingBox.getCenter().negate();return this.translate(t.x,t.y,t.z),t},setFromObject:function(t){var e=t.geometry;if(t&&t.isPoints||t&&t.isLine){t=new dt(3*e.vertices.length,3);var n=new dt(3*e.colors.length,3);this.addAttribute("position",t.copyVector3sArray(e.vertices)),this.addAttribute("color",n.copyColorsArray(e.colors)),e.lineDistances&&e.lineDistances.length===e.vertices.length&&(t=new dt(e.lineDistances.length,1),this.addAttribute("lineDistance",t.copyArray(e.lineDistances))),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone())}else t&&t.isMesh&&e&&e.isGeometry&&this.fromGeometry(e);return this},updateFromObject:function(t){var e=t.geometry;if(t&&t.isMesh){var n=e.__directGeometry;if(!0===e.elementsNeedUpdate&&(n=void 0,e.elementsNeedUpdate=!1),void 0===n)return this.fromGeometry(e);n.verticesNeedUpdate=e.verticesNeedUpdate,n.normalsNeedUpdate=e.normalsNeedUpdate,n.colorsNeedUpdate=e.colorsNeedUpdate,n.uvsNeedUpdate=e.uvsNeedUpdate,n.groupsNeedUpdate=e.groupsNeedUpdate,e.verticesNeedUpdate=!1,e.normalsNeedUpdate=!1,e.colorsNeedUpdate=!1,e.uvsNeedUpdate=!1,e.groupsNeedUpdate=!1,e=n}return!0===e.verticesNeedUpdate&&(n=this.attributes.position,void 0!==n&&(n.copyVector3sArray(e.vertices),n.needsUpdate=!0),e.verticesNeedUpdate=!1),!0===e.normalsNeedUpdate&&(n=this.attributes.normal,void 0!==n&&(n.copyVector3sArray(e.normals),n.needsUpdate=!0),e.normalsNeedUpdate=!1),!0===e.colorsNeedUpdate&&(n=this.attributes.color,void 0!==n&&(n.copyColorsArray(e.colors),n.needsUpdate=!0),e.colorsNeedUpdate=!1),e.uvsNeedUpdate&&(n=this.attributes.uv,void 0!==n&&(n.copyVector2sArray(e.uvs),n.needsUpdate=!0),e.uvsNeedUpdate=!1),e.lineDistancesNeedUpdate&&(n=this.attributes.lineDistance,void 0!==n&&(n.copyArray(e.lineDistances),n.needsUpdate=!0),e.lineDistancesNeedUpdate=!1),e.groupsNeedUpdate&&(e.computeGroups(t.geometry),this.groups=e.groups,e.groupsNeedUpdate=!1),this},fromGeometry:function(t){return t.__directGeometry=(new ft).fromGeometry(t),this.fromDirectGeometry(t.__directGeometry)},fromDirectGeometry:function(t){var e=new Float32Array(3*t.vertices.length);this.addAttribute("position",new lt(e,3).copyVector3sArray(t.vertices)),0<t.normals.length&&(e=new Float32Array(3*t.normals.length),this.addAttribute("normal",new lt(e,3).copyVector3sArray(t.normals))),0<t.colors.length&&(e=new Float32Array(3*t.colors.length),this.addAttribute("color",new lt(e,3).copyColorsArray(t.colors))),0<t.uvs.length&&(e=new Float32Array(2*t.uvs.length),this.addAttribute("uv",new lt(e,2).copyVector2sArray(t.uvs))),0<t.uvs2.length&&(e=new Float32Array(2*t.uvs2.length),this.addAttribute("uv2",new lt(e,2).copyVector2sArray(t.uvs2))),0<t.indices.length&&(e=new(65535<t.vertices.length?Uint32Array:Uint16Array)(3*t.indices.length),this.setIndex(new lt(e,1).copyIndicesArray(t.indices))),this.groups=t.groups;for(var n in t.morphTargets){for(var e=[],i=t.morphTargets[n],r=0,a=i.length;r<a;r++){var o=i[r],s=new dt(3*o.length,3);e.push(s.copyVector3sArray(o))}this.morphAttributes[n]=e}return 0<t.skinIndices.length&&(n=new dt(4*t.skinIndices.length,4),this.addAttribute("skinIndex",n.copyVector4sArray(t.skinIndices))),0<t.skinWeights.length&&(n=new dt(4*t.skinWeights.length,4),this.addAttribute("skinWeight",n.copyVector4sArray(t.skinWeights))),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new Z);var t=this.attributes.position.array;void 0!==t?this.boundingBox.setFromArray(t):this.boundingBox.makeEmpty(),(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){var t=new Z,e=new c;return function(){null===this.boundingSphere&&(this.boundingSphere=new J);var n=this.attributes.position;if(n){var n=n.array,i=this.boundingSphere.center;t.setFromArray(n),t.getCenter(i);for(var r=0,a=0,o=n.length;a<o;a+=3)e.fromArray(n,a),r=Math.max(r,i.distanceToSquared(e));this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}}(),computeFaceNormals:function(){},computeVertexNormals:function(){var t=this.index,e=this.attributes,n=this.groups;if(e.position){var i=e.position.array;if(void 0===e.normal)this.addAttribute("normal",new lt(new Float32Array(i.length),3));else for(var r=e.normal.array,a=0,o=r.length;a<o;a++)r[a]=0;var s,l,h,r=e.normal.array,u=new c,d=new c,p=new c,f=new c,m=new c;if(t){t=t.array,0===n.length&&this.addGroup(0,t.length);for(var g=0,v=n.length;g<v;++g)for(a=n[g],o=a.start,s=a.count,a=o,o+=s;a<o;a+=3)s=3*t[a+0],l=3*t[a+1],h=3*t[a+2],u.fromArray(i,s),d.fromArray(i,l),p.fromArray(i,h),f.subVectors(p,d),m.subVectors(u,d),f.cross(m),r[s]+=f.x,r[s+1]+=f.y,r[s+2]+=f.z,r[l]+=f.x,r[l+1]+=f.y,r[l+2]+=f.z,r[h]+=f.x,r[h+1]+=f.y,r[h+2]+=f.z}else for(a=0,o=i.length;a<o;a+=9)u.fromArray(i,a),d.fromArray(i,a+3),p.fromArray(i,a+6),f.subVectors(p,d),m.subVectors(u,d),f.cross(m),r[a]=f.x,r[a+1]=f.y,r[a+2]=f.z,r[a+3]=f.x,r[a+4]=f.y,r[a+5]=f.z,r[a+6]=f.x,r[a+7]=f.y,r[a+8]=f.z;this.normalizeNormals(),e.normal.needsUpdate=!0}},merge:function(t,e){if(!1!==(t&&t.isBufferGeometry)){void 0===e&&(e=0);var n,i=this.attributes;for(n in i)if(void 0!==t.attributes[n])for(var r=i[n].array,a=t.attributes[n],o=a.array,s=0,a=a.itemSize*e;s<o.length;s++,a++)r[a]=o[s];return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t)},normalizeNormals:function(){for(var t,e,n,i=this.attributes.normal.array,r=0,a=i.length;r<a;r+=3)t=i[r],e=i[r+1],n=i[r+2],t=1/Math.sqrt(t*t+e*e+n*n),i[r]*=t,i[r+1]*=t,i[r+2]*=t},toNonIndexed:function(){if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var t,e=new mt,n=this.index.array,i=this.attributes;for(t in i){for(var r,a=i[t],o=a.array,a=a.itemSize,s=new o.constructor(n.length*a),c=0,l=0,h=n.length;l<h;l++){r=n[l]*a;for(var u=0;u<a;u++)s[c++]=o[r++]}e.addAttribute(t,new lt(s,a))}return e},toJSON:function(){var t={metadata:{version:4.4,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),void 0!==this.parameters){var e,n=this.parameters;for(e in n)void 0!==n[e]&&(t[e]=n[e]);return t}t.data={attributes:{}};var i=this.index;null!==i&&(n=Array.prototype.slice.call(i.array),t.data.index={type:i.array.constructor.name,array:n}),i=this.attributes;for(e in i){var r=i[e],n=Array.prototype.slice.call(r.array);t.data.attributes[e]={itemSize:r.itemSize,type:r.array.constructor.name,array:n,normalized:r.normalized}}return e=this.groups,0<e.length&&(t.data.groups=JSON.parse(JSON.stringify(e))),e=this.boundingSphere,null!==e&&(t.data.boundingSphere={center:e.center.toArray(),radius:e.radius}),t},clone:function(){return(new mt).copy(this)},copy:function(t){var e=t.index;null!==e&&this.setIndex(e.clone());var n,e=t.attributes;for(n in e)this.addAttribute(n,e[n].clone());for(t=t.groups,n=0,e=t.length;n<e;n++){var i=t[n];this.addGroup(i.start,i.count,i.materialIndex)}return this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),mt.MaxIndex=65535,gt.prototype=Object.assign(Object.create(rt.prototype),{constructor:gt,isMesh:!0,setDrawMode:function(t){this.drawMode=t},copy:function(t){return rt.prototype.copy.call(this,t),this.drawMode=t.drawMode,this},updateMorphTargets:function(){var t=this.geometry.morphTargets;if(void 0!==t&&0<t.length){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var e=0,n=t.length;e<n;e++)this.morphTargetInfluences.push(0),this.morphTargetDictionary[t[e].name]=e}},raycast:function(){function t(t,e,n,i,r,a,o){return ot.barycoordFromPoint(t,e,n,i,y),r.multiplyScalar(y.x),a.multiplyScalar(y.y),o.multiplyScalar(y.z),r.add(a).add(o),r.clone()}function e(t,e,n,i,r,a,o){var s=t.material;return null===(1===s.side?n.intersectTriangle(a,r,i,!0,o):n.intersectTriangle(i,r,a,2!==s.side,o))?null:(b.copy(o),b.applyMatrix4(t.matrixWorld),n=e.ray.origin.distanceTo(b),n<e.near||n>e.far?null:{distance:n,point:b.clone(),object:t})}function i(n,i,r,a,o,c,l,d){return s.fromArray(a,3*c),h.fromArray(a,3*l),u.fromArray(a,3*d),(n=e(n,i,r,s,h,u,x))&&(o&&(m.fromArray(o,2*c),g.fromArray(o,2*l),v.fromArray(o,2*d),n.uv=t(x,s,h,u,m,g,v)),n.face=new st(c,l,d,ot.normal(s,h,u)),n.faceIndex=c),n}var r=new l,a=new et,o=new J,s=new c,h=new c,u=new c,d=new c,p=new c,f=new c,m=new n,g=new n,v=new n,y=new c,x=new c,b=new c;return function(n,c){var l=this.geometry,y=this.material,b=this.matrixWorld;if(void 0!==y&&(null===l.boundingSphere&&l.computeBoundingSphere(),o.copy(l.boundingSphere),o.applyMatrix4(b),!1!==n.ray.intersectsSphere(o)&&(r.getInverse(b),a.copy(n.ray).applyMatrix4(r),null===l.boundingBox||!1!==a.intersectsBox(l.boundingBox)))){var w,_;if(l&&l.isBufferGeometry){var M,E,y=l.index,b=l.attributes,l=b.position.array;if(void 0!==b.uv&&(w=b.uv.array),null!==y)for(var b=y.array,T=0,S=b.length;T<S;T+=3)y=b[T],M=b[T+1],E=b[T+2],(_=i(this,n,a,l,w,y,M,E))&&(_.faceIndex=Math.floor(T/3),c.push(_));else for(T=0,S=l.length;T<S;T+=9)y=T/3,M=y+1,E=y+2,(_=i(this,n,a,l,w,y,M,E))&&(_.index=y,c.push(_))}else if(l&&l.isGeometry){var A,R,b=y&&y.isMultiMaterial,T=!0===b?y.materials:null,S=l.vertices;M=l.faces,E=l.faceVertexUvs[0],0<E.length&&(w=E);for(var L=0,C=M.length;L<C;L++){var P=M[L];if(_=!0===b?T[P.materialIndex]:y,void 0!==_){if(E=S[P.a],A=S[P.b],R=S[P.c],!0===_.morphTargets){_=l.morphTargets;var I=this.morphTargetInfluences;s.set(0,0,0),h.set(0,0,0),u.set(0,0,0);for(var U=0,N=_.length;U<N;U++){var D=I[U];if(0!==D){var F=_[U].vertices;s.addScaledVector(d.subVectors(F[P.a],E),D),h.addScaledVector(p.subVectors(F[P.b],A),D),u.addScaledVector(f.subVectors(F[P.c],R),D)}}s.add(E),h.add(A),u.add(R),E=s,A=h,R=u}(_=e(this,n,a,E,A,R,x))&&(w&&(I=w[L],m.copy(I[0]),g.copy(I[1]),v.copy(I[2]),_.uv=t(x,E,A,R,m,g,v)),_.face=P,_.faceIndex=L,c.push(_))}}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),vt.prototype=Object.create(mt.prototype),vt.prototype.constructor=vt,yt.prototype=Object.create(mt.prototype),yt.prototype.constructor=yt,xt.prototype=Object.create(rt.prototype),xt.prototype.constructor=xt,xt.prototype.isCamera=!0,xt.prototype.getWorldDirection=function(){var t=new s;return function(e){return e=e||new c,this.getWorldQuaternion(t),e.set(0,0,-1).applyQuaternion(t)}}(),xt.prototype.lookAt=function(){var t=new l;return function(e){t.lookAt(this.position,e,this.up),this.quaternion.setFromRotationMatrix(t)}}(),xt.prototype.clone=function(){return(new this.constructor).copy(this)},xt.prototype.copy=function(t){return rt.prototype.copy.call(this,t),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this},bt.prototype=Object.assign(Object.create(xt.prototype),{constructor:bt,isPerspectiveCamera:!0,copy:function(t){return xt.prototype.copy.call(this,t),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=null===t.view?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this},setFocalLength:function(e){e=.5*this.getFilmHeight()/e,this.fov=2*t.Math.RAD2DEG*Math.atan(e),this.updateProjectionMatrix()},getFocalLength:function(){var e=Math.tan(.5*t.Math.DEG2RAD*this.fov);return.5*this.getFilmHeight()/e},getEffectiveFOV:function(){return 2*t.Math.RAD2DEG*Math.atan(Math.tan(.5*t.Math.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(t,e,n,i,r,a){this.aspect=t/e,this.view={fullWidth:t,fullHeight:e,offsetX:n,offsetY:i,width:r,height:a},this.updateProjectionMatrix()},clearViewOffset:function(){this.view=null,this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=this.near,n=e*Math.tan(.5*t.Math.DEG2RAD*this.fov)/this.zoom,i=2*n,r=this.aspect*i,a=-.5*r,o=this.view;if(null!==o)var s=o.fullWidth,c=o.fullHeight,a=a+o.offsetX*r/s,n=n-o.offsetY*i/c,r=o.width/s*r,i=o.height/c*i;o=this.filmOffset,0!==o&&(a+=e*o/this.getFilmWidth()),this.projectionMatrix.makeFrustum(a,a+r,n-i,n,e,this.far)},toJSON:function(t){return t=rt.prototype.toJSON.call(this,t),t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}),wt.prototype=Object.assign(Object.create(xt.prototype),{constructor:wt,isOrthographicCamera:!0,copy:function(t){return xt.prototype.copy.call(this,t),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=null===t.view?null:Object.assign({},t.view),this},setViewOffset:function(t,e,n,i,r,a){this.view={fullWidth:t,fullHeight:e,offsetX:n,offsetY:i,width:r,height:a},this.updateProjectionMatrix()},clearViewOffset:function(){this.view=null,this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,i=(this.top+this.bottom)/2,r=n-t,n=n+t,t=i+e,e=i-e;if(null!==this.view)var n=this.zoom/(this.view.width/this.view.fullWidth),e=this.zoom/(this.view.height/this.view.fullHeight),a=(this.right-this.left)/this.view.width,i=(this.top-this.bottom)/this.view.height,r=r+this.view.offsetX/n*a,n=r+this.view.width/n*a,t=t-this.view.offsetY/e*i,e=t-this.view.height/e*i;this.projectionMatrix.makeOrthographic(r,n,t,e,this.near,this.far)},toJSON:function(t){return t=rt.prototype.toJSON.call(this,t),t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}});var Qi=0;Yt.prototype.isFogExp2=!0,Yt.prototype.clone=function(){return new Yt(this.color.getHex(),this.density)},Yt.prototype.toJSON=function(t){return{type:"FogExp2",color:this.color.getHex(),density:this.density}},Zt.prototype.isFog=!0,Zt.prototype.clone=function(){return new Zt(this.color.getHex(),this.near,this.far)},Zt.prototype.toJSON=function(t){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}},Jt.prototype=Object.create(rt.prototype),Jt.prototype.constructor=Jt,Jt.prototype.copy=function(t,e){return rt.prototype.copy.call(this,t,e),null!==t.background&&(this.background=t.background.clone()),null!==t.fog&&(this.fog=t.fog.clone()),null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this},Jt.prototype.toJSON=function(t){var e=rt.prototype.toJSON.call(this,t);return null!==this.background&&(e.object.background=this.background.toJSON(t)),null!==this.fog&&(e.object.fog=this.fog.toJSON()),e},Qt.prototype=Object.assign(Object.create(rt.prototype),{constructor:Qt,isLensFlare:!0,copy:function(t){rt.prototype.copy.call(this,t),this.positionScreen.copy(t.positionScreen),this.customUpdateCallback=t.customUpdateCallback;for(var e=0,n=t.lensFlares.length;e<n;e++)this.lensFlares.push(t.lensFlares[e]);return this},add:function(t,e,n,i,r,a){void 0===e&&(e=-1),void 0===n&&(n=0),void 0===a&&(a=1),void 0===r&&(r=new k(16777215)),void 0===i&&(i=1),n=Math.min(n,Math.max(0,n)),this.lensFlares.push({texture:t,size:e,distance:n,
x:0,y:0,z:0,scale:1,rotation:0,opacity:a,color:r,blending:i})},updateLensFlares:function(){var t,e,n=this.lensFlares.length,i=2*-this.positionScreen.x,r=2*-this.positionScreen.y;for(t=0;t<n;t++)e=this.lensFlares[t],e.x=this.positionScreen.x+i*e.distance,e.y=this.positionScreen.y+r*e.distance,e.wantedRotation=e.x*Math.PI*.25,e.rotation+=.25*(e.wantedRotation-e.rotation)}}),Kt.prototype=Object.create(X.prototype),Kt.prototype.constructor=Kt,Kt.prototype.copy=function(t){return X.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.rotation=t.rotation,this},$t.prototype=Object.assign(Object.create(rt.prototype),{constructor:$t,isSprite:!0,raycast:function(){var t=new c;return function(e,n){t.setFromMatrixPosition(this.matrixWorld);var i=e.ray.distanceSqToPoint(t);i>this.scale.x*this.scale.y/4||n.push({distance:Math.sqrt(i),point:this.position,face:null,object:this})}}(),clone:function(){return new this.constructor(this.material).copy(this)}}),te.prototype=Object.assign(Object.create(rt.prototype),{constructor:te,copy:function(t){rt.prototype.copy.call(this,t,!1),t=t.levels;for(var e=0,n=t.length;e<n;e++){var i=t[e];this.addLevel(i.object.clone(),i.distance)}return this},addLevel:function(t,e){void 0===e&&(e=0),e=Math.abs(e);for(var n=this.levels,i=0;i<n.length&&!(e<n[i].distance);i++);n.splice(i,0,{distance:e,object:t}),this.add(t)},getObjectForDistance:function(t){for(var e=this.levels,n=1,i=e.length;n<i&&!(t<e[n].distance);n++);return e[n-1].object},raycast:function(){var t=new c;return function(e,n){t.setFromMatrixPosition(this.matrixWorld);var i=e.ray.origin.distanceTo(t);this.getObjectForDistance(i).raycast(e,n)}}(),update:function(){var t=new c,e=new c;return function(n){var i=this.levels;if(1<i.length){t.setFromMatrixPosition(n.matrixWorld),e.setFromMatrixPosition(this.matrixWorld),n=t.distanceTo(e),i[0].object.visible=!0;for(var r=1,a=i.length;r<a&&n>=i[r].distance;r++)i[r-1].object.visible=!1,i[r].object.visible=!0;for(;r<a;r++)i[r].object.visible=!1}}}(),toJSON:function(t){t=rt.prototype.toJSON.call(this,t),t.object.levels=[];for(var e=this.levels,n=0,i=e.length;n<i;n++){var r=e[n];t.object.levels.push({object:r.object.uuid,distance:r.distance})}return t}}),ee.prototype=Object.create(i.prototype),ee.prototype.constructor=ee,ee.prototype.isDataTexture=!0,Object.assign(ne.prototype,{calculateInverses:function(){this.boneInverses=[];for(var t=0,e=this.bones.length;t<e;t++){var n=new l;this.bones[t]&&n.getInverse(this.bones[t].matrixWorld),this.boneInverses.push(n)}},pose:function(){for(var t,e=0,n=this.bones.length;e<n;e++)(t=this.bones[e])&&t.matrixWorld.getInverse(this.boneInverses[e]);for(e=0,n=this.bones.length;e<n;e++)(t=this.bones[e])&&(t.parent&&t.parent.isBone?(t.matrix.getInverse(t.parent.matrixWorld),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))},update:function(){var t=new l;return function(){for(var e=0,n=this.bones.length;e<n;e++)t.multiplyMatrices(this.bones[e]?this.bones[e].matrixWorld:this.identityMatrix,this.boneInverses[e]),t.toArray(this.boneMatrices,16*e);this.useVertexTexture&&(this.boneTexture.needsUpdate=!0)}}(),clone:function(){return new ne(this.bones,this.boneInverses,this.useVertexTexture)}}),ie.prototype=Object.assign(Object.create(rt.prototype),{constructor:ie,isBone:!0,copy:function(t){return rt.prototype.copy.call(this,t),this.skin=t.skin,this}}),re.prototype=Object.assign(Object.create(gt.prototype),{constructor:re,isSkinnedMesh:!0,bind:function(t,e){this.skeleton=t,void 0===e&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.getInverse(e)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){if(this.geometry&&this.geometry.isGeometry)for(var t=0;t<this.geometry.skinWeights.length;t++){var e=this.geometry.skinWeights[t],n=1/e.lengthManhattan();1/0!==n?e.multiplyScalar(n):e.set(1,0,0,0)}else if(this.geometry&&this.geometry.isBufferGeometry)for(var e=new r,i=this.geometry.attributes.skinWeight,t=0;t<i.count;t++)e.x=i.getX(t),e.y=i.getY(t),e.z=i.getZ(t),e.w=i.getW(t),n=1/e.lengthManhattan(),1/0!==n?e.multiplyScalar(n):e.set(1,0,0,0),i.setXYZW(t,e.x,e.y,e.z,e.w)},updateMatrixWorld:function(t){gt.prototype.updateMatrixWorld.call(this,!0),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh unrecognized bindMode: "+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material,this.skeleton.useVertexTexture).copy(this)}}),ae.prototype=Object.create(X.prototype),ae.prototype.constructor=ae,ae.prototype.isLineBasicMaterial=!0,ae.prototype.copy=function(t){return X.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this},oe.prototype=Object.assign(Object.create(rt.prototype),{constructor:oe,isLine:!0,raycast:function(){var t=new l,e=new et,n=new J;return function(i,r){var a=i.linePrecision,a=a*a,o=this.geometry,s=this.matrixWorld;if(null===o.boundingSphere&&o.computeBoundingSphere(),n.copy(o.boundingSphere),n.applyMatrix4(s),!1!==i.ray.intersectsSphere(n)){t.getInverse(s),e.copy(i.ray).applyMatrix4(t);var l=new c,h=new c,s=new c,u=new c,d=this&&this.isLineSegments?2:1;if(o&&o.isBufferGeometry){var p=o.index,f=o.attributes.position.array;if(null!==p)for(var p=p.array,o=0,m=p.length-1;o<m;o+=d){var g=p[o+1];l.fromArray(f,3*p[o]),h.fromArray(f,3*g),g=e.distanceSqToSegment(l,h,u,s),g>a||(u.applyMatrix4(this.matrixWorld),g=i.ray.origin.distanceTo(u),g<i.near||g>i.far||r.push({distance:g,point:s.clone().applyMatrix4(this.matrixWorld),index:o,face:null,faceIndex:null,object:this}))}else for(o=0,m=f.length/3-1;o<m;o+=d)l.fromArray(f,3*o),h.fromArray(f,3*o+3),g=e.distanceSqToSegment(l,h,u,s),g>a||(u.applyMatrix4(this.matrixWorld),g=i.ray.origin.distanceTo(u),g<i.near||g>i.far||r.push({distance:g,point:s.clone().applyMatrix4(this.matrixWorld),index:o,face:null,faceIndex:null,object:this}))}else if(o&&o.isGeometry)for(l=o.vertices,h=l.length,o=0;o<h-1;o+=d)g=e.distanceSqToSegment(l[o],l[o+1],u,s),g>a||(u.applyMatrix4(this.matrixWorld),g=i.ray.origin.distanceTo(u),g<i.near||g>i.far||r.push({distance:g,point:s.clone().applyMatrix4(this.matrixWorld),index:o,face:null,faceIndex:null,object:this}))}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),se.prototype=Object.assign(Object.create(oe.prototype),{constructor:se,isLineSegments:!0}),ce.prototype=Object.create(X.prototype),ce.prototype.constructor=ce,ce.prototype.isPointsMaterial=!0,ce.prototype.copy=function(t){return X.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this},le.prototype=Object.assign(Object.create(rt.prototype),{constructor:le,isPoints:!0,raycast:function(){var t=new l,e=new et,n=new J;return function(i,r){function a(t,n){var a=e.distanceSqToPoint(t);if(a<u){var s=e.closestPointToPoint(t);s.applyMatrix4(l);var c=i.ray.origin.distanceTo(s);c<i.near||c>i.far||r.push({distance:c,distanceToRay:Math.sqrt(a),point:s.clone(),index:n,face:null,object:o})}}var o=this,s=this.geometry,l=this.matrixWorld,h=i.params.Points.threshold;if(null===s.boundingSphere&&s.computeBoundingSphere(),n.copy(s.boundingSphere),n.applyMatrix4(l),!1!==i.ray.intersectsSphere(n)){t.getInverse(l),e.copy(i.ray).applyMatrix4(t);var h=h/((this.scale.x+this.scale.y+this.scale.z)/3),u=h*h,h=new c;if(s&&s.isBufferGeometry){var d=s.index,s=s.attributes.position.array;if(null!==d)for(var p=d.array,d=0,f=p.length;d<f;d++){var m=p[d];h.fromArray(s,3*m),a(h,m)}else for(d=0,p=s.length/3;d<p;d++)h.fromArray(s,3*d),a(h,d)}else for(h=s.vertices,d=0,p=h.length;d<p;d++)a(h[d],d)}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),he.prototype=Object.assign(Object.create(rt.prototype),{constructor:he}),ue.prototype=Object.create(i.prototype),ue.prototype.constructor=ue,de.prototype=Object.create(i.prototype),de.prototype.constructor=de,de.prototype.isCompressedTexture=!0,pe.prototype=Object.create(i.prototype),pe.prototype.constructor=pe,fe.prototype=Object.create(i.prototype),fe.prototype.constructor=fe,fe.prototype.isDepthTexture=!0,me.prototype=Object.create(mt.prototype),me.prototype.constructor=me,ge.prototype=Object.create(pt.prototype),ge.prototype.constructor=ge,ve.prototype=Object.create(pt.prototype),ve.prototype.constructor=ve,ye.prototype=Object.create(ve.prototype),ye.prototype.constructor=ye,xe.prototype=Object.create(ve.prototype),xe.prototype.constructor=xe,be.prototype=Object.create(ve.prototype),be.prototype.constructor=be,we.prototype=Object.create(ve.prototype),we.prototype.constructor=we,_e.prototype=Object.create(pt.prototype),_e.prototype.constructor=_e,_e.NoTaper=function(t){return 1},_e.SinusoidalTaper=function(t){return Math.sin(Math.PI*t)},_e.FrenetFrames=function(e,n,i){var r=new c,a=[],o=[],s=[],h=new c,u=new l;n+=1;var d,p,f;for(this.tangents=a,this.normals=o,this.binormals=s,d=0;d<n;d++)p=d/(n-1),a[d]=e.getTangentAt(p),a[d].normalize();for(o[0]=new c,s[0]=new c,e=Number.MAX_VALUE,d=Math.abs(a[0].x),p=Math.abs(a[0].y),f=Math.abs(a[0].z),d<=e&&(e=d,r.set(1,0,0)),p<=e&&(e=p,r.set(0,1,0)),f<=e&&r.set(0,0,1),h.crossVectors(a[0],r).normalize(),o[0].crossVectors(a[0],h),s[0].crossVectors(a[0],o[0]),d=1;d<n;d++)o[d]=o[d-1].clone(),s[d]=s[d-1].clone(),h.crossVectors(a[d-1],a[d]),h.length()>Number.EPSILON&&(h.normalize(),r=Math.acos(t.Math.clamp(a[d-1].dot(a[d]),-1,1)),o[d].applyMatrix4(u.makeRotationAxis(h,r))),s[d].crossVectors(a[d],o[d]);if(i)for(r=Math.acos(t.Math.clamp(o[0].dot(o[n-1]),-1,1)),r/=n-1,0<a[0].dot(h.crossVectors(o[0],o[n-1]))&&(r=-r),d=1;d<n;d++)o[d].applyMatrix4(u.makeRotationAxis(a[d],r*d)),s[d].crossVectors(a[d],o[d])},Me.prototype=Object.create(mt.prototype),Me.prototype.constructor=Me,Ee.prototype=Object.create(pt.prototype),Ee.prototype.constructor=Ee,Te.prototype=Object.create(mt.prototype),Te.prototype.constructor=Te,Se.prototype=Object.create(pt.prototype),Se.prototype.constructor=Se,t.ShapeUtils={area:function(t){for(var e=t.length,n=0,i=e-1,r=0;r<e;i=r++)n+=t[i].x*t[r].y-t[r].x*t[i].y;return.5*n},triangulate:function(){return function(e,n){var i=e.length;if(3>i)return null;var r,a,o,s=[],c=[],l=[];if(0<t.ShapeUtils.area(e))for(a=0;a<i;a++)c[a]=a;else for(a=0;a<i;a++)c[a]=i-1-a;var h=2*i;for(a=i-1;2<i;){if(0>=h--){console.warn("THREE.ShapeUtils: Unable to triangulate polygon! in triangulate()");break}r=a,i<=r&&(r=0),a=r+1,i<=a&&(a=0),o=a+1,i<=o&&(o=0);var u;t:{var d,p,f,m,g,v,y,x;if(d=e[c[r]].x,p=e[c[r]].y,f=e[c[a]].x,m=e[c[a]].y,g=e[c[o]].x,v=e[c[o]].y,Number.EPSILON>(f-d)*(v-p)-(m-p)*(g-d))u=!1;else{var b,w,_,M,E,T,S,A,R,L;for(b=g-f,w=v-m,_=d-g,M=p-v,E=f-d,T=m-p,u=0;u<i;u++)if(y=e[c[u]].x,x=e[c[u]].y,!(y===d&&x===p||y===f&&x===m||y===g&&x===v)&&(S=y-d,A=x-p,R=y-f,L=x-m,y-=g,x-=v,R=b*L-w*R,S=E*A-T*S,A=_*x-M*y,R>=-Number.EPSILON&&A>=-Number.EPSILON&&S>=-Number.EPSILON)){u=!1;break t}u=!0}}if(u){for(s.push([e[c[r]],e[c[a]],e[c[o]]]),l.push([c[r],c[a],c[o]]),r=a,o=a+1;o<i;r++,o++)c[r]=c[o];i--,h=2*i}}return n?l:s}}(),triangulateShape:function(e,n){function i(t){var e=t.length;2<e&&t[e-1].equals(t[0])&&t.pop()}function r(t,e,n){return t.x!==e.x?t.x<e.x?t.x<=n.x&&n.x<=e.x:e.x<=n.x&&n.x<=t.x:t.y<e.y?t.y<=n.y&&n.y<=e.y:e.y<=n.y&&n.y<=t.y}function a(t,e,n,i,a){var o=e.x-t.x,s=e.y-t.y,c=i.x-n.x,l=i.y-n.y,h=t.x-n.x,u=t.y-n.y,d=s*c-o*l,p=s*h-o*u;if(Math.abs(d)>Number.EPSILON){if(0<d){if(0>p||p>d)return[];if(c=l*h-c*u,0>c||c>d)return[]}else{if(0<p||p<d)return[];if(c=l*h-c*u,0<c||c<d)return[]}return 0===c?!a||0!==p&&p!==d?[t]:[]:c===d?!a||0!==p&&p!==d?[e]:[]:0===p?[n]:p===d?[i]:(a=c/d,[{x:t.x+a*o,y:t.y+a*s}])}return 0!==p||l*h!==c*u?[]:(s=0===o&&0===s,c=0===c&&0===l,s&&c?t.x!==n.x||t.y!==n.y?[]:[t]:s?r(n,i,t)?[t]:[]:c?r(t,e,n)?[n]:[]:(0!==o?(t.x<e.x?(o=t,c=t.x,s=e,t=e.x):(o=e,c=e.x,s=t,t=t.x),n.x<i.x?(e=n,d=n.x,l=i,n=i.x):(e=i,d=i.x,l=n,n=n.x)):(t.y<e.y?(o=t,c=t.y,s=e,t=e.y):(o=e,c=e.y,s=t,t=t.y),n.y<i.y?(e=n,d=n.y,l=i,n=i.y):(e=i,d=i.y,l=n,n=n.y)),c<=d?t<d?[]:t===d?a?[]:[e]:t<=n?[e,s]:[e,l]:c>n?[]:c===n?a?[]:[o]:t<=n?[o,s]:[o,l]))}function o(t,e,n,i){var r=e.x-t.x,a=e.y-t.y;e=n.x-t.x,n=n.y-t.y;var o=i.x-t.x;return i=i.y-t.y,t=r*n-a*e,r=r*i-a*o,Math.abs(t)>Number.EPSILON?(e=o*n-i*e,0<t?0<=r&&0<=e:0<=r||0<=e):0<r}i(e),n.forEach(i);var s,c,l,h,u,d={};for(l=e.concat(),s=0,c=n.length;s<c;s++)Array.prototype.push.apply(l,n[s]);for(s=0,c=l.length;s<c;s++)u=l[s].x+":"+l[s].y,void 0!==d[u]&&console.warn("THREE.ShapeUtils: Duplicate point",u,s),d[u]=s;s=function(t,e){function n(t,e){var n=g.length-1,i=t-1;0>i&&(i=n);var r=t+1;return r>n&&(r=0),!!(n=o(g[t],g[i],g[r],s[e]))&&(n=s.length-1,i=e-1,0>i&&(i=n),r=e+1,r>n&&(r=0),!!(n=o(s[e],s[i],s[r],g[t])))}function i(t,e){var n,i;for(n=0;n<g.length;n++)if(i=n+1,i%=g.length,i=a(t,e,g[n],g[i],!0),0<i.length)return!0;return!1}function r(t,n){var i,r,o,s;for(i=0;i<v.length;i++)for(r=e[v[i]],o=0;o<r.length;o++)if(s=o+1,s%=r.length,s=a(t,n,r[o],r[s],!0),0<s.length)return!0;return!1}var s,c,l,h,u,d,p,f,m,g=t.concat(),v=[],y=[],x=0;for(c=e.length;x<c;x++)v.push(x);p=0;for(var b=2*v.length;0<v.length;){if(b--,0>b){console.log("Infinite Loop! Holes left:"+v.length+", Probably Hole outside Shape!");break}for(l=p;l<g.length;l++){for(h=g[l],c=-1,x=0;x<v.length;x++)if(u=v[x],d=h.x+":"+h.y+":"+u,void 0===y[d]){for(s=e[u],f=0;f<s.length;f++)if(u=s[f],n(l,f)&&!i(h,u)&&!r(h,u)){c=f,v.splice(x,1),p=g.slice(0,l+1),u=g.slice(l),f=s.slice(c),m=s.slice(0,c+1),g=p.concat(f).concat(m).concat(u),p=l;break}if(0<=c)break;y[d]=!0}if(0<=c)break}}return g}(e,n);var p=t.ShapeUtils.triangulate(s,!1);for(s=0,c=p.length;s<c;s++)for(h=p[s],l=0;3>l;l++)u=h[l].x+":"+h[l].y,u=d[u],void 0!==u&&(h[l]=u);return p.concat()},isClockWise:function(e){return 0>t.ShapeUtils.area(e)},b2:function(){return function(t,e,n,i){var r=1-t;return r*r*e+2*(1-t)*t*n+t*t*i}}(),b3:function(){return function(t,e,n,i,r){var a=1-t,o=1-t;return a*a*a*e+3*o*o*t*n+3*(1-t)*t*t*i+t*t*t*r}}()},Ae.prototype=Object.create(pt.prototype),Ae.prototype.constructor=Ae,Ae.prototype.addShapeList=function(t,e){for(var n=t.length,i=0;i<n;i++)this.addShape(t[i],e)},Ae.prototype.addShape=function(e,i){function r(t,e,n){return e||console.error("THREE.ExtrudeGeometry: vec does not exist"),e.clone().multiplyScalar(n).add(t)}function a(t,e,i){var r,a,o;a=t.x-e.x,o=t.y-e.y,r=i.x-t.x;var s=i.y-t.y,c=a*a+o*o;if(Math.abs(a*s-o*r)>Number.EPSILON){var l=Math.sqrt(c),h=Math.sqrt(r*r+s*s),c=e.x-o/l;if(e=e.y+a/l,s=((i.x-s/h-c)*s-(i.y+r/h-e)*r)/(a*s-o*r),r=c+a*s-t.x,a=e+o*s-t.y,o=r*r+a*a,2>=o)return new n(r,a);o=Math.sqrt(o/2)}else t=!1,a>Number.EPSILON?r>Number.EPSILON&&(t=!0):a<-Number.EPSILON?r<-Number.EPSILON&&(t=!0):Math.sign(o)===Math.sign(s)&&(t=!0),t?(r=-o,o=Math.sqrt(c)):(r=a,a=o,o=Math.sqrt(c/2));return new n(r/o,a/o)}function o(t,e){var n,i;for(G=t.length;0<=--G;){n=G,i=G-1,0>i&&(i=t.length-1);var r,a=w+2*y;for(r=0;r<a;r++){var o=z*r,s=z*(r+1),c=e+n+o,o=e+i+o,l=e+i+s,s=e+n+s,c=c+L,o=o+L,l=l+L,s=s+L;R.faces.push(new st(c,o,s,null,null,1)),R.faces.push(new st(o,l,s,null,null,1)),c=E.generateSideWallUV(R,c,o,l,s),R.faceVertexUvs[0].push([c[0],c[1],c[3]]),R.faceVertexUvs[0].push([c[1],c[2],c[3]])}}}function s(t,e,n){R.vertices.push(new c(t,e,n))}function l(t,e,n){t+=L,e+=L,n+=L,R.faces.push(new st(t,e,n,null,null,0)),t=E.generateTopUV(R,t,e,n),R.faceVertexUvs[0].push(t)}var h,u,d,p,f,m=void 0!==i.amount?i.amount:100,g=void 0!==i.bevelThickness?i.bevelThickness:6,v=void 0!==i.bevelSize?i.bevelSize:g-2,y=void 0!==i.bevelSegments?i.bevelSegments:3,x=void 0===i.bevelEnabled||i.bevelEnabled,b=void 0!==i.curveSegments?i.curveSegments:12,w=void 0!==i.steps?i.steps:1,_=i.extrudePath,M=!1,E=void 0!==i.UVGenerator?i.UVGenerator:Ae.WorldUVGenerator;_&&(h=_.getSpacedPoints(w),M=!0,x=!1,u=void 0!==i.frames?i.frames:new _e.FrenetFrames(_,w,(!1)),d=new c,p=new c,f=new c),x||(v=g=y=0);var T,S,A,R=this,L=this.vertices.length,_=e.extractPoints(b),b=_.shape,C=_.holes;if(_=!t.ShapeUtils.isClockWise(b)){for(b=b.reverse(),S=0,A=C.length;S<A;S++)T=C[S],t.ShapeUtils.isClockWise(T)&&(C[S]=T.reverse());_=!1}var P=t.ShapeUtils.triangulateShape(b,C),I=b;for(S=0,A=C.length;S<A;S++)T=C[S],b=b.concat(T);var U,N,D,F,O,B,z=b.length,H=P.length,_=[],G=0;for(D=I.length,U=D-1,N=G+1;G<D;G++,U++,N++)U===D&&(U=0),N===D&&(N=0),_[G]=a(I[G],I[U],I[N]);var k,V=[],j=_.concat();for(S=0,A=C.length;S<A;S++){for(T=C[S],k=[],G=0,D=T.length,U=D-1,N=G+1;G<D;G++,U++,N++)U===D&&(U=0),N===D&&(N=0),k[G]=a(T[G],T[U],T[N]);V.push(k),j=j.concat(k)}for(U=0;U<y;U++){for(D=U/y,F=g*Math.cos(D*Math.PI/2),N=v*Math.sin(D*Math.PI/2),G=0,D=I.length;G<D;G++)O=r(I[G],_[G],N),s(O.x,O.y,-F);for(S=0,A=C.length;S<A;S++)for(T=C[S],k=V[S],G=0,D=T.length;G<D;G++)O=r(T[G],k[G],N),s(O.x,O.y,-F)}for(N=v,G=0;G<z;G++)O=x?r(b[G],j[G],N):b[G],M?(p.copy(u.normals[0]).multiplyScalar(O.x),d.copy(u.binormals[0]).multiplyScalar(O.y),f.copy(h[0]).add(p).add(d),s(f.x,f.y,f.z)):s(O.x,O.y,0);for(D=1;D<=w;D++)for(G=0;G<z;G++)O=x?r(b[G],j[G],N):b[G],M?(p.copy(u.normals[D]).multiplyScalar(O.x),d.copy(u.binormals[D]).multiplyScalar(O.y),f.copy(h[D]).add(p).add(d),s(f.x,f.y,f.z)):s(O.x,O.y,m/w*D);for(U=y-1;0<=U;U--){for(D=U/y,F=g*Math.cos(D*Math.PI/2),N=v*Math.sin(D*Math.PI/2),G=0,D=I.length;G<D;G++)O=r(I[G],_[G],N),s(O.x,O.y,m+F);for(S=0,A=C.length;S<A;S++)for(T=C[S],k=V[S],G=0,D=T.length;G<D;G++)O=r(T[G],k[G],N),M?s(O.x,O.y+h[w-1].y,h[w-1].x+F):s(O.x,O.y,m+F)}!function(){if(x){var t=0*z;for(G=0;G<H;G++)B=P[G],l(B[2]+t,B[1]+t,B[0]+t);for(t=z*(w+2*y),G=0;G<H;G++)B=P[G],l(B[0]+t,B[1]+t,B[2]+t)}else{for(G=0;G<H;G++)B=P[G],l(B[2],B[1],B[0]);for(G=0;G<H;G++)B=P[G],l(B[0]+z*w,B[1]+z*w,B[2]+z*w)}}(),function(){var t=0;for(o(I,t),t+=I.length,S=0,A=C.length;S<A;S++)T=C[S],o(T,t),t+=T.length}()},Ae.WorldUVGenerator={generateTopUV:function(t,e,i,r){return t=t.vertices,e=t[e],i=t[i],r=t[r],[new n(e.x,e.y),new n(i.x,i.y),new n(r.x,r.y)]},generateSideWallUV:function(t,e,i,r,a){return t=t.vertices,e=t[e],i=t[i],r=t[r],a=t[a],.01>Math.abs(e.y-i.y)?[new n(e.x,1-e.z),new n(i.x,1-i.z),new n(r.x,1-r.z),new n(a.x,1-a.z)]:[new n(e.y,1-e.z),new n(i.y,1-i.z),new n(r.y,1-r.z),new n(a.y,1-a.z)]}},Re.prototype=Object.create(Ae.prototype),Re.prototype.constructor=Re,Le.prototype=Object.create(mt.prototype),Le.prototype.constructor=Le,Ce.prototype=Object.create(pt.prototype),Ce.prototype.constructor=Ce,Pe.prototype=Object.create(mt.prototype),Pe.prototype.constructor=Pe,Ie.prototype=Object.create(pt.prototype),Ie.prototype.constructor=Ie,Ue.prototype=Object.create(pt.prototype),Ue.prototype.constructor=Ue,Ne.prototype=Object.create(mt.prototype),Ne.prototype.constructor=Ne,De.prototype=Object.create(pt.prototype),De.prototype.constructor=De,Fe.prototype=Object.create(pt.prototype),Fe.prototype.constructor=Fe,Fe.prototype.addShapeList=function(t,e){for(var n=0,i=t.length;n<i;n++)this.addShape(t[n],e);return this},Fe.prototype.addShape=function(e,n){void 0===n&&(n={});var i,r,a,o=n.material,s=void 0===n.UVGenerator?Ae.WorldUVGenerator:n.UVGenerator,l=this.vertices.length;i=e.extractPoints(void 0!==n.curveSegments?n.curveSegments:12);var h=i.shape,u=i.holes;if(!t.ShapeUtils.isClockWise(h))for(h=h.reverse(),i=0,r=u.length;i<r;i++)a=u[i],t.ShapeUtils.isClockWise(a)&&(u[i]=a.reverse());var d=t.ShapeUtils.triangulateShape(h,u);for(i=0,r=u.length;i<r;i++)a=u[i],h=h.concat(a);for(u=h.length,r=d.length,i=0;i<u;i++)a=h[i],this.vertices.push(new c(a.x,a.y,0));for(i=0;i<r;i++)u=d[i],h=u[0]+l,a=u[1]+l,u=u[2]+l,this.faces.push(new st(h,a,u,null,null,o)),this.faceVertexUvs[0].push(s.generateTopUV(this,h,a,u))},Oe.prototype=Object.create(mt.prototype),Oe.prototype.constructor=Oe,Be.prototype=Object.create(mt.prototype),Be.prototype.constructor=Be,ze.prototype=Object.create(pt.prototype),ze.prototype.constructor=ze,He.prototype=Object.create(ze.prototype),He.prototype.constructor=He,Ge.prototype=Object.create(mt.prototype),Ge.prototype.constructor=Ge,ke.prototype=Object.create(mt.prototype),ke.prototype.constructor=ke,Ve.prototype=Object.create(pt.prototype),Ve.prototype.constructor=Ve,je.prototype=Object.create(pt.prototype),je.prototype.constructor=je;var Ki=Object.freeze({WireframeGeometry:me,ParametricGeometry:ge,TetrahedronGeometry:ye,OctahedronGeometry:xe,IcosahedronGeometry:be,DodecahedronGeometry:we,PolyhedronGeometry:ve,TubeGeometry:_e,TorusKnotGeometry:Ee,TorusKnotBufferGeometry:Me,TorusGeometry:Se,TorusBufferGeometry:Te,TextGeometry:Re,SphereBufferGeometry:Le,SphereGeometry:Ce,RingGeometry:Ie,RingBufferGeometry:Pe,PlaneBufferGeometry:yt,PlaneGeometry:Ue,LatheGeometry:De,LatheBufferGeometry:Ne,ShapeGeometry:Fe,ExtrudeGeometry:Ae,EdgesGeometry:Oe,ConeGeometry:He,ConeBufferGeometry:Ge,CylinderGeometry:ze,CylinderBufferGeometry:Be,CircleBufferGeometry:ke,CircleGeometry:Ve,BoxBufferGeometry:vt,BoxGeometry:je});We.prototype=Object.create(q.prototype),We.prototype.constructor=We,We.prototype.isShadowMaterial=!0,Xe.prototype=Object.create(q.prototype),Xe.prototype.constructor=Xe,Xe.prototype.isRawShaderMaterial=!0,qe.prototype={constructor:qe,isMultiMaterial:!0,toJSON:function(t){for(var e={metadata:{version:4.2,type:"material",generator:"MaterialExporter"},uuid:this.uuid,type:this.type,materials:[]},n=this.materials,i=0,r=n.length;i<r;i++){var a=n[i].toJSON(t);delete a.metadata,e.materials.push(a)}return e.visible=this.visible,e},clone:function(){for(var t=new this.constructor,e=0;e<this.materials.length;e++)t.materials.push(this.materials[e].clone());return t.visible=this.visible,t}},Ye.prototype=Object.create(X.prototype),Ye.prototype.constructor=Ye,Ye.prototype.isMeshStandardMaterial=!0,Ye.prototype.copy=function(t){return X.prototype.copy.call(this,t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},Ze.prototype=Object.create(Ye.prototype),Ze.prototype.constructor=Ze,Ze.prototype.isMeshPhysicalMaterial=!0,Ze.prototype.copy=function(t){return Ye.prototype.copy.call(this,t),this.defines={PHYSICAL:""},this.reflectivity=t.reflectivity,this.clearCoat=t.clearCoat,this.clearCoatRoughness=t.clearCoatRoughness,this},Je.prototype=Object.create(X.prototype),Je.prototype.constructor=Je,Je.prototype.isMeshPhongMaterial=!0,Je.prototype.copy=function(t){return X.prototype.copy.call(this,t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},Qe.prototype=Object.create(X.prototype),Qe.prototype.constructor=Qe,Qe.prototype.isMeshNormalMaterial=!0,Qe.prototype.copy=function(t){return X.prototype.copy.call(this,t),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this},Ke.prototype=Object.create(X.prototype),Ke.prototype.constructor=Ke,Ke.prototype.isMeshLambertMaterial=!0,Ke.prototype.copy=function(t){return X.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},$e.prototype=Object.create(X.prototype),$e.prototype.constructor=$e,$e.prototype.isLineDashedMaterial=!0,$e.prototype.copy=function(t){return X.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this};var $i=Object.freeze({ShadowMaterial:We,SpriteMaterial:Kt,RawShaderMaterial:Xe,ShaderMaterial:q,PointsMaterial:ce,MultiMaterial:qe,MeshPhysicalMaterial:Ze,MeshStandardMaterial:Ye,MeshPhongMaterial:Je,MeshNormalMaterial:Qe,MeshLambertMaterial:Ke,MeshDepthMaterial:Y,MeshBasicMaterial:ct,LineDashedMaterial:$e,LineBasicMaterial:ae,Material:X});t.Cache={enabled:!1,files:{},add:function(t,e){!1!==this.enabled&&(this.files[t]=e)},get:function(t){if(!1!==this.enabled)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}},t.DefaultLoadingManager=new tn,Object.assign(en.prototype,{load:function(e,n,i,r){void 0!==this.path&&(e=this.path+e);var a=this,o=t.Cache.get(e);if(void 0!==o)return a.manager.itemStart(e),setTimeout(function(){n&&n(o),a.manager.itemEnd(e)},0),o;var s=new XMLHttpRequest;return s.open("GET",e,!0),s.addEventListener("load",function(i){var o=i.target.response;t.Cache.add(e,o),200===this.status?(n&&n(o),a.manager.itemEnd(e)):0===this.status?(console.warn("THREE.XHRLoader: HTTP Status 0 received."),n&&n(o),a.manager.itemEnd(e)):(r&&r(i),a.manager.itemError(e))},!1),void 0!==i&&s.addEventListener("progress",function(t){i(t)},!1),s.addEventListener("error",function(t){r&&r(t),a.manager.itemError(e)},!1),void 0!==this.responseType&&(s.responseType=this.responseType),void 0!==this.withCredentials&&(s.withCredentials=this.withCredentials),s.overrideMimeType&&s.overrideMimeType("text/plain"),s.send(null),a.manager.itemStart(e),s},setPath:function(t){return this.path=t,this},setResponseType:function(t){return this.responseType=t,this},setWithCredentials:function(t){return this.withCredentials=t,this}}),Object.assign(nn.prototype,{load:function(t,e,n,i){function r(r){c.load(t[r],function(t){t=a._parser(t,!0),o[r]={width:t.width,height:t.height,format:t.format,mipmaps:t.mipmaps},l+=1,6===l&&(1===t.mipmapCount&&(s.minFilter=1006),s.format=t.format,s.needsUpdate=!0,e&&e(s))},n,i)}var a=this,o=[],s=new de;s.image=o;var c=new en(this.manager);if(c.setPath(this.path),c.setResponseType("arraybuffer"),Array.isArray(t))for(var l=0,h=0,u=t.length;h<u;++h)r(h);else c.load(t,function(t){if(t=a._parser(t,!0),t.isCubemap)for(var n=t.mipmaps.length/t.mipmapCount,i=0;i<n;i++){o[i]={mipmaps:[]};for(var r=0;r<t.mipmapCount;r++)o[i].mipmaps.push(t.mipmaps[i*t.mipmapCount+r]),o[i].format=t.format,o[i].width=t.width,o[i].height=t.height}else s.image.width=t.width,s.image.height=t.height,s.mipmaps=t.mipmaps;1===t.mipmapCount&&(s.minFilter=1006),s.format=t.format,s.needsUpdate=!0,e&&e(s)},n,i);return s},setPath:function(t){return this.path=t,this}}),Object.assign(rn.prototype,{load:function(t,e,n,i){var r=this,a=new ee,o=new en(this.manager);return o.setResponseType("arraybuffer"),o.load(t,function(t){(t=r._parser(t))&&(void 0!==t.image?a.image=t.image:void 0!==t.data&&(a.image.width=t.width,a.image.height=t.height,a.image.data=t.data),a.wrapS=void 0!==t.wrapS?t.wrapS:1001,a.wrapT=void 0!==t.wrapT?t.wrapT:1001,a.magFilter=void 0!==t.magFilter?t.magFilter:1006,a.minFilter=void 0!==t.minFilter?t.minFilter:1008,a.anisotropy=void 0!==t.anisotropy?t.anisotropy:1,void 0!==t.format&&(a.format=t.format),void 0!==t.type&&(a.type=t.type),void 0!==t.mipmaps&&(a.mipmaps=t.mipmaps),1===t.mipmapCount&&(a.minFilter=1006),a.needsUpdate=!0,e&&e(a,t))},n,i),a}}),Object.assign(an.prototype,{load:function(t,e,n,i){var r=this,a=document.createElementNS("http://www.w3.org/1999/xhtml","img");if(a.onload=function(){a.onload=null,URL.revokeObjectURL(a.src),e&&e(a),r.manager.itemEnd(t)},0===t.indexOf("data:"))a.src=t;else{var o=new en;o.setPath(this.path),o.setResponseType("blob"),o.setWithCredentials(this.withCredentials),o.load(t,function(t){a.src=URL.createObjectURL(t)},n,i)}return r.manager.itemStart(t),a},setCrossOrigin:function(t){return this.crossOrigin=t,this},setWithCredentials:function(t){return this.withCredentials=t,this},setPath:function(t){return this.path=t,this}}),Object.assign(on.prototype,{load:function(t,e,n,i){function r(n){o.load(t[n],function(t){a.images[n]=t,s++,6===s&&(a.needsUpdate=!0,e&&e(a))},void 0,i)}var a=new h,o=new an(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);var s=0;for(n=0;n<t.length;++n)r(n);return a},setCrossOrigin:function(t){return this.crossOrigin=t,this},setPath:function(t){return this.path=t,this}}),Object.assign(sn.prototype,{load:function(t,e,n,r){var a=new i,o=new an(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setWithCredentials(this.withCredentials),o.setPath(this.path),o.load(t,function(n){var i=0<t.search(/\.(jpg|jpeg)$/)||0===t.search(/^data\:image\/jpeg/);a.format=i?1022:1023,a.image=n,a.needsUpdate=!0,void 0!==e&&e(a)},n,r),a},setCrossOrigin:function(t){return this.crossOrigin=t,this},setWithCredentials:function(t){return this.withCredentials=t,this},setPath:function(t){return this.path=t,this}}),cn.prototype=Object.assign(Object.create(rt.prototype),{constructor:cn,isLight:!0,copy:function(t){return rt.prototype.copy.call(this,t),this.color.copy(t.color),this.intensity=t.intensity,this},toJSON:function(t){return t=rt.prototype.toJSON.call(this,t),t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}),ln.prototype=Object.assign(Object.create(cn.prototype),{constructor:ln,isHemisphereLight:!0,copy:function(t){return cn.prototype.copy.call(this,t),this.groundColor.copy(t.groundColor),this}}),Object.assign(hn.prototype,{copy:function(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var t={};return 0!==this.bias&&(t.bias=this.bias),1!==this.radius&&(t.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}}),un.prototype=Object.assign(Object.create(hn.prototype),{
constructor:un,isSpotLightShadow:!0,update:function(e){var n=2*t.Math.RAD2DEG*e.angle,i=this.mapSize.width/this.mapSize.height;e=e.distance||500;var r=this.camera;n===r.fov&&i===r.aspect&&e===r.far||(r.fov=n,r.aspect=i,r.far=e,r.updateProjectionMatrix())}}),dn.prototype=Object.assign(Object.create(cn.prototype),{constructor:dn,isSpotLight:!0,copy:function(t){return cn.prototype.copy.call(this,t),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),pn.prototype=Object.assign(Object.create(cn.prototype),{constructor:pn,isPointLight:!0,copy:function(t){return cn.prototype.copy.call(this,t),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}}),fn.prototype=Object.assign(Object.create(hn.prototype),{constructor:fn}),mn.prototype=Object.assign(Object.create(cn.prototype),{constructor:mn,isDirectionalLight:!0,copy:function(t){return cn.prototype.copy.call(this,t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),gn.prototype=Object.assign(Object.create(cn.prototype),{constructor:gn,isAmbientLight:!0}),t.AnimationUtils={arraySlice:function(e,n,i){return t.AnimationUtils.isTypedArray(e)?new e.constructor(e.subarray(n,i)):e.slice(n,i)},convertArray:function(t,e,n){return!t||!n&&t.constructor===e?t:"number"==typeof e.BYTES_PER_ELEMENT?new e(t):Array.prototype.slice.call(t)},isTypedArray:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)},getKeyframeOrder:function(t){for(var e=t.length,n=Array(e),i=0;i!==e;++i)n[i]=i;return n.sort(function(e,n){return t[e]-t[n]}),n},sortedArray:function(t,e,n){for(var i=t.length,r=new t.constructor(i),a=0,o=0;o!==i;++a)for(var s=n[a]*e,c=0;c!==e;++c)r[o++]=t[s+c];return r},flattenJSON:function(t,e,n,i){for(var r=1,a=t[0];void 0!==a&&void 0===a[i];)a=t[r++];if(void 0!==a){var o=a[i];if(void 0!==o)if(Array.isArray(o)){do o=a[i],void 0!==o&&(e.push(a.time),n.push.apply(n,o)),a=t[r++];while(void 0!==a)}else if(void 0!==o.toArray){do o=a[i],void 0!==o&&(e.push(a.time),o.toArray(n,n.length)),a=t[r++];while(void 0!==a)}else do o=a[i],void 0!==o&&(e.push(a.time),n.push(o)),a=t[r++];while(void 0!==a)}}},vn.prototype={constructor:vn,evaluate:function(t){var e=this.parameterPositions,n=this._cachedIndex,i=e[n],r=e[n-1];t:{e:{n:{i:if(!(t<i)){for(var a=n+2;;){if(void 0===i){if(t<r)break i;return this._cachedIndex=n=e.length,this.afterEnd_(n-1,t,r)}if(n===a)break;if(r=i,i=e[++n],t<i)break e}i=e.length;break n}if(t>=r)break t;for(a=e[1],t<a&&(n=2,r=a),a=n-2;;){if(void 0===r)return this._cachedIndex=0,this.beforeStart_(0,t,i);if(n===a)break;if(i=r,r=e[--n-1],t>=r)break e}i=n,n=0}for(;n<i;)r=n+i>>>1,t<e[r]?i=r:n=r+1;if(i=e[n],r=e[n-1],void 0===r)return this._cachedIndex=0,this.beforeStart_(0,t,i);if(void 0===i)return this._cachedIndex=n=e.length,this.afterEnd_(n-1,r,t)}this._cachedIndex=n,this.intervalChanged_(n,r,i)}return this.interpolate_(n,r,t,i)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(t){var e=this.resultBuffer,n=this.sampleValues,i=this.valueSize;t*=i;for(var r=0;r!==i;++r)e[r]=n[t+r];return e},interpolate_:function(t,e,n,i){throw Error("call to abstract method")},intervalChanged_:function(t,e,n){}},Object.assign(vn.prototype,{beforeStart_:vn.prototype.copySampleValue_,afterEnd_:vn.prototype.copySampleValue_}),yn.prototype=Object.assign(Object.create(vn.prototype),{constructor:yn,DefaultSettings_:{endingStart:2400,endingEnd:2400},intervalChanged_:function(t,e,n){var i=this.parameterPositions,r=t-2,a=t+1,o=i[r],s=i[a];if(void 0===o)switch(this.getSettings_().endingStart){case 2401:r=t,o=2*e-n;break;case 2402:r=i.length-2,o=e+i[r]-i[r+1];break;default:r=t,o=n}if(void 0===s)switch(this.getSettings_().endingEnd){case 2401:a=t,s=2*n-e;break;case 2402:a=1,s=n+i[1]-i[0];break;default:a=t-1,s=e}t=.5*(n-e),i=this.valueSize,this._weightPrev=t/(e-o),this._weightNext=t/(s-n),this._offsetPrev=r*i,this._offsetNext=a*i},interpolate_:function(t,e,n,i){var r=this.resultBuffer,a=this.sampleValues,o=this.valueSize;t*=o;var s=t-o,c=this._offsetPrev,l=this._offsetNext,h=this._weightPrev,u=this._weightNext,d=(n-e)/(i-e);for(n=d*d,i=n*d,e=-h*i+2*h*n-h*d,h=(1+h)*i+(-1.5-2*h)*n+(-.5+h)*d+1,d=(-1-u)*i+(1.5+u)*n+.5*d,u=u*i-u*n,n=0;n!==o;++n)r[n]=e*a[c+n]+h*a[s+n]+d*a[t+n]+u*a[l+n];return r}}),xn.prototype=Object.assign(Object.create(vn.prototype),{constructor:xn,interpolate_:function(t,e,n,i){var r=this.resultBuffer,a=this.sampleValues,o=this.valueSize;t*=o;var s=t-o;for(e=(n-e)/(i-e),n=1-e,i=0;i!==o;++i)r[i]=a[s+i]*n+a[t+i]*e;return r}}),bn.prototype=Object.assign(Object.create(vn.prototype),{constructor:bn,interpolate_:function(t,e,n,i){return this.copySampleValue_(t-1)}});var tr;tr={TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:2301,InterpolantFactoryMethodDiscrete:function(t){return new bn(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodLinear:function(t){return new xn(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:function(t){return new yn(this.times,this.values,this.getValueSize(),t)},setInterpolation:function(t){var e;switch(t){case 2300:e=this.InterpolantFactoryMethodDiscrete;break;case 2301:e=this.InterpolantFactoryMethodLinear;break;case 2302:e=this.InterpolantFactoryMethodSmooth}if(void 0===e){if(e="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name,void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw Error(e);this.setInterpolation(this.DefaultInterpolation)}console.warn(e)}else this.createInterpolant=e},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}},getValueSize:function(){return this.values.length/this.times.length},shift:function(t){if(0!==t)for(var e=this.times,n=0,i=e.length;n!==i;++n)e[n]+=t;return this},scale:function(t){if(1!==t)for(var e=this.times,n=0,i=e.length;n!==i;++n)e[n]*=t;return this},trim:function(e,n){for(var i=this.times,r=i.length,a=0,o=r-1;a!==r&&i[a]<e;)++a;for(;-1!==o&&i[o]>n;)--o;return++o,0===a&&o===r||(a>=o&&(o=Math.max(o,1),a=o-1),r=this.getValueSize(),this.times=t.AnimationUtils.arraySlice(i,a,o),this.values=t.AnimationUtils.arraySlice(this.values,a*r,o*r)),this},validate:function(){var e=!0,n=this.getValueSize();0!==n-Math.floor(n)&&(console.error("invalid value size in track",this),e=!1);var i=this.times,n=this.values,r=i.length;0===r&&(console.error("track is empty",this),e=!1);for(var a=null,o=0;o!==r;o++){var s=i[o];if("number"==typeof s&&isNaN(s)){console.error("time is not a valid number",this,o,s),e=!1;break}if(null!==a&&a>s){console.error("out of order keys",this,o,s,a),e=!1;break}a=s}if(void 0!==n&&t.AnimationUtils.isTypedArray(n))for(o=0,i=n.length;o!==i;++o)if(r=n[o],isNaN(r)){console.error("value is not a valid number",this,o,r),e=!1;break}return e},optimize:function(){for(var e=this.times,n=this.values,i=this.getValueSize(),r=2302===this.getInterpolation(),a=1,o=e.length-1,s=1;s<o;++s){var c=!1,l=e[s];if(l!==e[s+1]&&(1!==s||l!==l[0]))if(r)c=!0;else for(var h=s*i,u=h-i,d=h+i,l=0;l!==i;++l){var p=n[h+l];if(p!==n[u+l]||p!==n[d+l]){c=!0;break}}if(c){if(s!==a)for(e[a]=e[s],c=s*i,h=a*i,l=0;l!==i;++l)n[h+l]=n[c+l];++a}}if(0<o){for(e[a]=e[o],c=o*i,h=a*i,l=0;l!==i;++l)n[h+l]=n[c+l];++a}return a!==e.length&&(this.times=t.AnimationUtils.arraySlice(e,0,a),this.values=t.AnimationUtils.arraySlice(n,0,a*i)),this}},_n.prototype=Object.assign(Object.create(tr),{constructor:_n,ValueTypeName:"vector"}),Mn.prototype=Object.assign(Object.create(vn.prototype),{constructor:Mn,interpolate_:function(t,e,n,i){var r=this.resultBuffer,a=this.sampleValues,o=this.valueSize;for(t*=o,e=(n-e)/(i-e),n=t+o;t!==n;t+=4)s.slerpFlat(r,0,a,t-o,a,t,e);return r}}),En.prototype=Object.assign(Object.create(tr),{constructor:En,ValueTypeName:"quaternion",DefaultInterpolation:2301,InterpolantFactoryMethodLinear:function(t){return new Mn(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:void 0}),Tn.prototype=Object.assign(Object.create(tr),{constructor:Tn,ValueTypeName:"number"}),Sn.prototype=Object.assign(Object.create(tr),{constructor:Sn,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),An.prototype=Object.assign(Object.create(tr),{constructor:An,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Rn.prototype=Object.assign(Object.create(tr),{constructor:Rn,ValueTypeName:"color"}),Ln.prototype=tr,tr.constructor=Ln,Object.assign(Ln,{parse:function(e){if(void 0===e.type)throw Error("track type undefined, can not parse");var n=Ln._getTrackTypeForValueTypeName(e.type);if(void 0===e.times){var i=[],r=[];t.AnimationUtils.flattenJSON(e.keys,i,r,"value"),e.times=i,e.values=r}return void 0!==n.parse?n.parse(e):new n(e.name,e.times,e.values,e.interpolation)},toJSON:function(e){var n=e.constructor;if(void 0!==n.toJSON)n=n.toJSON(e);else{var n={name:e.name,times:t.AnimationUtils.convertArray(e.times,Array),values:t.AnimationUtils.convertArray(e.values,Array)},i=e.getInterpolation();i!==e.DefaultInterpolation&&(n.interpolation=i)}return n.type=e.ValueTypeName,n},_getTrackTypeForValueTypeName:function(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Tn;case"vector":case"vector2":case"vector3":case"vector4":return _n;case"color":return Rn;case"quaternion":return En;case"bool":case"boolean":return An;case"string":return Sn}throw Error("Unsupported typeName: "+t)}}),Cn.prototype={constructor:Cn,resetDuration:function(){for(var t=0,e=0,n=this.tracks.length;e!==n;++e)var i=this.tracks[e],t=Math.max(t,i.times[i.times.length-1]);this.duration=t},trim:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this},optimize:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this}},Object.assign(Cn,{parse:function(t){for(var e=[],n=t.tracks,i=1/(t.fps||1),r=0,a=n.length;r!==a;++r)e.push(Ln.parse(n[r]).scale(i));return new Cn(t.name,t.duration,e)},toJSON:function(t){var e=[],n=t.tracks;t={name:t.name,duration:t.duration,tracks:e};for(var i=0,r=n.length;i!==r;++i)e.push(Ln.toJSON(n[i]));return t},CreateFromMorphTargetSequence:function(e,n,i,r){for(var a=n.length,o=[],s=0;s<a;s++){var c=[],l=[];c.push((s+a-1)%a,s,(s+1)%a),l.push(0,1,0);var h=t.AnimationUtils.getKeyframeOrder(c),c=t.AnimationUtils.sortedArray(c,1,h),l=t.AnimationUtils.sortedArray(l,1,h);r||0!==c[0]||(c.push(a),l.push(l[0])),o.push(new Tn(".morphTargetInfluences["+n[s].name+"]",c,l).scale(1/i))}return new Cn(e,(-1),o)},findByName:function(t,e){var n=t;Array.isArray(t)||(n=t.geometry&&t.geometry.animations||t.animations);for(var i=0;i<n.length;i++)if(n[i].name===e)return n[i];return null},CreateClipsFromMorphTargetSequences:function(t,e,n){for(var i={},r=/^([\w-]*?)([\d]+)$/,a=0,o=t.length;a<o;a++){var s=t[a],c=s.name.match(r);if(c&&1<c.length){var l=c[1];(c=i[l])||(i[l]=c=[]),c.push(s)}}t=[];for(l in i)t.push(Cn.CreateFromMorphTargetSequence(l,i[l],e,n));return t},parseAnimation:function(e,n){if(!e)return console.error("  no animation in JSONLoader data"),null;for(var i=function(e,n,i,r,a){if(0!==i.length){var o=[],s=[];t.AnimationUtils.flattenJSON(i,o,s,r),0!==o.length&&a.push(new e(n,o,s))}},r=[],a=e.name||"default",o=e.length||-1,s=e.fps||30,c=e.hierarchy||[],l=0;l<c.length;l++){var h=c[l].keys;if(h&&0!==h.length)if(h[0].morphTargets){for(var o={},u=0;u<h.length;u++)if(h[u].morphTargets)for(var d=0;d<h[u].morphTargets.length;d++)o[h[u].morphTargets[d]]=-1;for(var p in o){for(var f=[],m=[],d=0;d!==h[u].morphTargets.length;++d){var g=h[u];f.push(g.time),m.push(g.morphTarget===p?1:0)}r.push(new Tn(".morphTargetInfluence["+p+"]",f,m))}o=o.length*(s||1)}else u=".bones["+n[l].name+"]",i(_n,u+".position",h,"pos",r),i(En,u+".quaternion",h,"rot",r),i(_n,u+".scale",h,"scl",r)}return 0===r.length?null:new Cn(a,o,r)}}),Object.assign(Pn.prototype,{load:function(t,e,n,i){var r=this;new en(r.manager).load(t,function(t){e(r.parse(JSON.parse(t)))},n,i)},setTextures:function(t){this.textures=t},parse:function(t){function e(t){return void 0===i[t]&&console.warn("THREE.MaterialLoader: Undefined texture",t),i[t]}var i=this.textures,r=new $i[t.type];if(void 0!==t.uuid&&(r.uuid=t.uuid),void 0!==t.name&&(r.name=t.name),void 0!==t.color&&r.color.setHex(t.color),void 0!==t.roughness&&(r.roughness=t.roughness),void 0!==t.metalness&&(r.metalness=t.metalness),void 0!==t.emissive&&r.emissive.setHex(t.emissive),void 0!==t.specular&&r.specular.setHex(t.specular),void 0!==t.shininess&&(r.shininess=t.shininess),void 0!==t.uniforms&&(r.uniforms=t.uniforms),void 0!==t.vertexShader&&(r.vertexShader=t.vertexShader),void 0!==t.fragmentShader&&(r.fragmentShader=t.fragmentShader),void 0!==t.vertexColors&&(r.vertexColors=t.vertexColors),void 0!==t.fog&&(r.fog=t.fog),void 0!==t.shading&&(r.shading=t.shading),void 0!==t.blending&&(r.blending=t.blending),void 0!==t.side&&(r.side=t.side),void 0!==t.opacity&&(r.opacity=t.opacity),void 0!==t.transparent&&(r.transparent=t.transparent),void 0!==t.alphaTest&&(r.alphaTest=t.alphaTest),void 0!==t.depthTest&&(r.depthTest=t.depthTest),void 0!==t.depthWrite&&(r.depthWrite=t.depthWrite),void 0!==t.colorWrite&&(r.colorWrite=t.colorWrite),void 0!==t.wireframe&&(r.wireframe=t.wireframe),void 0!==t.wireframeLinewidth&&(r.wireframeLinewidth=t.wireframeLinewidth),void 0!==t.wireframeLinecap&&(r.wireframeLinecap=t.wireframeLinecap),void 0!==t.wireframeLinejoin&&(r.wireframeLinejoin=t.wireframeLinejoin),void 0!==t.skinning&&(r.skinning=t.skinning),void 0!==t.morphTargets&&(r.morphTargets=t.morphTargets),void 0!==t.size&&(r.size=t.size),void 0!==t.sizeAttenuation&&(r.sizeAttenuation=t.sizeAttenuation),void 0!==t.map&&(r.map=e(t.map)),void 0!==t.alphaMap&&(r.alphaMap=e(t.alphaMap),r.transparent=!0),void 0!==t.bumpMap&&(r.bumpMap=e(t.bumpMap)),void 0!==t.bumpScale&&(r.bumpScale=t.bumpScale),void 0!==t.normalMap&&(r.normalMap=e(t.normalMap)),void 0!==t.normalScale){var a=t.normalScale;!1===Array.isArray(a)&&(a=[a,a]),r.normalScale=(new n).fromArray(a)}if(void 0!==t.displacementMap&&(r.displacementMap=e(t.displacementMap)),void 0!==t.displacementScale&&(r.displacementScale=t.displacementScale),void 0!==t.displacementBias&&(r.displacementBias=t.displacementBias),void 0!==t.roughnessMap&&(r.roughnessMap=e(t.roughnessMap)),void 0!==t.metalnessMap&&(r.metalnessMap=e(t.metalnessMap)),void 0!==t.emissiveMap&&(r.emissiveMap=e(t.emissiveMap)),void 0!==t.emissiveIntensity&&(r.emissiveIntensity=t.emissiveIntensity),void 0!==t.specularMap&&(r.specularMap=e(t.specularMap)),void 0!==t.envMap&&(r.envMap=e(t.envMap)),void 0!==t.reflectivity&&(r.reflectivity=t.reflectivity),void 0!==t.lightMap&&(r.lightMap=e(t.lightMap)),void 0!==t.lightMapIntensity&&(r.lightMapIntensity=t.lightMapIntensity),void 0!==t.aoMap&&(r.aoMap=e(t.aoMap)),void 0!==t.aoMapIntensity&&(r.aoMapIntensity=t.aoMapIntensity),void 0!==t.materials)for(var a=0,o=t.materials.length;a<o;a++)r.materials.push(this.parse(t.materials[a]));return r}}),Object.assign(In.prototype,{load:function(t,e,n,i){var r=this;new en(r.manager).load(t,function(t){e(r.parse(JSON.parse(t)))},n,i)},parse:function(t){var e=new mt,n=t.data.index,i={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:Uint8ClampedArray,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};void 0!==n&&(n=new i[n.type](n.array),e.setIndex(new lt(n,1)));var r,a=t.data.attributes;for(r in a){var o=a[r],n=new i[o.type](o.array);e.addAttribute(r,new lt(n,o.itemSize,o.normalized))}if(i=t.data.groups||t.data.drawcalls||t.data.offsets,void 0!==i)for(r=0,n=i.length;r!==n;++r)a=i[r],e.addGroup(a.start,a.count,a.materialIndex);return t=t.data.boundingSphere,void 0!==t&&(i=new c,void 0!==t.center&&i.fromArray(t.center),e.boundingSphere=new J(i,t.radius)),e}}),Un.prototype={constructor:Un,crossOrigin:void 0,extractUrlBase:function(t){return t=t.split("/"),1===t.length?"./":(t.pop(),t.join("/")+"/")},initMaterials:function(t,e,n){for(var i=[],r=0;r<t.length;++r)i[r]=this.createMaterial(t[r],e,n);return i},createMaterial:function(){var e,n,i;return function(r,a,o){function s(e,i,r,s,c){e=a+e;var h=Un.Handlers.get(e);return null!==h?e=h.load(e):(n.setCrossOrigin(o),e=n.load(e)),void 0!==i&&(e.repeat.fromArray(i),1!==i[0]&&(e.wrapS=1e3),1!==i[1]&&(e.wrapT=1e3)),void 0!==r&&e.offset.fromArray(r),void 0!==s&&("repeat"===s[0]&&(e.wrapS=1e3),"mirror"===s[0]&&(e.wrapS=1002),"repeat"===s[1]&&(e.wrapT=1e3),"mirror"===s[1]&&(e.wrapT=1002)),void 0!==c&&(e.anisotropy=c),i=t.Math.generateUUID(),l[i]=e,i}void 0===e&&(e=new k),void 0===n&&(n=new sn),void 0===i&&(i=new Pn);var c,l={},h={uuid:t.Math.generateUUID(),type:"MeshLambertMaterial"};for(c in r){var u=r[c];switch(c){case"DbgColor":case"DbgIndex":case"opticalDensity":case"illumination":break;case"DbgName":h.name=u;break;case"blending":h.blending=Di[u];break;case"colorAmbient":case"mapAmbient":console.warn("THREE.Loader.createMaterial:",c,"is no longer supported.");break;case"colorDiffuse":h.color=e.fromArray(u).getHex();break;case"colorSpecular":h.specular=e.fromArray(u).getHex();break;case"colorEmissive":h.emissive=e.fromArray(u).getHex();break;case"specularCoef":h.shininess=u;break;case"shading":"basic"===u.toLowerCase()&&(h.type="MeshBasicMaterial"),"phong"===u.toLowerCase()&&(h.type="MeshPhongMaterial"),"standard"===u.toLowerCase()&&(h.type="MeshStandardMaterial");break;case"mapDiffuse":h.map=s(u,r.mapDiffuseRepeat,r.mapDiffuseOffset,r.mapDiffuseWrap,r.mapDiffuseAnisotropy);break;case"mapDiffuseRepeat":case"mapDiffuseOffset":case"mapDiffuseWrap":case"mapDiffuseAnisotropy":break;case"mapEmissive":h.emissiveMap=s(u,r.mapEmissiveRepeat,r.mapEmissiveOffset,r.mapEmissiveWrap,r.mapEmissiveAnisotropy);break;case"mapEmissiveRepeat":case"mapEmissiveOffset":case"mapEmissiveWrap":case"mapEmissiveAnisotropy":break;case"mapLight":h.lightMap=s(u,r.mapLightRepeat,r.mapLightOffset,r.mapLightWrap,r.mapLightAnisotropy);break;case"mapLightRepeat":case"mapLightOffset":case"mapLightWrap":case"mapLightAnisotropy":break;case"mapAO":h.aoMap=s(u,r.mapAORepeat,r.mapAOOffset,r.mapAOWrap,r.mapAOAnisotropy);break;case"mapAORepeat":case"mapAOOffset":case"mapAOWrap":case"mapAOAnisotropy":break;case"mapBump":h.bumpMap=s(u,r.mapBumpRepeat,r.mapBumpOffset,r.mapBumpWrap,r.mapBumpAnisotropy);break;case"mapBumpScale":h.bumpScale=u;break;case"mapBumpRepeat":case"mapBumpOffset":case"mapBumpWrap":case"mapBumpAnisotropy":break;case"mapNormal":h.normalMap=s(u,r.mapNormalRepeat,r.mapNormalOffset,r.mapNormalWrap,r.mapNormalAnisotropy);break;case"mapNormalFactor":h.normalScale=[u,u];break;case"mapNormalRepeat":case"mapNormalOffset":case"mapNormalWrap":case"mapNormalAnisotropy":break;case"mapSpecular":h.specularMap=s(u,r.mapSpecularRepeat,r.mapSpecularOffset,r.mapSpecularWrap,r.mapSpecularAnisotropy);break;case"mapSpecularRepeat":case"mapSpecularOffset":case"mapSpecularWrap":case"mapSpecularAnisotropy":break;case"mapMetalness":h.metalnessMap=s(u,r.mapMetalnessRepeat,r.mapMetalnessOffset,r.mapMetalnessWrap,r.mapMetalnessAnisotropy);break;case"mapMetalnessRepeat":case"mapMetalnessOffset":case"mapMetalnessWrap":case"mapMetalnessAnisotropy":break;case"mapRoughness":h.roughnessMap=s(u,r.mapRoughnessRepeat,r.mapRoughnessOffset,r.mapRoughnessWrap,r.mapRoughnessAnisotropy);break;case"mapRoughnessRepeat":case"mapRoughnessOffset":case"mapRoughnessWrap":case"mapRoughnessAnisotropy":break;case"mapAlpha":h.alphaMap=s(u,r.mapAlphaRepeat,r.mapAlphaOffset,r.mapAlphaWrap,r.mapAlphaAnisotropy);break;case"mapAlphaRepeat":case"mapAlphaOffset":case"mapAlphaWrap":case"mapAlphaAnisotropy":break;case"flipSided":h.side=1;break;case"doubleSided":h.side=2;break;case"transparency":console.warn("THREE.Loader.createMaterial: transparency has been renamed to opacity"),h.opacity=u;break;case"depthTest":case"depthWrite":case"colorWrite":case"opacity":case"reflectivity":case"transparent":case"visible":case"wireframe":h[c]=u;break;case"vertexColors":!0===u&&(h.vertexColors=2),"face"===u&&(h.vertexColors=1);break;default:console.error("THREE.Loader.createMaterial: Unsupported",c,u)}}return"MeshBasicMaterial"===h.type&&delete h.emissive,"MeshPhongMaterial"!==h.type&&delete h.specular,1>h.opacity&&(h.transparent=!0),i.setTextures(l),i.parse(h)}}()},Un.Handlers={handlers:[],add:function(t,e){this.handlers.push(t,e)},get:function(t){for(var e=this.handlers,n=0,i=e.length;n<i;n+=2){var r=e[n+1];if(e[n].test(t))return r}return null}},Object.assign(Nn.prototype,{load:function(t,e,n,i){var r=this,a=this.texturePath&&"string"==typeof this.texturePath?this.texturePath:Un.prototype.extractUrlBase(t),o=new en(this.manager);o.setWithCredentials(this.withCredentials),o.load(t,function(n){n=JSON.parse(n);var i=n.metadata;if(void 0!==i&&(i=i.type,void 0!==i)){if("object"===i.toLowerCase())return void console.error("THREE.JSONLoader: "+t+" should be loaded with THREE.ObjectLoader instead.");if("scene"===i.toLowerCase())return void console.error("THREE.JSONLoader: "+t+" should be loaded with THREE.SceneLoader instead.")}n=r.parse(n,a),e(n.geometry,n.materials)},n,i)},setTexturePath:function(t){this.texturePath=t},parse:function(t,e){var i=new pt,a=void 0!==t.scale?1/t.scale:1;return function(e){var r,a,o,s,l,h,u,d,p,f,m,g,v,y=t.faces;h=t.vertices;var x=t.normals,b=t.colors,w=0;if(void 0!==t.uvs){for(r=0;r<t.uvs.length;r++)t.uvs[r].length&&w++;for(r=0;r<w;r++)i.faceVertexUvs[r]=[]}for(s=0,l=h.length;s<l;)r=new c,r.x=h[s++]*e,r.y=h[s++]*e,r.z=h[s++]*e,i.vertices.push(r);for(s=0,l=y.length;s<l;)if(e=y[s++],p=1&e,o=2&e,r=8&e,u=16&e,f=32&e,h=64&e,e&=128,p){if(p=new st,p.a=y[s],p.b=y[s+1],p.c=y[s+3],m=new st,m.a=y[s+1],m.b=y[s+2],m.c=y[s+3],s+=4,o&&(o=y[s++],p.materialIndex=o,m.materialIndex=o),o=i.faces.length,r)for(r=0;r<w;r++)for(g=t.uvs[r],i.faceVertexUvs[r][o]=[],i.faceVertexUvs[r][o+1]=[],a=0;4>a;a++)d=y[s++],v=g[2*d],d=g[2*d+1],v=new n(v,d),2!==a&&i.faceVertexUvs[r][o].push(v),0!==a&&i.faceVertexUvs[r][o+1].push(v);if(u&&(u=3*y[s++],p.normal.set(x[u++],x[u++],x[u]),m.normal.copy(p.normal)),f)for(r=0;4>r;r++)u=3*y[s++],f=new c(x[u++],x[u++],x[u]),2!==r&&p.vertexNormals.push(f),0!==r&&m.vertexNormals.push(f);if(h&&(h=y[s++],h=b[h],p.color.setHex(h),m.color.setHex(h)),e)for(r=0;4>r;r++)h=y[s++],h=b[h],2!==r&&p.vertexColors.push(new k(h)),0!==r&&m.vertexColors.push(new k(h));i.faces.push(p),i.faces.push(m)}else{if(p=new st,p.a=y[s++],p.b=y[s++],p.c=y[s++],o&&(o=y[s++],p.materialIndex=o),o=i.faces.length,r)for(r=0;r<w;r++)for(g=t.uvs[r],i.faceVertexUvs[r][o]=[],a=0;3>a;a++)d=y[s++],v=g[2*d],d=g[2*d+1],v=new n(v,d),i.faceVertexUvs[r][o].push(v);if(u&&(u=3*y[s++],p.normal.set(x[u++],x[u++],x[u])),f)for(r=0;3>r;r++)u=3*y[s++],f=new c(x[u++],x[u++],x[u]),p.vertexNormals.push(f);if(h&&(h=y[s++],p.color.setHex(b[h])),e)for(r=0;3>r;r++)h=y[s++],p.vertexColors.push(new k(b[h]));i.faces.push(p)}}(a),function(){var e=void 0!==t.influencesPerVertex?t.influencesPerVertex:2;if(t.skinWeights)for(var n=0,a=t.skinWeights.length;n<a;n+=e)i.skinWeights.push(new r(t.skinWeights[n],1<e?t.skinWeights[n+1]:0,2<e?t.skinWeights[n+2]:0,3<e?t.skinWeights[n+3]:0));if(t.skinIndices)for(n=0,a=t.skinIndices.length;n<a;n+=e)i.skinIndices.push(new r(t.skinIndices[n],1<e?t.skinIndices[n+1]:0,2<e?t.skinIndices[n+2]:0,3<e?t.skinIndices[n+3]:0));i.bones=t.bones,i.bones&&0<i.bones.length&&(i.skinWeights.length!==i.skinIndices.length||i.skinIndices.length!==i.vertices.length)&&console.warn("When skinning, number of vertices ("+i.vertices.length+"), skinIndices ("+i.skinIndices.length+"), and skinWeights ("+i.skinWeights.length+") should match.")}(),function(e){if(void 0!==t.morphTargets)for(var n=0,r=t.morphTargets.length;n<r;n++){i.morphTargets[n]={},i.morphTargets[n].name=t.morphTargets[n].name,i.morphTargets[n].vertices=[];for(var a=i.morphTargets[n].vertices,o=t.morphTargets[n].vertices,s=0,l=o.length;s<l;s+=3){var h=new c;h.x=o[s]*e,h.y=o[s+1]*e,h.z=o[s+2]*e,a.push(h)}}if(void 0!==t.morphColors&&0<t.morphColors.length)for(console.warn('THREE.JSONLoader: "morphColors" no longer supported. Using them as face colors.'),e=i.faces,a=t.morphColors[0].colors,n=0,r=e.length;n<r;n++)e[n].color.fromArray(a,3*n)}(a),function(){var e=[],n=[];void 0!==t.animation&&n.push(t.animation),void 0!==t.animations&&(t.animations.length?n=n.concat(t.animations):n.push(t.animations));for(var r=0;r<n.length;r++){var a=Cn.parseAnimation(n[r],i.bones);a&&e.push(a)}i.morphTargets&&(n=Cn.CreateClipsFromMorphTargetSequences(i.morphTargets,10),e=e.concat(n)),0<e.length&&(i.animations=e)}(),i.computeFaceNormals(),i.computeBoundingSphere(),void 0===t.materials||0===t.materials.length?{geometry:i}:(a=Un.prototype.initMaterials(t.materials,e,this.crossOrigin),{geometry:i,materials:a})}}),Object.assign(Dn.prototype,{load:function(t,e,n,i){""===this.texturePath&&(this.texturePath=t.substring(0,t.lastIndexOf("/")+1));var r=this;new en(r.manager).load(t,function(t){r.parse(JSON.parse(t),e)},n,i)},setTexturePath:function(t){this.texturePath=t},setCrossOrigin:function(t){this.crossOrigin=t},parse:function(t,e){var n=this.parseGeometries(t.geometries),i=this.parseImages(t.images,function(){void 0!==e&&e(r)}),i=this.parseTextures(t.textures,i),i=this.parseMaterials(t.materials,i),r=this.parseObject(t.object,n,i);return t.animations&&(r.animations=this.parseAnimations(t.animations)),void 0!==t.images&&0!==t.images.length||void 0===e||e(r),r},parseGeometries:function(t){var e={};if(void 0!==t)for(var n=new Nn,i=new In,r=0,a=t.length;r<a;r++){var o,s=t[r];switch(s.type){case"PlaneGeometry":case"PlaneBufferGeometry":o=new Ki[s.type](s.width,s.height,s.widthSegments,s.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":o=new Ki[s.type](s.width,s.height,s.depth,s.widthSegments,s.heightSegments,s.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":o=new Ki[s.type](s.radius,s.segments,s.thetaStart,s.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":o=new Ki[s.type](s.radiusTop,s.radiusBottom,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":o=new Ki[s.type](s.radius,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":o=new Ki[s.type](s.radius,s.widthSegments,s.heightSegments,s.phiStart,s.phiLength,s.thetaStart,s.thetaLength);break;case"DodecahedronGeometry":case"IcosahedronGeometry":case"OctahedronGeometry":case"TetrahedronGeometry":o=new Ki[s.type](s.radius,s.detail);break;case"RingGeometry":case"RingBufferGeometry":o=new Ki[s.type](s.innerRadius,s.outerRadius,s.thetaSegments,s.phiSegments,s.thetaStart,s.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":o=new Ki[s.type](s.radius,s.tube,s.radialSegments,s.tubularSegments,s.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":o=new Ki[s.type](s.radius,s.tube,s.tubularSegments,s.radialSegments,s.p,s.q);break;case"LatheGeometry":case"LatheBufferGeometry":o=new Ki[s.type](s.points,s.segments,s.phiStart,s.phiLength);break;case"BufferGeometry":o=i.parse(s);break;case"Geometry":o=n.parse(s.data,this.texturePath).geometry;break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+s.type+'"');continue}o.uuid=s.uuid,void 0!==s.name&&(o.name=s.name),e[s.uuid]=o}return e},parseMaterials:function(t,e){var n={};if(void 0!==t){var i=new Pn;i.setTextures(e);for(var r=0,a=t.length;r<a;r++){var o=i.parse(t[r]);n[o.uuid]=o}}return n},parseAnimations:function(t){for(var e=[],n=0;n<t.length;n++){var i=Cn.parse(t[n]);e.push(i)}return e},parseImages:function(t,e){function n(t){return i.manager.itemStart(t),o.load(t,function(){i.manager.itemEnd(t)},void 0,function(){i.manager.itemError(t)})}var i=this,r={};if(void 0!==t&&0<t.length){var a=new tn(e),o=new an(a);o.setCrossOrigin(this.crossOrigin);for(var a=0,s=t.length;a<s;a++){var c=t[a],l=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(c.url)?c.url:i.texturePath+c.url;r[c.uuid]=n(l)}}return r},parseTextures:function(t,e){function n(t,e){return"number"==typeof t?t:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",t),e[t])}var r={};if(void 0!==t)for(var a=0,o=t.length;a<o;a++){var s=t[a];void 0===s.image&&console.warn('THREE.ObjectLoader: No "image" specified for',s.uuid),void 0===e[s.image]&&console.warn("THREE.ObjectLoader: Undefined image",s.image);var c=new i(e[s.image]);c.needsUpdate=!0,c.uuid=s.uuid,void 0!==s.name&&(c.name=s.name),void 0!==s.mapping&&(c.mapping=n(s.mapping,Fi)),void 0!==s.offset&&c.offset.fromArray(s.offset),void 0!==s.repeat&&c.repeat.fromArray(s.repeat),void 0!==s.wrap&&(c.wrapS=n(s.wrap[0],Oi),c.wrapT=n(s.wrap[1],Oi)),void 0!==s.minFilter&&(c.minFilter=n(s.minFilter,Bi)),void 0!==s.magFilter&&(c.magFilter=n(s.magFilter,Bi)),void 0!==s.anisotropy&&(c.anisotropy=s.anisotropy),void 0!==s.flipY&&(c.flipY=s.flipY),r[s.uuid]=c}return r},parseObject:function(){var t=new l;return function(e,n,i){function r(t){return void 0===n[t]&&console.warn("THREE.ObjectLoader: Undefined geometry",t),n[t]}function a(t){if(void 0!==t)return void 0===i[t]&&console.warn("THREE.ObjectLoader: Undefined material",t),i[t]}var o;switch(e.type){case"Scene":o=new Jt,void 0!==e.background&&Number.isInteger(e.background)&&(o.background=new k(e.background)),void 0!==e.fog&&("Fog"===e.fog.type?o.fog=new Zt(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(o.fog=new Yt(e.fog.color,e.fog.density)));break;case"PerspectiveCamera":o=new bt(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(o.focus=e.focus),void 0!==e.zoom&&(o.zoom=e.zoom),void 0!==e.filmGauge&&(o.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(o.filmOffset=e.filmOffset),void 0!==e.view&&(o.view=Object.assign({},e.view));break;case"OrthographicCamera":o=new wt(e.left,e.right,e.top,e.bottom,e.near,e.far);break;case"AmbientLight":o=new gn(e.color,e.intensity);break;case"DirectionalLight":o=new mn(e.color,e.intensity);break;case"PointLight":o=new pn(e.color,e.intensity,e.distance,e.decay);break;case"SpotLight":o=new dn(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":o=new ln(e.color,e.groundColor,e.intensity);break;case"Mesh":o=r(e.geometry);var s=a(e.material);o=o.bones&&0<o.bones.length?new re(o,s):new gt(o,s);break;case"LOD":o=new te;break;case"Line":o=new oe(r(e.geometry),a(e.material),e.mode);break;case"LineSegments":o=new se(r(e.geometry),a(e.material));break;case"PointCloud":case"Points":o=new le(r(e.geometry),a(e.material));break;case"Sprite":o=new $t(a(e.material));break;case"Group":o=new he;break;default:o=new rt}if(o.uuid=e.uuid,void 0!==e.name&&(o.name=e.name),void 0!==e.matrix?(t.fromArray(e.matrix),t.decompose(o.position,o.quaternion,o.scale)):(void 0!==e.position&&o.position.fromArray(e.position),void 0!==e.rotation&&o.rotation.fromArray(e.rotation),void 0!==e.quaternion&&o.quaternion.fromArray(e.quaternion),void 0!==e.scale&&o.scale.fromArray(e.scale)),void 0!==e.castShadow&&(o.castShadow=e.castShadow),void 0!==e.receiveShadow&&(o.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.bias&&(o.shadow.bias=e.shadow.bias),void 0!==e.shadow.radius&&(o.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&o.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera&&(o.shadow.camera=this.parseObject(e.shadow.camera))),void 0!==e.visible&&(o.visible=e.visible),void 0!==e.userData&&(o.userData=e.userData),void 0!==e.children)for(var c in e.children)o.add(this.parseObject(e.children[c],n,i));if("LOD"===e.type)for(e=e.levels,s=0;s<e.length;s++){var l=e[s];
c=o.getObjectByProperty("uuid",l.object),void 0!==c&&o.addLevel(c,l.distance)}return o}}()}),Fn.prototype={constructor:Fn,getPoint:function(t){return console.warn("THREE.Curve: Warning, getPoint() not implemented!"),null},getPointAt:function(t){return t=this.getUtoTmapping(t),this.getPoint(t)},getPoints:function(t){t||(t=5);for(var e=[],n=0;n<=t;n++)e.push(this.getPoint(n/t));return e},getSpacedPoints:function(t){t||(t=5);for(var e=[],n=0;n<=t;n++)e.push(this.getPointAt(n/t));return e},getLength:function(){var t=this.getLengths();return t[t.length-1]},getLengths:function(t){if(t||(t=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var e,n,i=[],r=this.getPoint(0),a=0;for(i.push(0),n=1;n<=t;n++)e=this.getPoint(n/t),a+=e.distanceTo(r),i.push(a),r=e;return this.cacheArcLengths=i},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(t,e){var n,i,r=this.getLengths(),a=r.length;i=e?e:t*r[a-1];for(var o,s=0,c=a-1;s<=c;)if(n=Math.floor(s+(c-s)/2),o=r[n]-i,0>o)s=n+1;else{if(!(0<o)){c=n;break}c=n-1}return n=c,r[n]===i?n/(a-1):(s=r[n],(n+(i-s)/(r[n+1]-s))/(a-1))},getTangent:function(t){var e=t-1e-4;return t+=1e-4,0>e&&(e=0),1<t&&(t=1),e=this.getPoint(e),this.getPoint(t).clone().sub(e).normalize()},getTangentAt:function(t){return t=this.getUtoTmapping(t),this.getTangent(t)}},Fn.create=function(t,e){return t.prototype=Object.create(Fn.prototype),t.prototype.constructor=t,t.prototype.getPoint=e,t},On.prototype=Object.create(Fn.prototype),On.prototype.constructor=On,On.prototype.isLineCurve=!0,On.prototype.getPoint=function(t){if(1===t)return this.v2.clone();var e=this.v2.clone().sub(this.v1);return e.multiplyScalar(t).add(this.v1),e},On.prototype.getPointAt=function(t){return this.getPoint(t)},On.prototype.getTangent=function(t){return this.v2.clone().sub(this.v1).normalize()},Bn.prototype=Object.assign(Object.create(Fn.prototype),{constructor:Bn,add:function(t){this.curves.push(t)},closePath:function(){var t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);t.equals(e)||this.curves.push(new On(e,t))},getPoint:function(t){var e=t*this.getLength(),n=this.getCurveLengths();for(t=0;t<n.length;){if(n[t]>=e)return e=n[t]-e,t=this.curves[t],n=t.getLength(),t.getPointAt(0===n?0:1-e/n);t++}return null},getLength:function(){var t=this.getCurveLengths();return t[t.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var t=[],e=0,n=0,i=this.curves.length;n<i;n++)e+=this.curves[n].getLength(),t.push(e);return this.cacheLengths=t},getSpacedPoints:function(t){t||(t=40);for(var e=[],n=0;n<=t;n++)e.push(this.getPoint(n/t));return this.autoClose&&e.push(e[0]),e},getPoints:function(t){t=t||12;for(var e,n=[],i=0,r=this.curves;i<r.length;i++)for(var a=r[i],a=a.getPoints(a&&a.isEllipseCurve?2*t:a&&a.isLineCurve?1:a&&a.isSplineCurve?t*a.points.length:t),o=0;o<a.length;o++){var s=a[o];e&&e.equals(s)||(n.push(s),e=s)}return this.autoClose&&1<n.length&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n},createPointsGeometry:function(t){return t=this.getPoints(t),this.createGeometry(t)},createSpacedPointsGeometry:function(t){return t=this.getSpacedPoints(t),this.createGeometry(t)},createGeometry:function(t){for(var e=new pt,n=0,i=t.length;n<i;n++){var r=t[n];e.vertices.push(new c(r.x,r.y,r.z||0))}return e}}),zn.prototype=Object.create(Fn.prototype),zn.prototype.constructor=zn,zn.prototype.isEllipseCurve=!0,zn.prototype.getPoint=function(t){for(var e=2*Math.PI,i=this.aEndAngle-this.aStartAngle,r=Math.abs(i)<Number.EPSILON;0>i;)i+=e;for(;i>e;)i-=e;i<Number.EPSILON&&(i=r?0:e),!0!==this.aClockwise||r||(i=i===e?-e:i-e),e=this.aStartAngle+t*i,t=this.aX+this.xRadius*Math.cos(e);var a=this.aY+this.yRadius*Math.sin(e);return 0!==this.aRotation&&(e=Math.cos(this.aRotation),i=Math.sin(this.aRotation),r=t-this.aX,a-=this.aY,t=r*e-a*i+this.aX,a=r*i+a*e+this.aY),new n(t,a)},t.CurveUtils={tangentQuadraticBezier:function(t,e,n,i){return 2*(1-t)*(n-e)+2*t*(i-n)},tangentCubicBezier:function(t,e,n,i,r){return-3*e*(1-t)*(1-t)+3*n*(1-t)*(1-t)-6*t*n*(1-t)+6*t*i*(1-t)-3*t*t*i+3*t*t*r},tangentSpline:function(t,e,n,i,r){return 6*t*t-6*t+(3*t*t-4*t+1)+(-6*t*t+6*t)+(3*t*t-2*t)},interpolate:function(t,e,n,i,r){t=.5*(n-t),i=.5*(i-e);var a=r*r;return(2*e-2*n+t+i)*r*a+(-3*e+3*n-2*t-i)*a+t*r+e}},Hn.prototype=Object.create(Fn.prototype),Hn.prototype.constructor=Hn,Hn.prototype.isSplineCurve=!0,Hn.prototype.getPoint=function(e){var i=this.points;e*=i.length-1;var r=Math.floor(e);e-=r;var a=i[0===r?r:r-1],o=i[r],s=i[r>i.length-2?i.length-1:r+1],i=i[r>i.length-3?i.length-1:r+2],r=t.CurveUtils.interpolate;return new n(r(a.x,o.x,s.x,i.x,e),r(a.y,o.y,s.y,i.y,e))},Gn.prototype=Object.create(Fn.prototype),Gn.prototype.constructor=Gn,Gn.prototype.getPoint=function(e){var i=t.ShapeUtils.b3;return new n(i(e,this.v0.x,this.v1.x,this.v2.x,this.v3.x),i(e,this.v0.y,this.v1.y,this.v2.y,this.v3.y))},Gn.prototype.getTangent=function(e){var i=t.CurveUtils.tangentCubicBezier;return new n(i(e,this.v0.x,this.v1.x,this.v2.x,this.v3.x),i(e,this.v0.y,this.v1.y,this.v2.y,this.v3.y)).normalize()},kn.prototype=Object.create(Fn.prototype),kn.prototype.constructor=kn,kn.prototype.getPoint=function(e){var i=t.ShapeUtils.b2;return new n(i(e,this.v0.x,this.v1.x,this.v2.x),i(e,this.v0.y,this.v1.y,this.v2.y))},kn.prototype.getTangent=function(e){var i=t.CurveUtils.tangentQuadraticBezier;return new n(i(e,this.v0.x,this.v1.x,this.v2.x),i(e,this.v0.y,this.v1.y,this.v2.y)).normalize()};var er=Object.assign(Object.create(Bn.prototype),{fromPoints:function(t){this.moveTo(t[0].x,t[0].y);for(var e=1,n=t.length;e<n;e++)this.lineTo(t[e].x,t[e].y)},moveTo:function(t,e){this.currentPoint.set(t,e)},lineTo:function(t,e){var i=new On(this.currentPoint.clone(),new n(t,e));this.curves.push(i),this.currentPoint.set(t,e)},quadraticCurveTo:function(t,e,i,r){t=new kn(this.currentPoint.clone(),new n(t,e),new n(i,r)),this.curves.push(t),this.currentPoint.set(i,r)},bezierCurveTo:function(t,e,i,r,a,o){t=new Gn(this.currentPoint.clone(),new n(t,e),new n(i,r),new n(a,o)),this.curves.push(t),this.currentPoint.set(a,o)},splineThru:function(t){var e=[this.currentPoint.clone()].concat(t),e=new Hn(e);this.curves.push(e),this.currentPoint.copy(t[t.length-1])},arc:function(t,e,n,i,r,a){this.absarc(t+this.currentPoint.x,e+this.currentPoint.y,n,i,r,a)},absarc:function(t,e,n,i,r,a){this.absellipse(t,e,n,n,i,r,a)},ellipse:function(t,e,n,i,r,a,o,s){this.absellipse(t+this.currentPoint.x,e+this.currentPoint.y,n,i,r,a,o,s)},absellipse:function(t,e,n,i,r,a,o,s){t=new zn(t,e,n,i,r,a,o,s),0<this.curves.length&&(e=t.getPoint(0),e.equals(this.currentPoint)||this.lineTo(e.x,e.y)),this.curves.push(t),t=t.getPoint(1),this.currentPoint.copy(t)}});Vn.prototype=Object.assign(Object.create(er),{constructor:Vn,getPointsHoles:function(t){for(var e=[],n=0,i=this.holes.length;n<i;n++)e[n]=this.holes[n].getPoints(t);return e},extractAllPoints:function(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}},extractPoints:function(t){return this.extractAllPoints(t)}}),jn.prototype=er,er.constructor=jn,Wn.prototype={moveTo:function(t,e){this.currentPath=new jn,this.subPaths.push(this.currentPath),this.currentPath.moveTo(t,e)},lineTo:function(t,e){this.currentPath.lineTo(t,e)},quadraticCurveTo:function(t,e,n,i){this.currentPath.quadraticCurveTo(t,e,n,i)},bezierCurveTo:function(t,e,n,i,r,a){this.currentPath.bezierCurveTo(t,e,n,i,r,a)},splineThru:function(t){this.currentPath.splineThru(t)},toShapes:function(e,n){function i(t){for(var e=[],n=0,i=t.length;n<i;n++){var r=t[n],a=new Vn;a.curves=r.curves,e.push(a)}return e}function r(t,e){for(var n=e.length,i=!1,r=n-1,a=0;a<n;r=a++){var o=e[r],s=e[a],c=s.x-o.x,l=s.y-o.y;if(Math.abs(l)>Number.EPSILON){if(0>l&&(o=e[a],c=-c,s=e[r],l=-l),!(t.y<o.y||t.y>s.y))if(t.y===o.y){if(t.x===o.x)return!0}else{if(r=l*(t.x-o.x)-c*(t.y-o.y),0===r)return!0;0>r||(i=!i)}}else if(t.y===o.y&&(s.x<=t.x&&t.x<=o.x||o.x<=t.x&&t.x<=s.x))return!0}return i}var a=t.ShapeUtils.isClockWise,o=this.subPaths;if(0===o.length)return[];if(!0===n)return i(o);var s,c,l,h=[];if(1===o.length)return c=o[0],l=new Vn,l.curves=c.curves,h.push(l),h;var u=!a(o[0].getPoints()),u=e?!u:u;l=[];var d,p=[],f=[],m=0;p[m]=void 0,f[m]=[];for(var g=0,v=o.length;g<v;g++)c=o[g],d=c.getPoints(),s=a(d),(s=e?!s:s)?(!u&&p[m]&&m++,p[m]={s:new Vn,p:d},p[m].s.curves=c.curves,u&&m++,f[m]=[]):f[m].push({h:c,p:d[0]});if(!p[0])return i(o);if(1<p.length){for(g=!1,c=[],a=0,o=p.length;a<o;a++)l[a]=[];for(a=0,o=p.length;a<o;a++)for(s=f[a],u=0;u<s.length;u++){for(m=s[u],d=!0,v=0;v<p.length;v++)r(m.p,p[v].p)&&(a!==v&&c.push({froms:a,tos:v,hole:u}),d?(d=!1,l[v].push(m)):g=!0);d&&l[a].push(m)}0<c.length&&(g||(f=l))}for(g=0,a=p.length;g<a;g++)for(l=p[g].s,h.push(l),c=f[g],o=0,s=c.length;o<s;o++)l.holes.push(c[o].h);return h}},Object.assign(Xn.prototype,{isFont:!0,generateShapes:function(e,n,i){void 0===n&&(n=100),void 0===i&&(i=4);var r=this.data;e=String(e).split("");var a=n/r.resolution,o=0;n=[];for(var s=0;s<e.length;s++){var c;c=a;var l=o,h=r.glyphs[e[s]]||r.glyphs["?"];if(h){var u,d,p,f,m,g,v,y,x=new Wn,b=[],w=t.ShapeUtils.b2,_=t.ShapeUtils.b3;if(h.o)for(var M=h._cachedOutline||(h._cachedOutline=h.o.split(" ")),E=0,T=M.length;E<T;)switch(M[E++]){case"m":u=M[E++]*c+l,d=M[E++]*c,x.moveTo(u,d);break;case"l":u=M[E++]*c+l,d=M[E++]*c,x.lineTo(u,d);break;case"q":if(u=M[E++]*c+l,d=M[E++]*c,m=M[E++]*c+l,g=M[E++]*c,x.quadraticCurveTo(m,g,u,d),f=b[b.length-1]){p=f.x,f=f.y;for(var S=1;S<=i;S++){var A=S/i;w(A,p,m,u),w(A,f,g,d)}}break;case"b":if(u=M[E++]*c+l,d=M[E++]*c,m=M[E++]*c+l,g=M[E++]*c,v=M[E++]*c+l,y=M[E++]*c,x.bezierCurveTo(m,g,v,y,u,d),f=b[b.length-1])for(p=f.x,f=f.y,S=1;S<=i;S++)A=S/i,_(A,p,m,v,u),_(A,f,g,y,d)}c={offset:h.ha*c,path:x}}else c=void 0;o+=c.offset,n.push(c.path)}for(i=[],r=0,e=n.length;r<e;r++)Array.prototype.push.apply(i,n[r].toShapes());return i}}),Object.assign(qn.prototype,{load:function(t,e,n,i){var r=this;new en(this.manager).load(t,function(t){var n;try{n=JSON.parse(t)}catch(e){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),n=JSON.parse(t.substring(65,t.length-2))}t=r.parse(n),e&&e(t)},n,i)},parse:function(t){return new Xn(t)}});var nr;Object.assign(Zn.prototype,{load:function(t,e,n,i){var r=new en(this.manager);r.setResponseType("arraybuffer"),r.load(t,function(t){Yn().decodeAudioData(t,function(t){e(t)})},n,i)}}),Object.assign(Jn.prototype,{update:function(){var e,n,i,r,a,o,s,c=new l,h=new l;return function(l){if(e!==this||n!==l.focus||i!==l.fov||r!==l.aspect*this.aspect||a!==l.near||o!==l.far||s!==l.zoom){e=this,n=l.focus,i=l.fov,r=l.aspect*this.aspect,a=l.near,o=l.far,s=l.zoom;var u,d=l.projectionMatrix.clone(),p=this.eyeSep/2,f=p*a/n,m=a*Math.tan(t.Math.DEG2RAD*i*.5)/s;h.elements[12]=-p,c.elements[12]=p,p=-m*r+f,u=m*r+f,d.elements[0]=2*a/(u-p),d.elements[8]=(u+p)/(u-p),this.cameraL.projectionMatrix.copy(d),p=-m*r-f,u=m*r-f,d.elements[0]=2*a/(u-p),d.elements[8]=(u+p)/(u-p),this.cameraR.projectionMatrix.copy(d)}this.cameraL.matrixWorld.copy(l.matrixWorld).multiply(h),this.cameraR.matrixWorld.copy(l.matrixWorld).multiply(c)}}()}),Qn.prototype=Object.create(rt.prototype),Qn.prototype.constructor=Qn,Kn.prototype=Object.assign(Object.create(rt.prototype),{constructor:Kn,getInput:function(){return this.gain},removeFilter:function(){null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null)},getFilter:function(){return this.filter},setFilter:function(t){null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=t,this.gain.connect(this.filter),this.filter.connect(this.context.destination)},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(t){this.gain.gain.value=t},updateMatrixWorld:function(){var t=new c,e=new s,n=new c,i=new c;return function(r){rt.prototype.updateMatrixWorld.call(this,r),r=this.context.listener;var a=this.up;this.matrixWorld.decompose(t,e,n),i.set(0,0,-1).applyQuaternion(e),r.setPosition(t.x,t.y,t.z),r.setOrientation(i.x,i.y,i.z,a.x,a.y,a.z)}}()}),$n.prototype=Object.assign(Object.create(rt.prototype),{constructor:$n,getOutput:function(){return this.gain},setNodeSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=t,this.connect(),this},setBuffer:function(t){return this.source.buffer=t,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(){if(!0===this.isPlaying)console.warn("THREE.Audio: Audio is already playing.");else{if(!1!==this.hasPlaybackControl){var t=this.context.createBufferSource();return t.buffer=this.source.buffer,t.loop=this.source.loop,t.onended=this.source.onended,t.start(0,this.startTime),t.playbackRate.value=this.playbackRate,this.isPlaying=!0,this.source=t,this.connect()}console.warn("THREE.Audio: this Audio has no playback control.")}},pause:function(){return!1!==this.hasPlaybackControl?(this.source.stop(),this.startTime=this.context.currentTime,this.isPlaying=!1,this):void console.warn("THREE.Audio: this Audio has no playback control.")},stop:function(){return!1!==this.hasPlaybackControl?(this.source.stop(),this.startTime=0,this.isPlaying=!1,this):void console.warn("THREE.Audio: this Audio has no playback control.")},connect:function(){if(0<this.filters.length){this.source.connect(this.filters[0]);for(var t=1,e=this.filters.length;t<e;t++)this.filters[t-1].connect(this.filters[t]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(0<this.filters.length){this.source.disconnect(this.filters[0]);for(var t=1,e=this.filters.length;t<e;t++)this.filters[t-1].disconnect(this.filters[t]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(t){return t||(t=[]),!0===this.isPlaying?(this.disconnect(),this.filters=t,this.connect()):this.filters=t,this},getFilter:function(){return this.getFilters()[0]},setFilter:function(t){return this.setFilters(t?[t]:[])},setPlaybackRate:function(t){return!1!==this.hasPlaybackControl?(this.playbackRate=t,!0===this.isPlaying&&(this.source.playbackRate.value=this.playbackRate),this):void console.warn("THREE.Audio: this Audio has no playback control.")},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.source.loop},setLoop:function(t){!1===this.hasPlaybackControl?console.warn("THREE.Audio: this Audio has no playback control."):this.source.loop=t},getVolume:function(){return this.gain.gain.value},setVolume:function(t){return this.gain.gain.value=t,this}}),ti.prototype=Object.assign(Object.create($n.prototype),{constructor:ti,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(t){this.panner.refDistance=t},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(t){this.panner.rolloffFactor=t},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(t){this.panner.distanceModel=t},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(t){this.panner.maxDistance=t},updateMatrixWorld:function(){var t=new c;return function(e){rt.prototype.updateMatrixWorld.call(this,e),t.setFromMatrixPosition(this.matrixWorld),this.panner.setPosition(t.x,t.y,t.z)}}()}),Object.assign(ei.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var t=0,e=this.getFrequencyData(),n=0;n<e.length;n++)t+=e[n];return t/e.length}}),ni.prototype={constructor:ni,accumulate:function(t,e){var n=this.buffer,i=this.valueSize,r=t*i+i,a=this.cumulativeWeight;if(0===a){for(a=0;a!==i;++a)n[r+a]=n[a];a=e}else a+=e,this._mixBufferRegion(n,r,0,e/a,i);this.cumulativeWeight=a},apply:function(t){var e=this.valueSize,n=this.buffer;t=t*e+e;var i=this.cumulativeWeight,r=this.binding;this.cumulativeWeight=0,1>i&&this._mixBufferRegion(n,t,3*e,1-i,e);for(var i=e,a=e+e;i!==a;++i)if(n[i]!==n[i+e]){r.setValue(n,t);break}},saveOriginalState:function(){var t=this.buffer,e=this.valueSize,n=3*e;this.binding.getValue(t,n);for(var i=e;i!==n;++i)t[i]=t[n+i%e];this.cumulativeWeight=0},restoreOriginalState:function(){this.binding.setValue(this.buffer,3*this.valueSize)},_select:function(t,e,n,i,r){if(.5<=i)for(i=0;i!==r;++i)t[e+i]=t[n+i]},_slerp:function(t,e,n,i,r){s.slerpFlat(t,e,t,e,t,n,i)},_lerp:function(t,e,n,i,r){for(var a=1-i,o=0;o!==r;++o){var s=e+o;t[s]=t[s]*a+t[n+o]*i}}},ii.prototype={constructor:ii,getValue:function(t,e){this.bind(),this.getValue(t,e)},setValue:function(t,e){this.bind(),this.setValue(t,e)},bind:function(){var t=this.node,e=this.parsedPath,n=e.objectName,i=e.propertyName,r=e.propertyIndex;if(t||(this.node=t=ii.findNode(this.rootNode,e.nodeName)||this.rootNode),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,t){if(n){var a=e.objectIndex;switch(n){case"materials":if(!t.material)return void console.error("  can not bind to material as node does not have a material",this);if(!t.material.materials)return void console.error("  can not bind to material.materials as node.material does not have a materials array",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("  can not bind to bones as node does not have a skeleton",this);for(t=t.skeleton.bones,n=0;n<t.length;n++)if(t[n].name===a){a=n;break}break;default:if(void 0===t[n])return void console.error("  can not bind to objectName of node, undefined",this);t=t[n]}if(void 0!==a){if(void 0===t[a])return void console.error("  trying to bind to objectIndex of objectName, but is undefined:",this,t);t=t[a]}}if(a=t[i],void 0===a)console.error("  trying to update property for track: "+e.nodeName+"."+i+" but it wasn't found.",t);else{if(e=this.Versioning.None,void 0!==t.needsUpdate?(e=this.Versioning.NeedsUpdate,this.targetObject=t):void 0!==t.matrixWorldNeedsUpdate&&(e=this.Versioning.MatrixWorldNeedsUpdate,this.targetObject=t),n=this.BindingType.Direct,void 0!==r){if("morphTargetInfluences"===i){if(!t.geometry)return void console.error("  can not bind to morphTargetInfluences becasuse node does not have a geometry",this);if(!t.geometry.morphTargets)return void console.error("  can not bind to morphTargetInfluences becasuse node does not have a geometry.morphTargets",this);for(n=0;n<this.node.geometry.morphTargets.length;n++)if(t.geometry.morphTargets[n].name===r){r=n;break}}n=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=r}else void 0!==a.fromArray&&void 0!==a.toArray?(n=this.BindingType.HasFromToArray,this.resolvedProperty=a):void 0!==a.length?(n=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=i;this.getValue=this.GetterByBindingType[n],this.setValue=this.SetterByBindingTypeAndVersioning[n][e]}}else console.error("  trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}},Object.assign(ii.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},_getValue_unbound:ii.prototype.getValue,_setValue_unbound:ii.prototype.setValue,BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(t,e){t[e]=this.node[this.propertyName]},function(t,e){for(var n=this.resolvedProperty,i=0,r=n.length;i!==r;++i)t[e++]=n[i]},function(t,e){t[e]=this.resolvedProperty[this.propertyIndex]},function(t,e){this.resolvedProperty.toArray(t,e)}],SetterByBindingTypeAndVersioning:[[function(t,e){this.node[this.propertyName]=t[e]},function(t,e){this.node[this.propertyName]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.node[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){for(var n=this.resolvedProperty,i=0,r=n.length;i!==r;++i)n[i]=t[e++]},function(t,e){for(var n=this.resolvedProperty,i=0,r=n.length;i!==r;++i)n[i]=t[e++];this.targetObject.needsUpdate=!0},function(t,e){for(var n=this.resolvedProperty,i=0,r=n.length;i!==r;++i)n[i]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty[this.propertyIndex]=t[e]},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty.fromArray(t,e)},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}]]}),ii.Composite=function(t,e,n){n=n||ii.parseTrackName(e),this._targetGroup=t,this._bindings=t.subscribe_(e,n)},ii.Composite.prototype={constructor:ii.Composite,getValue:function(t,e){this.bind();var n=this._bindings[this._targetGroup.nCachedObjects_];void 0!==n&&n.getValue(t,e)},setValue:function(t,e){for(var n=this._bindings,i=this._targetGroup.nCachedObjects_,r=n.length;i!==r;++i)n[i].setValue(t,e)},bind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].bind()},unbind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].unbind()}},ii.create=function(t,e,n){return t&&t.isAnimationObjectGroup?new ii.Composite(t,e,n):new ii(t,e,n)},ii.parseTrackName=function(t){var e=/^((?:\w+[\/:])*)(\w+)?(?:\.(\w+)(?:\[(.+)\])?)?\.(\w+)(?:\[(.+)\])?$/.exec(t);if(!e)throw Error("cannot parse trackName at all: "+t);if(e={nodeName:e[2],objectName:e[3],objectIndex:e[4],propertyName:e[5],propertyIndex:e[6]},null===e.propertyName||0===e.propertyName.length)throw Error("can not parse propertyName from trackName: "+t);return e},ii.findNode=function(t,e){if(!e||""===e||"root"===e||"."===e||-1===e||e===t.name||e===t.uuid)return t;if(t.skeleton){var n=function(t){for(var n=0;n<t.bones.length;n++){var i=t.bones[n];if(i.name===e)return i}return null}(t.skeleton);if(n)return n}if(t.children){var i=function(t){for(var n=0;n<t.length;n++){var r=t[n];if(r.name===e||r.uuid===e||(r=i(r.children)))return r}return null};if(n=i(t.children))return n}return null},ri.prototype={constructor:ri,isAnimationObjectGroup:!0,add:function(t){for(var e=this._objects,n=e.length,i=this.nCachedObjects_,r=this._indicesByUUID,a=this._paths,o=this._parsedPaths,s=this._bindings,c=s.length,l=0,h=arguments.length;l!==h;++l){var u=arguments[l],d=u.uuid,p=r[d];if(void 0===p){p=n++,r[d]=p,e.push(u);for(var d=0,f=c;d!==f;++d)s[d].push(new ii(u,a[d],o[d]))}else if(p<i){var m=e[p],g=--i,f=e[g];for(r[f.uuid]=p,e[p]=f,r[d]=g,e[g]=u,d=0,f=c;d!==f;++d){var v=s[d],y=v[p];v[p]=v[g],void 0===y&&(y=new ii(u,a[d],o[d])),v[g]=y}}else e[p]!==m&&console.error("Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes...")}this.nCachedObjects_=i},remove:function(t){for(var e=this._objects,n=this.nCachedObjects_,i=this._indicesByUUID,r=this._bindings,a=r.length,o=0,s=arguments.length;o!==s;++o){var c=arguments[o],l=c.uuid,h=i[l];if(void 0!==h&&h>=n){var u=n++,d=e[u];for(i[d.uuid]=h,e[h]=d,i[l]=u,e[u]=c,c=0,l=a;c!==l;++c){var d=r[c],p=d[h];d[h]=d[u],d[u]=p}}}this.nCachedObjects_=n},uncache:function(t){for(var e=this._objects,n=e.length,i=this.nCachedObjects_,r=this._indicesByUUID,a=this._bindings,o=a.length,s=0,c=arguments.length;s!==c;++s){var l=arguments[s].uuid,h=r[l];if(void 0!==h)if(delete r[l],h<i){var l=--i,u=e[l],d=--n,p=e[d];for(r[u.uuid]=h,e[h]=u,r[p.uuid]=l,e[l]=p,e.pop(),u=0,p=o;u!==p;++u){var f=a[u],m=f[d];f[h]=f[l],f[l]=m,f.pop()}}else for(d=--n,p=e[d],r[p.uuid]=h,e[h]=p,e.pop(),u=0,p=o;u!==p;++u)f=a[u],f[h]=f[d],f.pop()}this.nCachedObjects_=i},subscribe_:function(t,e){var n=this._bindingsIndicesByPath,i=n[t],r=this._bindings;if(void 0!==i)return r[i];var a=this._paths,o=this._parsedPaths,s=this._objects,c=this.nCachedObjects_,l=Array(s.length),i=r.length;for(n[t]=i,a.push(t),o.push(e),r.push(l),n=c,i=s.length;n!==i;++n)l[n]=new ii(s[n],t,e);return l},unsubscribe_:function(t){var e=this._bindingsIndicesByPath,n=e[t];if(void 0!==n){var i=this._paths,r=this._parsedPaths,a=this._bindings,o=a.length-1,s=a[o];e[t[o]]=n,a[n]=s,a.pop(),r[n]=r[o],r.pop(),i[n]=i[o],i.pop()}}},ai.prototype={constructor:ai,play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(t){return this._startTime=t,this},setLoop:function(t,e){return this.loop=t,this.repetitions=e,this},setEffectiveWeight:function(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(t){return this._scheduleFading(t,0,1)},fadeOut:function(t){return this._scheduleFading(t,1,0)},crossFadeFrom:function(t,e,n){if(t.fadeOut(e),this.fadeIn(e),n){n=this._clip.duration;var i=t._clip.duration,r=n/i;t.warp(1,i/n,e),this.warp(r,1,e)}return this},crossFadeTo:function(t,e,n){return t.crossFadeFrom(this,e,n)},stopFading:function(){var t=this._weightInterpolant;return null!==t&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},setEffectiveTimeScale:function(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(t){return this.timeScale=this._clip.duration/t,this.stopWarping()},syncWith:function(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()},halt:function(t){return this.warp(this._effectiveTimeScale,0,t)},warp:function(t,e,n){var i=this._mixer,r=i.time,a=this._timeScaleInterpolant,o=this.timeScale;return null===a&&(this._timeScaleInterpolant=a=i._lendControlInterpolant()),i=a.parameterPositions,a=a.sampleValues,i[0]=r,i[1]=r+n,a[0]=t/o,a[1]=e/o,this},stopWarping:function(){var t=this._timeScaleInterpolant;return null!==t&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(t,e,n,i){var r=this._startTime;if(null!==r){if(e=(t-r)*n,0>e||0===n)return;this._startTime=null,e*=n}if(e*=this._updateTimeScale(t),n=this._updateTime(e),t=this._updateWeight(t),0<t){e=this._interpolants;for(var r=this._propertyBindings,a=0,o=e.length;a!==o;++a)e[a].evaluate(n),r[a].accumulate(i,t)}},_updateWeight:function(t){var e=0;if(this.enabled){var e=this.weight,n=this._weightInterpolant;if(null!==n){var i=n.evaluate(t)[0],e=e*i;t>n.parameterPositions[1]&&(this.stopFading(),0===i&&(this.enabled=!1))}}return this._effectiveWeight=e},_updateTimeScale:function(t){var e=0;if(!this.paused){var e=this.timeScale,n=this._timeScaleInterpolant;if(null!==n){var i=n.evaluate(t)[0],e=e*i;t>n.parameterPositions[1]&&(this.stopWarping(),0===e?this.paused=!0:this.timeScale=e)}}return this._effectiveTimeScale=e},_updateTime:function(t){var e=this.time+t;if(0===t)return e;var n=this._clip.duration,i=this.loop,r=this._loopCount;if(2200===i)t:{if(-1===r&&(this.loopCount=0,this._setEndings(!0,!0,!1)),e>=n)e=n;else{if(!(0>e))break t;e=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this._mixer.dispatchEvent({type:"finished",action:this,direction:0>t?-1:1})}else{if(i=2202===i,-1===r&&(0<=t?(r=0,this._setEndings(!0,0===this.repetitions,i)):this._setEndings(0===this.repetitions,!0,i)),e>=n||0>e){var a=Math.floor(e/n),e=e-n*a,r=r+Math.abs(a),o=this.repetitions-r;0>o?(this.clampWhenFinished?this.paused=!0:this.enabled=!1,e=0<t?n:0,this._mixer.dispatchEvent({type:"finished",action:this,direction:0<t?1:-1})):(0===o?(t=0>t,this._setEndings(t,!t,i)):this._setEndings(!1,!1,i),this._loopCount=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a}))}if(i&&1===(1&r))return this.time=e,n-e}return this.time=e},_setEndings:function(t,e,n){var i=this._interpolantSettings;n?(i.endingStart=2401,i.endingEnd=2401):(i.endingStart=t?this.zeroSlopeAtStart?2401:2400:2402,i.endingEnd=e?this.zeroSlopeAtEnd?2401:2400:2402)},_scheduleFading:function(t,e,n){var i=this._mixer,r=i.time,a=this._weightInterpolant;return null===a&&(this._weightInterpolant=a=i._lendControlInterpolant()),i=a.parameterPositions,a=a.sampleValues,i[0]=r,a[0]=e,i[1]=r+t,a[1]=n,this}},Object.assign(oi.prototype,e.prototype,{clipAction:function(t,e){var n=e||this._root,i=n.uuid,r="string"==typeof t?Cn.findByName(n,t):t,n=null!==r?r.uuid:t,a=this._actionsByClip[n],o=null;if(void 0!==a){if(o=a.actionByRoot[i],void 0!==o)return o;o=a.knownActions[0],null===r&&(r=o._clip)}return null===r?null:(r=new ai(this,r,e),this._bindAction(r,o),this._addInactiveAction(r,n,i),r)},existingAction:function(t,e){var n=e||this._root,i=n.uuid,n="string"==typeof t?Cn.findByName(n,t):t,n=this._actionsByClip[n?n.uuid:t];return void 0!==n?n.actionByRoot[i]||null:null},stopAllAction:function(){for(var t=this._actions,e=this._nActiveActions,n=this._bindings,i=this._nActiveBindings,r=this._nActiveBindings=this._nActiveActions=0;r!==e;++r)t[r].reset();for(r=0;r!==i;++r)n[r].useCount=0;return this},update:function(t){t*=this.timeScale;for(var e=this._actions,n=this._nActiveActions,i=this.time+=t,r=Math.sign(t),a=this._accuIndex^=1,o=0;o!==n;++o){var s=e[o];s.enabled&&s._update(i,t,r,a)}for(t=this._bindings,e=this._nActiveBindings,o=0;o!==e;++o)t[o].apply(a);return this},getRoot:function(){return this._root},uncacheClip:function(t){var e=this._actions;t=t.uuid;var n=this._actionsByClip,i=n[t];if(void 0!==i){for(var i=i.knownActions,r=0,a=i.length;r!==a;++r){var o=i[r];this._deactivateAction(o);var s=o._cacheIndex,c=e[e.length-1];o._cacheIndex=null,o._byClipCacheIndex=null,c._cacheIndex=s,e[s]=c,e.pop(),this._removeInactiveBindingsForAction(o)}delete n[t]}},uncacheRoot:function(t){t=t.uuid;var e,n=this._actionsByClip;for(e in n){var i=n[e].actionByRoot[t];void 0!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}if(e=this._bindingsByRootAndName[t],void 0!==e)for(var r in e)t=e[r],t.restoreOriginalState(),this._removeInactiveBinding(t)},uncacheAction:function(t,e){var n=this.existingAction(t,e);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}}),Object.assign(oi.prototype,{_bindAction:function(t,e){var n=t._localRoot||this._root,i=t._clip.tracks,r=i.length,a=t._propertyBindings,o=t._interpolants,s=n.uuid,c=this._bindingsByRootAndName,l=c[s];for(void 0===l&&(l={},c[s]=l),c=0;c!==r;++c){var h=i[c],u=h.name,d=l[u];if(void 0===d){if(d=a[c],void 0!==d){null===d._cacheIndex&&(++d.referenceCount,this._addInactiveBinding(d,s,u));continue}d=new ni(ii.create(n,u,e&&e._propertyBindings[c].binding.parsedPath),h.ValueTypeName,h.getValueSize()),++d.referenceCount,this._addInactiveBinding(d,s,u)}a[c]=d,o[c].resultBuffer=d.buffer}},_activateAction:function(t){if(!this._isActiveAction(t)){if(null===t._cacheIndex){var e=(t._localRoot||this._root).uuid,n=t._clip.uuid,i=this._actionsByClip[n];
this._bindAction(t,i&&i.knownActions[0]),this._addInactiveAction(t,n,e)}for(e=t._propertyBindings,n=0,i=e.length;n!==i;++n){var r=e[n];0===r.useCount++&&(this._lendBinding(r),r.saveOriginalState())}this._lendAction(t)}},_deactivateAction:function(t){if(this._isActiveAction(t)){for(var e=t._propertyBindings,n=0,i=e.length;n!==i;++n){var r=e[n];0===--r.useCount&&(r.restoreOriginalState(),this._takeBackBinding(r))}this._takeBackAction(t)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}},_isActiveAction:function(t){return t=t._cacheIndex,null!==t&&t<this._nActiveActions},_addInactiveAction:function(t,e,n){var i=this._actions,r=this._actionsByClip,a=r[e];void 0===a?(a={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,r[e]=a):(e=a.knownActions,t._byClipCacheIndex=e.length,e.push(t)),t._cacheIndex=i.length,i.push(t),a.actionByRoot[n]=t},_removeInactiveAction:function(t){var e=this._actions,n=e[e.length-1],i=t._cacheIndex;n._cacheIndex=i,e[i]=n,e.pop(),t._cacheIndex=null;var n=t._clip.uuid,i=this._actionsByClip,r=i[n],a=r.knownActions,o=a[a.length-1],s=t._byClipCacheIndex;o._byClipCacheIndex=s,a[s]=o,a.pop(),t._byClipCacheIndex=null,delete r.actionByRoot[(e._localRoot||this._root).uuid],0===a.length&&delete i[n],this._removeInactiveBindingsForAction(t)},_removeInactiveBindingsForAction:function(t){t=t._propertyBindings;for(var e=0,n=t.length;e!==n;++e){var i=t[e];0===--i.referenceCount&&this._removeInactiveBinding(i)}},_lendAction:function(t){var e=this._actions,n=t._cacheIndex,i=this._nActiveActions++,r=e[i];t._cacheIndex=i,e[i]=t,r._cacheIndex=n,e[n]=r},_takeBackAction:function(t){var e=this._actions,n=t._cacheIndex,i=--this._nActiveActions,r=e[i];t._cacheIndex=i,e[i]=t,r._cacheIndex=n,e[n]=r},_addInactiveBinding:function(t,e,n){var i=this._bindingsByRootAndName,r=i[e],a=this._bindings;void 0===r&&(r={},i[e]=r),r[n]=t,t._cacheIndex=a.length,a.push(t)},_removeInactiveBinding:function(t){var e=this._bindings,n=t.binding,i=n.rootNode.uuid,n=n.path,r=this._bindingsByRootAndName,a=r[i],o=e[e.length-1];t=t._cacheIndex,o._cacheIndex=t,e[t]=o,e.pop(),delete a[n];t:{for(var s in a)break t;delete r[i]}},_lendBinding:function(t){var e=this._bindings,n=t._cacheIndex,i=this._nActiveBindings++,r=e[i];t._cacheIndex=i,e[i]=t,r._cacheIndex=n,e[n]=r},_takeBackBinding:function(t){var e=this._bindings,n=t._cacheIndex,i=--this._nActiveBindings,r=e[i];t._cacheIndex=i,e[i]=t,r._cacheIndex=n,e[n]=r},_lendControlInterpolant:function(){var t=this._controlInterpolants,e=this._nActiveControlInterpolants++,n=t[e];return void 0===n&&(n=new xn(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),n.__cacheIndex=e,t[e]=n),n},_takeBackControlInterpolant:function(t){var e=this._controlInterpolants,n=t.__cacheIndex,i=--this._nActiveControlInterpolants,r=e[i];t.__cacheIndex=i,e[i]=t,r.__cacheIndex=n,e[n]=r},_controlInterpolantsResultBuffer:new Float32Array(1)}),si.prototype={constructor:si,onUpdate:function(t){return this.dynamic=!0,this.onUpdateCallback=t,this}},ci.prototype=Object.create(mt.prototype),ci.prototype.constructor=ci,ci.prototype.isInstancedBufferGeometry=!0,ci.prototype.addGroup=function(t,e,n){this.groups.push({start:t,count:e,instances:n})},ci.prototype.copy=function(t){var e=t.index;null!==e&&this.setIndex(e.clone());var n,e=t.attributes;for(n in e)this.addAttribute(n,e[n].clone());for(t=t.groups,n=0,e=t.length;n<e;n++){var i=t[n];this.addGroup(i.start,i.count,i.instances)}return this},li.prototype={constructor:li,isInterleavedBufferAttribute:!0,get count(){return this.data.count},get array(){return this.data.array},setX:function(t,e){return this.data.array[t*this.data.stride+this.offset]=e,this},setY:function(t,e){return this.data.array[t*this.data.stride+this.offset+1]=e,this},setZ:function(t,e){return this.data.array[t*this.data.stride+this.offset+2]=e,this},setW:function(t,e){return this.data.array[t*this.data.stride+this.offset+3]=e,this},getX:function(t){return this.data.array[t*this.data.stride+this.offset]},getY:function(t){return this.data.array[t*this.data.stride+this.offset+1]},getZ:function(t){return this.data.array[t*this.data.stride+this.offset+2]},getW:function(t){return this.data.array[t*this.data.stride+this.offset+3]},setXY:function(t,e,n){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this},setXYZ:function(t,e,n,i){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=i,this},setXYZW:function(t,e,n,i,r){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=i,this.data.array[t+3]=r,this}},hi.prototype={constructor:hi,isInterleavedBuffer:!0,set needsUpdate(t){!0===t&&this.version++},setDynamic:function(t){return this.dynamic=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.dynamic=t.dynamic,this},copyAt:function(t,e,n){t*=this.stride,n*=e.stride;for(var i=0,r=this.stride;i<r;i++)this.array[t+i]=e.array[n+i];return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},clone:function(){return(new this.constructor).copy(this)}},ui.prototype=Object.create(hi.prototype),ui.prototype.constructor=ui,ui.prototype.isInstancedInterleavedBuffer=!0,ui.prototype.copy=function(t){return hi.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this},di.prototype=Object.create(lt.prototype),di.prototype.constructor=di,di.prototype.isInstancedBufferAttribute=!0,di.prototype.copy=function(t){return lt.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this},pi.prototype={constructor:pi,linePrecision:1,set:function(t,e){this.ray.set(t,e)},setFromCamera:function(t,e){e&&e.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(e).sub(this.ray.origin).normalize()):e&&e.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,(e.near+e.far)/(e.near-e.far)).unproject(e),this.ray.direction.set(0,0,-1).transformDirection(e.matrixWorld)):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(t,e){var n=[];return mi(t,this,n,e),n.sort(fi),n},intersectObjects:function(t,e){var n=[];if(!1===Array.isArray(t))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),n;for(var i=0,r=t.length;i<r;i++)mi(t[i],this,n,e);return n.sort(fi),n}},gi.prototype={constructor:gi,start:function(){this.oldTime=this.startTime=(performance||Date).now(),this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var t=0;if(this.autoStart&&!this.running&&this.start(),this.running){var e=(performance||Date).now(),t=(e-this.oldTime)/1e3;this.oldTime=e,this.elapsedTime+=t}return t}},vi.prototype={constructor:vi,set:function(t,e,n){return this.radius=t,this.phi=e,this.theta=n,this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.radius.copy(t.radius),this.phi.copy(t.phi),this.theta.copy(t.theta),this},makeSafe:function(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this},setFromVector3:function(e){return this.radius=e.length(),0===this.radius?this.phi=this.theta=0:(this.theta=Math.atan2(e.x,e.z),this.phi=Math.acos(t.Math.clamp(e.y/this.radius,-1,1))),this}},yi.prototype=Object.create(gt.prototype),yi.prototype.constructor=yi,yi.prototype.createAnimation=function(t,e,n,i){e={start:e,end:n,length:n-e+1,fps:i,duration:(n-e)/i,lastFrame:0,currentFrame:0,active:!1,time:0,direction:1,weight:1,directionBackwards:!1,mirroredLoop:!1},this.animationsMap[t]=e,this.animationsList.push(e)},yi.prototype.autoCreateAnimations=function(t){for(var e,n=/([a-z]+)_?(\d+)/i,i={},r=this.geometry,a=0,o=r.morphTargets.length;a<o;a++){var s=r.morphTargets[a].name.match(n);if(s&&1<s.length){var c=s[1];i[c]||(i[c]={start:1/0,end:-(1/0)}),s=i[c],a<s.start&&(s.start=a),a>s.end&&(s.end=a),e||(e=c)}}for(c in i)s=i[c],this.createAnimation(c,s.start,s.end,t);this.firstAnimation=e},yi.prototype.setAnimationDirectionForward=function(t){(t=this.animationsMap[t])&&(t.direction=1,t.directionBackwards=!1)},yi.prototype.setAnimationDirectionBackward=function(t){(t=this.animationsMap[t])&&(t.direction=-1,t.directionBackwards=!0)},yi.prototype.setAnimationFPS=function(t,e){var n=this.animationsMap[t];n&&(n.fps=e,n.duration=(n.end-n.start)/n.fps)},yi.prototype.setAnimationDuration=function(t,e){var n=this.animationsMap[t];n&&(n.duration=e,n.fps=(n.end-n.start)/n.duration)},yi.prototype.setAnimationWeight=function(t,e){var n=this.animationsMap[t];n&&(n.weight=e)},yi.prototype.setAnimationTime=function(t,e){var n=this.animationsMap[t];n&&(n.time=e)},yi.prototype.getAnimationTime=function(t){var e=0;return(t=this.animationsMap[t])&&(e=t.time),e},yi.prototype.getAnimationDuration=function(t){var e=-1;return(t=this.animationsMap[t])&&(e=t.duration),e},yi.prototype.playAnimation=function(t){var e=this.animationsMap[t];e?(e.time=0,e.active=!0):console.warn("THREE.MorphBlendMesh: animation["+t+"] undefined in .playAnimation()")},yi.prototype.stopAnimation=function(t){(t=this.animationsMap[t])&&(t.active=!1)},yi.prototype.update=function(e){for(var n=0,i=this.animationsList.length;n<i;n++){var r=this.animationsList[n];if(r.active){var a=r.duration/r.length;r.time+=r.direction*e,r.mirroredLoop?(r.time>r.duration||0>r.time)&&(r.direction*=-1,r.time>r.duration&&(r.time=r.duration,r.directionBackwards=!0),0>r.time&&(r.time=0,r.directionBackwards=!1)):(r.time%=r.duration,0>r.time&&(r.time+=r.duration));var o=r.start+t.Math.clamp(Math.floor(r.time/a),0,r.length-1),s=r.weight;o!==r.currentFrame&&(this.morphTargetInfluences[r.lastFrame]=0,this.morphTargetInfluences[r.currentFrame]=1*s,this.morphTargetInfluences[o]=0,r.lastFrame=r.currentFrame,r.currentFrame=o),a=r.time%a/a,r.directionBackwards&&(a=1-a),r.currentFrame!==r.lastFrame?(this.morphTargetInfluences[r.currentFrame]=a*s,this.morphTargetInfluences[r.lastFrame]=(1-a)*s):this.morphTargetInfluences[r.currentFrame]=s}}},xi.prototype=Object.create(rt.prototype),xi.prototype.constructor=xi,xi.prototype.isImmediateRenderObject=!0,bi.prototype=Object.create(se.prototype),bi.prototype.constructor=bi,bi.prototype.update=function(){var t=new c,e=new c,n=new Q;return function(){var i=["a","b","c"];this.object.updateMatrixWorld(!0),n.getNormalMatrix(this.object.matrixWorld);var r=this.object.matrixWorld,a=this.geometry.attributes.position,o=this.object.geometry;if(o&&o.isGeometry)for(var s=o.vertices,c=o.faces,l=o=0,h=c.length;l<h;l++)for(var u=c[l],d=0,p=u.vertexNormals.length;d<p;d++){var f=u.vertexNormals[d];t.copy(s[u[i[d]]]).applyMatrix4(r),e.copy(f).applyMatrix3(n).normalize().multiplyScalar(this.size).add(t),a.setXYZ(o,t.x,t.y,t.z),o+=1,a.setXYZ(o,e.x,e.y,e.z),o+=1}else if(o&&o.isBufferGeometry)for(i=o.attributes.position,s=o.attributes.normal,d=o=0,p=i.count;d<p;d++)t.set(i.getX(d),i.getY(d),i.getZ(d)).applyMatrix4(r),e.set(s.getX(d),s.getY(d),s.getZ(d)),e.applyMatrix3(n).normalize().multiplyScalar(this.size).add(t),a.setXYZ(o,t.x,t.y,t.z),o+=1,a.setXYZ(o,e.x,e.y,e.z),o+=1;return a.needsUpdate=!0,this}}(),wi.prototype=Object.create(rt.prototype),wi.prototype.constructor=wi,wi.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},wi.prototype.update=function(){var t=new c,e=new c;return function(){var n=this.light.distance?this.light.distance:1e3,i=n*Math.tan(this.light.angle);this.cone.scale.set(i,i,n),t.setFromMatrixPosition(this.light.matrixWorld),e.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(e.sub(t)),this.cone.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)}}(),_i.prototype=Object.create(se.prototype),_i.prototype.constructor=_i,_i.prototype.getBoneList=function(t){var e=[];t&&t.isBone&&e.push(t);for(var n=0;n<t.children.length;n++)e.push.apply(e,this.getBoneList(t.children[n]));return e},_i.prototype.update=function(){for(var t=this.geometry,e=(new l).getInverse(this.root.matrixWorld),n=new l,i=0,r=0;r<this.bones.length;r++){var a=this.bones[r];a.parent&&a.parent.isBone&&(n.multiplyMatrices(e,a.matrixWorld),t.vertices[i].setFromMatrixPosition(n),n.multiplyMatrices(e,a.parent.matrixWorld),t.vertices[i+1].setFromMatrixPosition(n),i+=2)}t.verticesNeedUpdate=!0,t.computeBoundingSphere()},Mi.prototype=Object.create(gt.prototype),Mi.prototype.constructor=Mi,Mi.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},Mi.prototype.update=function(){this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)},Ei.prototype=Object.create(rt.prototype),Ei.prototype.constructor=Ei,Ei.prototype.dispose=function(){this.lightSphere.geometry.dispose(),this.lightSphere.material.dispose()},Ei.prototype.update=function(){var t=new c;return function(){this.colors[0].copy(this.light.color).multiplyScalar(this.light.intensity),this.colors[1].copy(this.light.groundColor).multiplyScalar(this.light.intensity),this.lightSphere.lookAt(t.setFromMatrixPosition(this.light.matrixWorld).negate()),this.lightSphere.geometry.colorsNeedUpdate=!0}}(),Ti.prototype=Object.create(se.prototype),Ti.prototype.constructor=Ti,Ti.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},Si.prototype=Object.create(se.prototype),Si.prototype.constructor=Si,Si.prototype.update=function(){var t=new c,e=new c,n=new Q;return function(){this.object.updateMatrixWorld(!0),n.getNormalMatrix(this.object.matrixWorld);for(var i=this.object.matrixWorld,r=this.geometry.attributes.position,a=this.object.geometry,o=a.vertices,a=a.faces,s=0,c=0,l=a.length;c<l;c++){var h=a[c],u=h.normal;t.copy(o[h.a]).add(o[h.b]).add(o[h.c]).divideScalar(3).applyMatrix4(i),e.copy(u).applyMatrix3(n).normalize().multiplyScalar(this.size).add(t),r.setXYZ(s,t.x,t.y,t.z),s+=1,r.setXYZ(s,e.x,e.y,e.z),s+=1}return r.needsUpdate=!0,this}}(),Ai.prototype=Object.create(rt.prototype),Ai.prototype.constructor=Ai,Ai.prototype.dispose=function(){var t=this.children[0],e=this.children[1];t.geometry.dispose(),t.material.dispose(),e.geometry.dispose(),e.material.dispose()},Ai.prototype.update=function(){var t=new c,e=new c,n=new c;return function(){t.setFromMatrixPosition(this.light.matrixWorld),e.setFromMatrixPosition(this.light.target.matrixWorld),n.subVectors(e,t);var i=this.children[0],r=this.children[1];i.lookAt(n),i.material.color.copy(this.light.color).multiplyScalar(this.light.intensity),r.lookAt(n),r.scale.z=n.length()}}(),Ri.prototype=Object.create(se.prototype),Ri.prototype.constructor=Ri,Ri.prototype.update=function(){function t(t,a,o,s){if(i.set(a,o,s).unproject(r),t=n[t],void 0!==t)for(a=0,o=t.length;a<o;a++)e.vertices[t[a]].copy(i)}var e,n,i=new c,r=new xt;return function(){e=this.geometry,n=this.pointMap,r.projectionMatrix.copy(this.camera.projectionMatrix),t("c",0,0,-1),t("t",0,0,1),t("n1",-1,-1,-1),t("n2",1,-1,-1),t("n3",-1,1,-1),t("n4",1,1,-1),t("f1",-1,-1,1),t("f2",1,-1,1),t("f3",-1,1,1),t("f4",1,1,1),t("u1",.7,1.1,-1),t("u2",-.7,1.1,-1),t("u3",0,2,-1),t("cf1",-1,0,1),t("cf2",1,0,1),t("cf3",0,-1,1),t("cf4",0,1,1),t("cn1",-1,0,-1),t("cn2",1,0,-1),t("cn3",0,-1,-1),t("cn4",0,1,-1),e.verticesNeedUpdate=!0}}(),Li.prototype=Object.create(gt.prototype),Li.prototype.constructor=Li,Li.prototype.update=function(){this.box.setFromObject(this.object),this.box.size(this.scale),this.box.getCenter(this.position)},Ci.prototype=Object.create(se.prototype),Ci.prototype.constructor=Ci,Ci.prototype.update=function(){var t=new Z;return function(e){if(e&&e.isBox3?t.copy(e):t.setFromObject(e),!t.isEmpty()){e=t.min;var n=t.max,i=this.geometry.attributes.position,r=i.array;r[0]=n.x,r[1]=n.y,r[2]=n.z,r[3]=e.x,r[4]=n.y,r[5]=n.z,r[6]=e.x,r[7]=e.y,r[8]=n.z,r[9]=n.x,r[10]=e.y,r[11]=n.z,r[12]=n.x,r[13]=n.y,r[14]=e.z,r[15]=e.x,r[16]=n.y,r[17]=e.z,r[18]=e.x,r[19]=e.y,r[20]=e.z,r[21]=n.x,r[22]=e.y,r[23]=e.z,i.needsUpdate=!0,this.geometry.computeBoundingSphere()}}}();var ir=new mt;ir.addAttribute("position",new dt([0,0,0,0,1,0],3));var rr=new Be(0,.5,1,5,1);rr.translate(0,-.5,0),Pi.prototype=Object.create(rt.prototype),Pi.prototype.constructor=Pi,Pi.prototype.setDirection=function(){var t,e=new c;return function(n){.99999<n.y?this.quaternion.set(0,0,0,1):-.99999>n.y?this.quaternion.set(1,0,0,0):(e.set(n.z,0,-n.x).normalize(),t=Math.acos(n.y),this.quaternion.setFromAxisAngle(e,t))}}(),Pi.prototype.setLength=function(t,e,n){void 0===e&&(e=.2*t),void 0===n&&(n=.2*e),this.line.scale.set(1,Math.max(0,t-e),1),this.line.updateMatrix(),this.cone.scale.set(n,e,n),this.cone.position.y=t,this.cone.updateMatrix()},Pi.prototype.setColor=function(t){this.line.material.color.copy(t),this.cone.material.color.copy(t)},Ii.prototype=Object.create(se.prototype),Ii.prototype.constructor=Ii,t.CatmullRomCurve3=function(){function t(){}var e=new c,n=new t,i=new t,r=new t;return t.prototype.init=function(t,e,n,i){this.c0=t,this.c1=n,this.c2=-3*t+3*e-2*n-i,this.c3=2*t-2*e+n+i},t.prototype.initNonuniformCatmullRom=function(t,e,n,i,r,a,o){this.init(e,n,((e-t)/r-(n-t)/(r+a)+(n-e)/a)*a,((n-e)/a-(i-e)/(a+o)+(i-n)/o)*a)},t.prototype.initCatmullRom=function(t,e,n,i,r){this.init(e,n,r*(n-t),r*(i-e))},t.prototype.calc=function(t){var e=t*t;return this.c0+this.c1*t+this.c2*e+this.c3*e*t},Fn.create(function(t){this.points=t||[],this.closed=!1},function(t){var a,o,s=this.points;o=s.length,2>o&&console.log("duh, you need at least 2 points"),t*=o-(this.closed?0:1),a=Math.floor(t),t-=a,this.closed?a+=0<a?0:(Math.floor(Math.abs(a)/s.length)+1)*s.length:0===t&&a===o-1&&(a=o-2,t=1);var l,h,u;if(this.closed||0<a?l=s[(a-1)%o]:(e.subVectors(s[0],s[1]).add(s[0]),l=e),h=s[a%o],u=s[(a+1)%o],this.closed||a+2<o?s=s[(a+2)%o]:(e.subVectors(s[o-1],s[o-2]).add(s[o-1]),s=e),void 0===this.type||"centripetal"===this.type||"chordal"===this.type){var d="chordal"===this.type?.5:.25;o=Math.pow(l.distanceToSquared(h),d),a=Math.pow(h.distanceToSquared(u),d),d=Math.pow(u.distanceToSquared(s),d),1e-4>a&&(a=1),1e-4>o&&(o=a),1e-4>d&&(d=a),n.initNonuniformCatmullRom(l.x,h.x,u.x,s.x,o,a,d),i.initNonuniformCatmullRom(l.y,h.y,u.y,s.y,o,a,d),r.initNonuniformCatmullRom(l.z,h.z,u.z,s.z,o,a,d)}else"catmullrom"===this.type&&(o=void 0!==this.tension?this.tension:.5,n.initCatmullRom(l.x,h.x,u.x,s.x,o),i.initCatmullRom(l.y,h.y,u.y,s.y,o),r.initCatmullRom(l.z,h.z,u.z,s.z,o));return new c(n.calc(t),i.calc(t),r.calc(t))})}(),Ui.prototype=Object.create(t.CatmullRomCurve3.prototype);var ar=Fn.create(function(t){console.warn("THREE.SplineCurve3 will be deprecated. Please use THREE.CatmullRomCurve3"),this.points=void 0===t?[]:t},function(e){var n=this.points;e*=n.length-1;var i=Math.floor(e);e-=i;var r=n[0==i?i:i-1],a=n[i],o=n[i>n.length-2?n.length-1:i+1],n=n[i>n.length-3?n.length-1:i+2],i=t.CurveUtils.interpolate;return new c(i(r.x,a.x,o.x,n.x,e),i(r.y,a.y,o.y,n.y,e),i(r.z,a.z,o.z,n.z,e))});t.CubicBezierCurve3=Fn.create(function(t,e,n,i){this.v0=t,this.v1=e,this.v2=n,this.v3=i},function(e){var n=t.ShapeUtils.b3;return new c(n(e,this.v0.x,this.v1.x,this.v2.x,this.v3.x),n(e,this.v0.y,this.v1.y,this.v2.y,this.v3.y),n(e,this.v0.z,this.v1.z,this.v2.z,this.v3.z))}),t.QuadraticBezierCurve3=Fn.create(function(t,e,n){this.v0=t,this.v1=e,this.v2=n},function(e){var n=t.ShapeUtils.b2;return new c(n(e,this.v0.x,this.v1.x,this.v2.x),n(e,this.v0.y,this.v1.y,this.v2.y),n(e,this.v0.z,this.v1.z,this.v2.z))}),t.LineCurve3=Fn.create(function(t,e){this.v1=t,this.v2=e},function(t){if(1===t)return this.v2.clone();var e=new c;return e.subVectors(this.v2,this.v1),e.multiplyScalar(t),e.add(this.v1),e}),Ni.prototype=Object.create(zn.prototype),Ni.prototype.constructor=Ni,t.SceneUtils={createMultiMaterialObject:function(t,e){for(var n=new he,i=0,r=e.length;i<r;i++)n.add(new gt(t,e[i]));return n},detach:function(t,e,n){t.applyMatrix(e.matrixWorld),e.remove(t),n.add(t)},attach:function(t,e,n){var i=new l;i.getInverse(n.matrixWorld),t.applyMatrix(i),e.remove(t),n.add(t)}},Object.assign(V.prototype,{center:function(t){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},size:function(t){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(t)}}),Object.assign(Z.prototype,{center:function(t){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionSphere:function(t){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)},size:function(t){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(t)}}),Object.assign(at.prototype,{center:function(t){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(t)}}),Object.assign(Q.prototype,{multiplyVector3:function(t){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},multiplyVector3Array:function(t){return console.warn("THREE.Matrix3: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead."),this.applyToVector3Array(t)}}),Object.assign(l.prototype,{extractPosition:function(t){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(t)},setRotationFromQuaternion:function(t){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(t)},multiplyVector3:function(t){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) or vector.applyProjection( matrix ) instead."),t.applyProjection(this)},multiplyVector4:function(t){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector3Array:function(t){return console.warn("THREE.Matrix4: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead."),this.applyToVector3Array(t)},rotateAxis:function(t){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),t.transformDirection(this)},crossVector:function(t){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},translate:function(t){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(t){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(t){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(t){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(t,e){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")}}),Object.assign(K.prototype,{isIntersectionLine:function(t){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(t)}}),Object.assign(s.prototype,{multiplyVector3:function(t){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),t.applyQuaternion(this)}}),Object.assign(et.prototype,{isIntersectionBox:function(t){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionPlane:function(t){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(t)},isIntersectionSphere:function(t){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)}}),Object.assign(Vn.prototype,{extrude:function(t){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new Ae(this,t)},makeGeometry:function(t){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new Fe(this,t)}}),Object.assign(c.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(t){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(t)},getScaleFromMatrix:function(t){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(t)},getColumnFromMatrix:function(t,e){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(e,t)}}),Object.assign(rt.prototype,{getChildByName:function(t){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(t)},renderDepth:function(t){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(t,e){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(e,t)}}),Object.defineProperties(rt.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(t){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=t}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(t){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.defineProperties(te.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),bt.prototype.setLens=function(t,e){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==e&&(this.filmGauge=e),this.setFocalLength(t)},Object.defineProperties(cn.prototype,{onlyShadow:{set:function(t){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(t){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=t}},shadowCameraLeft:{set:function(t){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=t}},shadowCameraRight:{set:function(t){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=t}},shadowCameraTop:{set:function(t){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=t}},shadowCameraBottom:{set:function(t){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=t}},shadowCameraNear:{set:function(t){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=t}},shadowCameraFar:{set:function(t){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=t}},shadowCameraVisible:{set:function(t){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(t){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=t}},shadowDarkness:{set:function(t){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(t){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=t}},shadowMapHeight:{set:function(t){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=t}}}),Object.defineProperties(lt.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Please use .count."),this.array.length}}}),Object.assign(mt.prototype,{addIndex:function(t){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(t)},addDrawCall:function(t,e,n){void 0!==n&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(t,e)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")}}),Object.defineProperties(mt.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(X.prototype,{wrapAround:{get:function(){console.warn("THREE."+this.type+": .wrapAround has been removed.")},set:function(t){console.warn("THREE."+this.type+": .wrapAround has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE."+this.type+": .wrapRGB has been removed."),new k}}}),Object.defineProperties(Je.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(t){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(q.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(t){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=t}}}),e.prototype=Object.assign(Object.create({constructor:e,apply:function(t){console.warn("THREE.EventDispatcher: .apply is deprecated, just inherit or Object.assign the prototype to mix-in."),Object.assign(t,this)}}),e.prototype),Object.assign(qt.prototype,{supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),
this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(t){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(t)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")}}),Object.defineProperties(qt.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=t}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=t}},shadowMapCullFace:{get:function(){return this.shadowMap.cullFace},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapCullFace is now .shadowMap.cullFace."),this.shadowMap.cullFace=t}}}),Object.defineProperties(tt.prototype,{cullFace:{get:function(){return this.renderReverseSided?2:1},set:function(t){t=1!==t,console.warn("WebGLRenderer: .shadowMap.cullFace is deprecated. Set .shadowMap.renderReverseSided to "+t+"."),this.renderReverseSided=t}}}),Object.defineProperties(a.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=t}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=t}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=t}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=t}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(t){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=t}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(t){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=t}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(t){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=t}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(t){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=t}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(t){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=t}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(t){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=t}}}),Object.assign($n.prototype,{load:function(t){console.warn("THREE.Audio: .load has been deprecated. Please use THREE.AudioLoader.");var e=this;return(new Zn).load(t,function(t){e.setBuffer(t)}),this}}),Object.assign(ei.prototype,{getData:function(t){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()}}),Object.defineProperty(t,"AudioContext",{get:function(){return t.getAudioContext()}}),t.WebGLRenderTargetCube=o,t.WebGLRenderTarget=a,t.WebGLRenderer=qt,t.ShaderLib=qi,t.UniformsLib=Xi,t.ShaderChunk=Wi,t.FogExp2=Yt,t.Fog=Zt,t.Scene=Jt,t.LensFlare=Qt,t.Sprite=$t,t.LOD=te,t.SkinnedMesh=re,t.Skeleton=ne,t.Bone=ie,t.Mesh=gt,t.LineSegments=se,t.Line=oe,t.Points=le,t.Group=he,t.VideoTexture=ue,t.DataTexture=ee,t.CompressedTexture=de,t.CubeTexture=h,t.CanvasTexture=pe,t.DepthTexture=fe,t.TextureIdCount=function(){return zi++},t.Texture=i,t.MaterialIdCount=function(){return Yi++},t.CompressedTextureLoader=nn,t.BinaryTextureLoader=rn,t.DataTextureLoader=rn,t.CubeTextureLoader=on,t.TextureLoader=sn,t.ObjectLoader=Dn,t.MaterialLoader=Pn,t.BufferGeometryLoader=In,t.LoadingManager=tn,t.JSONLoader=Nn,t.ImageLoader=an,t.FontLoader=qn,t.XHRLoader=en,t.Loader=Un,t.AudioLoader=Zn,t.SpotLightShadow=un,t.SpotLight=dn,t.PointLight=pn,t.HemisphereLight=ln,t.DirectionalLightShadow=fn,t.DirectionalLight=mn,t.AmbientLight=gn,t.LightShadow=hn,t.Light=cn,t.StereoCamera=Jn,t.PerspectiveCamera=bt,t.OrthographicCamera=wt,t.CubeCamera=Qn,t.Camera=xt,t.AudioListener=Kn,t.PositionalAudio=ti,t.getAudioContext=Yn,t.AudioAnalyser=ei,t.Audio=$n,t.VectorKeyframeTrack=_n,t.StringKeyframeTrack=Sn,t.QuaternionKeyframeTrack=En,t.NumberKeyframeTrack=Tn,t.ColorKeyframeTrack=Rn,t.BooleanKeyframeTrack=An,t.PropertyMixer=ni,t.PropertyBinding=ii,t.KeyframeTrack=Ln,t.AnimationObjectGroup=ri,t.AnimationMixer=oi,t.AnimationClip=Cn,t.Uniform=si,t.InstancedBufferGeometry=ci,t.BufferGeometry=mt,t.GeometryIdCount=function(){return Ji++},t.Geometry=pt,t.InterleavedBufferAttribute=li,t.InstancedInterleavedBuffer=ui,t.InterleavedBuffer=hi,t.InstancedBufferAttribute=di,t.DynamicBufferAttribute=function(t,e){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setDynamic( true ) instead."),new lt(t,e).setDynamic(!0)},t.Float64Attribute=function(t,e){return new lt(new Float64Array(t),e)},t.Float32Attribute=dt,t.Uint32Attribute=ut,t.Int32Attribute=function(t,e){return new lt(new Int32Array(t),e)},t.Uint16Attribute=ht,t.Int16Attribute=function(t,e){return new lt(new Int16Array(t),e)},t.Uint8ClampedAttribute=function(t,e){return new lt(new Uint8ClampedArray(t),e)},t.Uint8Attribute=function(t,e){return new lt(new Uint8Array(t),e)},t.Int8Attribute=function(t,e){return new lt(new Int8Array(t),e)},t.BufferAttribute=lt,t.Face3=st,t.Object3DIdCount=function(){return Zi++},t.Object3D=rt,t.Raycaster=pi,t.Layers=it,t.EventDispatcher=e,t.Clock=gi,t.QuaternionLinearInterpolant=Mn,t.LinearInterpolant=xn,t.DiscreteInterpolant=bn,t.CubicInterpolant=yn,t.Interpolant=vn,t.Triangle=ot,t.Spline=function(t){function e(t,e,n,i,r,a,o){return t=.5*(n-t),i=.5*(i-e),(2*(e-n)+t+i)*o+(-3*(e-n)-2*t-i)*a+t*r+e}this.points=t;var n,i,r,a,o,s,l,h,u,d=[],p={x:0,y:0,z:0};this.initFromArray=function(t){this.points=[];for(var e=0;e<t.length;e++)this.points[e]={x:t[e][0],y:t[e][1],z:t[e][2]}},this.getPoint=function(t){return n=(this.points.length-1)*t,i=Math.floor(n),r=n-i,d[0]=0===i?i:i-1,d[1]=i,d[2]=i>this.points.length-2?this.points.length-1:i+1,d[3]=i>this.points.length-3?this.points.length-1:i+2,s=this.points[d[0]],l=this.points[d[1]],h=this.points[d[2]],u=this.points[d[3]],a=r*r,o=r*a,p.x=e(s.x,l.x,h.x,u.x,r,a,o),p.y=e(s.y,l.y,h.y,u.y,r,a,o),p.z=e(s.z,l.z,h.z,u.z,r,a,o),p},this.getControlPointsArray=function(){var t,e,n=this.points.length,i=[];for(t=0;t<n;t++)e=this.points[t],i[t]=[e.x,e.y,e.z];return i},this.getLength=function(t){var e,n,i,r=0,a=new c,o=new c,s=[],l=0;for(s[0]=0,t||(t=100),n=this.points.length*t,a.copy(this.points[0]),t=1;t<n;t++)e=t/n,i=this.getPoint(e),o.copy(i),l+=o.distanceTo(a),a.copy(i),e*=this.points.length-1,e=Math.floor(e),e!==r&&(s[e]=l,r=e);return s[s.length]=l,{chunks:s,total:l}},this.reparametrizeByArcLength=function(t){var e,n,i,r,a,o,s=[],l=new c,h=this.getLength();for(s.push(l.copy(this.points[0]).clone()),e=1;e<this.points.length;e++){for(n=h.chunks[e]-h.chunks[e-1],o=Math.ceil(t*n/h.total),r=(e-1)/(this.points.length-1),a=e/(this.points.length-1),n=1;n<o-1;n++)i=r+1/o*n*(a-r),i=this.getPoint(i),s.push(l.copy(i).clone());s.push(l.copy(this.points[e]).clone())}this.points=s}},t.Spherical=vi,t.Plane=K,t.Frustum=$,t.Sphere=J,t.Ray=et,t.Matrix4=l,t.Matrix3=Q,t.Box3=Z,t.Box2=V,t.Line3=at,t.Euler=nt,t.Vector4=r,t.Vector3=c,t.Vector2=n,t.Quaternion=s,t.Color=k,t.MorphBlendMesh=yi,t.ImmediateRenderObject=xi,t.VertexNormalsHelper=bi,t.SpotLightHelper=wi,t.SkeletonHelper=_i,t.PointLightHelper=Mi,t.HemisphereLightHelper=Ei,t.GridHelper=Ti,t.FaceNormalsHelper=Si,t.DirectionalLightHelper=Ai,t.CameraHelper=Ri,t.BoundingBoxHelper=Li,t.BoxHelper=Ci,t.ArrowHelper=Pi,t.AxisHelper=Ii,t.ClosedSplineCurve3=Ui,t.SplineCurve3=ar,t.ArcCurve=Ni,t.EllipseCurve=zn,t.SplineCurve=Hn,t.CubicBezierCurve=Gn,t.QuadraticBezierCurve=kn,t.LineCurve=On,t.Shape=Vn,t.ShapePath=Wn,t.Path=jn,t.Font=Xn,t.CurvePath=Bn,t.Curve=Fn,t.WireframeGeometry=me,t.ParametricGeometry=ge,t.TetrahedronGeometry=ye,t.OctahedronGeometry=xe,t.IcosahedronGeometry=be,t.DodecahedronGeometry=we,t.PolyhedronGeometry=ve,t.TubeGeometry=_e,t.TorusKnotGeometry=Ee,t.TorusKnotBufferGeometry=Me,t.TorusGeometry=Se;t.TorusBufferGeometry=Te;t.TextGeometry=Re,t.SphereBufferGeometry=Le,t.SphereGeometry=Ce,t.RingGeometry=Ie,t.RingBufferGeometry=Pe,t.PlaneBufferGeometry=yt,t.PlaneGeometry=Ue,t.LatheGeometry=De,t.LatheBufferGeometry=Ne,t.ShapeGeometry=Fe,t.ExtrudeGeometry=Ae,t.EdgesGeometry=Oe,t.ConeGeometry=He,t.ConeBufferGeometry=Ge,t.CylinderGeometry=ze,t.CylinderBufferGeometry=Be,t.CircleBufferGeometry=ke,t.CircleGeometry=Ve,t.BoxBufferGeometry=vt,t.BoxGeometry=je,t.ShadowMaterial=We,t.SpriteMaterial=Kt,t.RawShaderMaterial=Xe,t.ShaderMaterial=q,t.PointsMaterial=ce,t.MultiMaterial=qe,t.MeshPhysicalMaterial=Ze,t.MeshStandardMaterial=Ye,t.MeshPhongMaterial=Je,t.MeshNormalMaterial=Qe,t.MeshLambertMaterial=Ke,t.MeshDepthMaterial=Y,t.MeshBasicMaterial=ct,t.LineDashedMaterial=$e,t.LineBasicMaterial=ae,t.Material=X,t.REVISION="81",t.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2},t.CullFaceNone=0,t.CullFaceBack=1,t.CullFaceFront=2,t.CullFaceFrontBack=3,t.FrontFaceDirectionCW=0,t.FrontFaceDirectionCCW=1,t.BasicShadowMap=0,t.PCFShadowMap=1,t.PCFSoftShadowMap=2,t.FrontSide=0,t.BackSide=1,t.DoubleSide=2,t.FlatShading=1,t.SmoothShading=2,t.NoColors=0,t.FaceColors=1,t.VertexColors=2,t.NoBlending=0,t.NormalBlending=1,t.AdditiveBlending=2,t.SubtractiveBlending=3,t.MultiplyBlending=4,t.CustomBlending=5,t.BlendingMode=Di,t.AddEquation=100,t.SubtractEquation=101,t.ReverseSubtractEquation=102,t.MinEquation=103,t.MaxEquation=104,t.ZeroFactor=200,t.OneFactor=201,t.SrcColorFactor=202,t.OneMinusSrcColorFactor=203,t.SrcAlphaFactor=204,t.OneMinusSrcAlphaFactor=205,t.DstAlphaFactor=206,t.OneMinusDstAlphaFactor=207,t.DstColorFactor=208,t.OneMinusDstColorFactor=209,t.SrcAlphaSaturateFactor=210,t.NeverDepth=0,t.AlwaysDepth=1,t.LessDepth=2,t.LessEqualDepth=3,t.EqualDepth=4,t.GreaterEqualDepth=5,t.GreaterDepth=6,t.NotEqualDepth=7,t.MultiplyOperation=0,t.MixOperation=1,t.AddOperation=2,t.NoToneMapping=0,t.LinearToneMapping=1,t.ReinhardToneMapping=2,t.Uncharted2ToneMapping=3,t.CineonToneMapping=4,t.UVMapping=300,t.CubeReflectionMapping=301,t.CubeRefractionMapping=302,t.EquirectangularReflectionMapping=303,t.EquirectangularRefractionMapping=304,t.SphericalReflectionMapping=305,t.CubeUVReflectionMapping=306,t.CubeUVRefractionMapping=307,t.TextureMapping=Fi,t.RepeatWrapping=1e3,t.ClampToEdgeWrapping=1001,t.MirroredRepeatWrapping=1002,t.TextureWrapping=Oi,t.NearestFilter=1003,t.NearestMipMapNearestFilter=1004,t.NearestMipMapLinearFilter=1005,t.LinearFilter=1006,t.LinearMipMapNearestFilter=1007,t.LinearMipMapLinearFilter=1008,t.TextureFilter=Bi,t.UnsignedByteType=1009,t.ByteType=1010,t.ShortType=1011,t.UnsignedShortType=1012,t.IntType=1013,t.UnsignedIntType=1014,t.FloatType=1015,t.HalfFloatType=1016,t.UnsignedShort4444Type=1017,t.UnsignedShort5551Type=1018,t.UnsignedShort565Type=1019,t.UnsignedInt248Type=1020,t.AlphaFormat=1021,t.RGBFormat=1022,t.RGBAFormat=1023,t.LuminanceFormat=1024,t.LuminanceAlphaFormat=1025,t.RGBEFormat=1023,t.DepthFormat=1026,t.DepthStencilFormat=1027,t.RGB_S3TC_DXT1_Format=2001,t.RGBA_S3TC_DXT1_Format=2002,t.RGBA_S3TC_DXT3_Format=2003,t.RGBA_S3TC_DXT5_Format=2004,t.RGB_PVRTC_4BPPV1_Format=2100,t.RGB_PVRTC_2BPPV1_Format=2101,t.RGBA_PVRTC_4BPPV1_Format=2102,t.RGBA_PVRTC_2BPPV1_Format=2103,t.RGB_ETC1_Format=2151,t.LoopOnce=2200,t.LoopRepeat=2201,t.LoopPingPong=2202,t.InterpolateDiscrete=2300,t.InterpolateLinear=2301,t.InterpolateSmooth=2302,t.ZeroCurvatureEnding=2400,t.ZeroSlopeEnding=2401,t.WrapAroundEnding=2402,t.TrianglesDrawMode=0,t.TriangleStripDrawMode=1,t.TriangleFanDrawMode=2,t.LinearEncoding=3e3,t.sRGBEncoding=3001,t.GammaEncoding=3007,t.RGBEEncoding=3002,t.LogLuvEncoding=3003,t.RGBM7Encoding=3004,t.RGBM16Encoding=3005,t.RGBDEncoding=3006,t.BasicDepthPacking=3200,t.RGBADepthPacking=3201,t.CubeGeometry=je,t.Face4=function(t,e,n,i,r,a,o){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new st(t,e,n,r,a,o)},t.LineStrip=0,t.LinePieces=1,t.MeshFaceMaterial=qe,t.PointCloud=function(t,e){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new le(t,e)},t.Particle=$t,t.ParticleSystem=function(t,e){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new le(t,e)},t.PointCloudMaterial=function(t){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new ce(t)},t.ParticleBasicMaterial=function(t){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new ce(t)},t.ParticleSystemMaterial=function(t){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new ce(t)},t.Vertex=function(t,e,n){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new c(t,e,n)},t.EdgesHelper=function(t,e){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new se(new Oe(t.geometry),new ae({color:void 0!==e?e:16777215}))},t.WireframeHelper=function(t,e){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new se(new me(t.geometry),new ae({color:void 0!==e?e:16777215}))},t.GeometryUtils={merge:function(t,e,n){console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead.");var i;e.isMesh&&(e.matrixAutoUpdate&&e.updateMatrix(),i=e.matrix,e=e.geometry),t.merge(e,i,n)},center:function(t){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),t.center()}},t.ImageUtils={crossOrigin:void 0,loadTexture:function(t,e,n,i){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var r=new sn;return r.setCrossOrigin(this.crossOrigin),t=r.load(t,n,void 0,i),e&&(t.mapping=e),t},loadTextureCube:function(t,e,n,i){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var r=new on;return r.setCrossOrigin(this.crossOrigin),t=r.load(t,n,void 0,i),e&&(t.mapping=e),t},loadCompressedTexture:function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},loadCompressedTextureCube:function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")}},t.Projector=function(){console.error("THREE.Projector has been moved to /examples/js/renderers/Projector.js."),this.projectVector=function(t,e){console.warn("THREE.Projector: .projectVector() is now vector.project()."),t.project(e)},this.unprojectVector=function(t,e){console.warn("THREE.Projector: .unprojectVector() is now vector.unproject()."),t.unproject(e)},this.pickingRay=function(t,e){console.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().")}},t.CanvasRenderer=function(){console.error("THREE.CanvasRenderer has been moved to /examples/js/renderers/CanvasRenderer.js"),this.domElement=document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),this.clear=function(){},this.render=function(){},this.setClearColor=function(){},this.setSize=function(){}},Object.defineProperty(t,"__esModule",{value:!0})}),THREE.OBJLoader=function(t){this.manager=void 0!==t?t:THREE.DefaultLoadingManager,this.materials=null,this.regexp={vertex_pattern:/^v\s+([\d|\.|\+|\-|e|E]+)\s+([\d|\.|\+|\-|e|E]+)\s+([\d|\.|\+|\-|e|E]+)/,normal_pattern:/^vn\s+([\d|\.|\+|\-|e|E]+)\s+([\d|\.|\+|\-|e|E]+)\s+([\d|\.|\+|\-|e|E]+)/,uv_pattern:/^vt\s+([\d|\.|\+|\-|e|E]+)\s+([\d|\.|\+|\-|e|E]+)/,face_vertex:/^f\s+(-?\d+)\s+(-?\d+)\s+(-?\d+)(?:\s+(-?\d+))?/,face_vertex_uv:/^f\s+(-?\d+)\/(-?\d+)\s+(-?\d+)\/(-?\d+)\s+(-?\d+)\/(-?\d+)(?:\s+(-?\d+)\/(-?\d+))?/,face_vertex_uv_normal:/^f\s+(-?\d+)\/(-?\d+)\/(-?\d+)\s+(-?\d+)\/(-?\d+)\/(-?\d+)\s+(-?\d+)\/(-?\d+)\/(-?\d+)(?:\s+(-?\d+)\/(-?\d+)\/(-?\d+))?/,face_vertex_normal:/^f\s+(-?\d+)\/\/(-?\d+)\s+(-?\d+)\/\/(-?\d+)\s+(-?\d+)\/\/(-?\d+)(?:\s+(-?\d+)\/\/(-?\d+))?/,object_pattern:/^[og]\s*(.+)?/,smoothing_pattern:/^s\s+(\d+|on|off)/,material_library_pattern:/^mtllib /,material_use_pattern:/^usemtl /}},THREE.OBJLoader.prototype={constructor:THREE.OBJLoader,load:function(t,e,n,i){var r=this,a=new THREE.XHRLoader(r.manager);a.setPath(this.path),a.load(t,function(t){e(r.parse(t))},n,i)},setPath:function(t){this.path=t},setMaterials:function(t){this.materials=t},_createParserState:function(){var t={objects:[],object:{},vertices:[],normals:[],uvs:[],materialLibraries:[],startObject:function(t,e){if(this.object&&this.object.fromDeclaration===!1)return this.object.name=t,void(this.object.fromDeclaration=e!==!1);var n=this.object&&"function"==typeof this.object.currentMaterial?this.object.currentMaterial():void 0;if(this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0),this.object={name:t||"",fromDeclaration:e!==!1,geometry:{vertices:[],normals:[],uvs:[]},materials:[],smooth:!0,startMaterial:function(t,e){var n=this._finalize(!1);n&&(n.inherited||n.groupCount<=0)&&this.materials.splice(n.index,1);var i={index:this.materials.length,name:t||"",mtllib:Array.isArray(e)&&e.length>0?e[e.length-1]:"",smooth:void 0!==n?n.smooth:this.smooth,groupStart:void 0!==n?n.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(t){var e={index:"number"==typeof t?t:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return e.clone=this.clone.bind(e),e}};return this.materials.push(i),i},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(t){var e=this.currentMaterial();if(e&&e.groupEnd===-1&&(e.groupEnd=this.geometry.vertices.length/3,e.groupCount=e.groupEnd-e.groupStart,e.inherited=!1),t&&this.materials.length>1)for(var n=this.materials.length-1;n>=0;n--)this.materials[n].groupCount<=0&&this.materials.splice(n,1);return t&&0===this.materials.length&&this.materials.push({name:"",smooth:this.smooth}),e}},n&&n.name&&"function"==typeof n.clone){var i=n.clone(0);i.inherited=!0,this.object.materials.push(i)}this.objects.push(this.object)},finalize:function(){this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0)},parseVertexIndex:function(t,e){var n=parseInt(t,10);return 3*(n>=0?n-1:n+e/3)},parseNormalIndex:function(t,e){var n=parseInt(t,10);return 3*(n>=0?n-1:n+e/3)},parseUVIndex:function(t,e){var n=parseInt(t,10);return 2*(n>=0?n-1:n+e/2)},addVertex:function(t,e,n){var i=this.vertices,r=this.object.geometry.vertices;r.push(i[t+0]),r.push(i[t+1]),r.push(i[t+2]),r.push(i[e+0]),r.push(i[e+1]),r.push(i[e+2]),r.push(i[n+0]),r.push(i[n+1]),r.push(i[n+2])},addVertexLine:function(t){var e=this.vertices,n=this.object.geometry.vertices;n.push(e[t+0]),n.push(e[t+1]),n.push(e[t+2])},addNormal:function(t,e,n){var i=this.normals,r=this.object.geometry.normals;r.push(i[t+0]),r.push(i[t+1]),r.push(i[t+2]),r.push(i[e+0]),r.push(i[e+1]),r.push(i[e+2]),r.push(i[n+0]),r.push(i[n+1]),r.push(i[n+2])},addUV:function(t,e,n){var i=this.uvs,r=this.object.geometry.uvs;r.push(i[t+0]),r.push(i[t+1]),r.push(i[e+0]),r.push(i[e+1]),r.push(i[n+0]),r.push(i[n+1])},addUVLine:function(t){var e=this.uvs,n=this.object.geometry.uvs;n.push(e[t+0]),n.push(e[t+1])},addFace:function(t,e,n,i,r,a,o,s,c,l,h,u){var d,p=this.vertices.length,f=this.parseVertexIndex(t,p),m=this.parseVertexIndex(e,p),g=this.parseVertexIndex(n,p);if(void 0===i?this.addVertex(f,m,g):(d=this.parseVertexIndex(i,p),this.addVertex(f,m,d),this.addVertex(m,g,d)),void 0!==r){var v=this.uvs.length;f=this.parseUVIndex(r,v),m=this.parseUVIndex(a,v),g=this.parseUVIndex(o,v),void 0===i?this.addUV(f,m,g):(d=this.parseUVIndex(s,v),this.addUV(f,m,d),this.addUV(m,g,d))}if(void 0!==c){var y=this.normals.length;f=this.parseNormalIndex(c,y),m=c===l?f:this.parseNormalIndex(l,y),g=c===h?f:this.parseNormalIndex(h,y),void 0===i?this.addNormal(f,m,g):(d=this.parseNormalIndex(u,y),this.addNormal(f,m,d),this.addNormal(m,g,d))}},addLineGeometry:function(t,e){this.object.geometry.type="Line";for(var n=this.vertices.length,i=this.uvs.length,r=0,a=t.length;r<a;r++)this.addVertexLine(this.parseVertexIndex(t[r],n));for(var o=0,a=e.length;o<a;o++)this.addUVLine(this.parseUVIndex(e[o],i))}};return t.startObject("",!1),t},parse:function(t){console.time("OBJLoader");var e=this._createParserState();t.indexOf("\r\n")!==-1&&(t=t.replace(/\r\n/g,"\n")),t.indexOf("\\\n")!==-1&&(t=t.replace(/\\\n/g,""));for(var n=t.split("\n"),i="",r="",a="",o=0,s=[],c="function"==typeof"".trimLeft,l=0,h=n.length;l<h;l++)if(i=n[l],i=c?i.trimLeft():i.trim(),o=i.length,0!==o&&(r=i.charAt(0),"#"!==r))if("v"===r)if(a=i.charAt(1)," "===a&&null!==(s=this.regexp.vertex_pattern.exec(i)))e.vertices.push(parseFloat(s[1]),parseFloat(s[2]),parseFloat(s[3]));else if("n"===a&&null!==(s=this.regexp.normal_pattern.exec(i)))e.normals.push(parseFloat(s[1]),parseFloat(s[2]),parseFloat(s[3]));else{if("t"!==a||null===(s=this.regexp.uv_pattern.exec(i)))throw new Error("Unexpected vertex/normal/uv line: '"+i+"'");e.uvs.push(parseFloat(s[1]),parseFloat(s[2]))}else if("f"===r)if(null!==(s=this.regexp.face_vertex_uv_normal.exec(i)))e.addFace(s[1],s[4],s[7],s[10],s[2],s[5],s[8],s[11],s[3],s[6],s[9],s[12]);else if(null!==(s=this.regexp.face_vertex_uv.exec(i)))e.addFace(s[1],s[3],s[5],s[7],s[2],s[4],s[6],s[8]);else if(null!==(s=this.regexp.face_vertex_normal.exec(i)))e.addFace(s[1],s[3],s[5],s[7],void 0,void 0,void 0,void 0,s[2],s[4],s[6],s[8]);else{if(null===(s=this.regexp.face_vertex.exec(i)))throw new Error("Unexpected face line: '"+i+"'");e.addFace(s[1],s[2],s[3],s[4])}else if("l"===r){var u=i.substring(1).trim().split(" "),d=[],p=[];if(i.indexOf("/")===-1)d=u;else for(var f=0,m=u.length;f<m;f++){var g=u[f].split("/");""!==g[0]&&d.push(g[0]),""!==g[1]&&p.push(g[1])}e.addLineGeometry(d,p)}else if(null!==(s=this.regexp.object_pattern.exec(i))){var v=(" "+s[0].substr(1).trim()).substr(1);e.startObject(v)}else if(this.regexp.material_use_pattern.test(i))e.object.startMaterial(i.substring(7).trim(),e.materialLibraries);else if(this.regexp.material_library_pattern.test(i))e.materialLibraries.push(i.substring(7).trim());else{if(null===(s=this.regexp.smoothing_pattern.exec(i))){if("\0"===i)continue;throw new Error("Unexpected line: '"+i+"'")}var y=s[1].trim().toLowerCase();e.object.smooth="1"===y||"on"===y;var x=e.object.currentMaterial();x&&(x.smooth=e.object.smooth)}e.finalize();var b=new THREE.Group;b.materialLibraries=[].concat(e.materialLibraries);for(var l=0,h=e.objects.length;l<h;l++){var w=e.objects[l],_=w.geometry,M=w.materials,E="Line"===_.type;if(0!==_.vertices.length){var T=new THREE.BufferGeometry;T.addAttribute("position",new THREE.BufferAttribute(new Float32Array(_.vertices),3)),_.normals.length>0?T.addAttribute("normal",new THREE.BufferAttribute(new Float32Array(_.normals),3)):T.computeVertexNormals(),_.uvs.length>0&&T.addAttribute("uv",new THREE.BufferAttribute(new Float32Array(_.uvs),2));for(var S=[],A=0,R=M.length;A<R;A++){var L=M[A],x=void 0;if(null!==this.materials&&(x=this.materials.create(L.name),E&&x&&!(x instanceof THREE.LineBasicMaterial))){var C=new THREE.LineBasicMaterial;C.copy(x),x=C}x||(x=E?new THREE.LineBasicMaterial:new THREE.MeshPhongMaterial,x.name=L.name),x.shading=L.smooth?THREE.SmoothShading:THREE.FlatShading,S.push(x)}var P;if(S.length>1){for(var A=0,R=M.length;A<R;A++){var L=M[A];T.addGroup(L.groupStart,L.groupCount,A)}var I=new THREE.MultiMaterial(S);P=E?new THREE.LineSegments(T,I):new THREE.Mesh(T,I)}else P=E?new THREE.LineSegments(T,S[0]):new THREE.Mesh(T,S[0]);P.name=w.name,b.add(P)}}return console.timeEnd("OBJLoader"),b}},THREE.ShaderLib.water={uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.fog,{normalSampler:{type:"t",value:null},mirrorSampler:{type:"t",value:null},alpha:{type:"f",value:1},time:{type:"f",value:0},distortionScale:{type:"f",value:120},noiseScale:{type:"f",value:1},textureMatrix:{type:"m4",value:new THREE.Matrix4},sunColor:{type:"c",value:new THREE.Color(8355711)},sunDirection:{type:"v3",value:new THREE.Vector3(.70707,.70707,0)},eye:{type:"v3",value:new THREE.Vector3(0,0,0)},waterColor:{type:"c",value:new THREE.Color(5592405)}}]),vertexShader:["uniform mat4 textureMatrix;","uniform float time;","varying vec4 mirrorCoord;","varying vec3 worldPosition;","varying vec3 modelPosition;","varying vec3 surfaceX;","varying vec3 surfaceY;","varying vec3 surfaceZ;","void main()","{","  mirrorCoord = modelMatrix * vec4(position, 1.0);","  worldPosition = mirrorCoord.xyz;","  modelPosition = position;","  surfaceX = vec3( modelMatrix[0][0], modelMatrix[0][1], modelMatrix[0][2]);","  surfaceY = vec3( modelMatrix[1][0], modelMatrix[1][1], modelMatrix[1][2]);","  surfaceZ = vec3( modelMatrix[2][0], modelMatrix[2][1], modelMatrix[2][2]);","  mirrorCoord = textureMatrix * mirrorCoord;","  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","}"].join("\n"),fragmentShader:["uniform sampler2D mirrorSampler;","uniform float alpha;","uniform float time;","uniform float distortionScale;","uniform float noiseScale;","uniform sampler2D normalSampler;","uniform vec3 sunColor;","uniform vec3 sunDirection;","uniform vec3 eye;","uniform vec3 waterColor;","varying vec4 mirrorCoord;","varying vec3 worldPosition;","varying vec3 modelPosition;","varying vec3 surfaceX;","varying vec3 surfaceY;","varying vec3 surfaceZ;","void sunLight(const vec3 surfaceNormal, const vec3 eyeDirection, in float shiny, in float spec, in float diffuse, inout vec3 diffuseColor, inout vec3 specularColor)","{","  vec3 reflection = normalize(reflect(-sunDirection, surfaceNormal));","  float direction = max(0.0, dot(eyeDirection, reflection));","  specularColor += pow(direction, shiny) * sunColor * spec;","  diffuseColor += max(dot(sunDirection, surfaceNormal), 0.0) * sunColor * diffuse;","}","vec3 getNoise(in vec2 uv)","{","  vec2 uv0 = uv / (103.0 * noiseScale) + vec2(time / 17.0, time / 29.0);","  vec2 uv1 = uv / (107.0 * noiseScale) - vec2(time / -19.0, time / 31.0);","  vec2 uv2 = uv / (vec2(8907.0, 9803.0) * noiseScale) + vec2(time / 101.0, time /   97.0);","  vec2 uv3 = uv / (vec2(1091.0, 1027.0) * noiseScale) - vec2(time / 109.0, time / -113.0);","  vec4 noise = texture2D(normalSampler, uv0) +","    texture2D(normalSampler, uv1) +","    texture2D(normalSampler, uv2) +","    texture2D(normalSampler, uv3);","  return noise.xyz * 0.5 - 1.0;","}",THREE.ShaderChunk.common,THREE.ShaderChunk.fog_pars_fragment,"void main()","{","  vec3 worldToEye = eye - worldPosition;","  vec3 eyeDirection = normalize(worldToEye);","  vec3 noise = getNoise(modelPosition.xy * 1.0);","  vec3 distordCoord = noise.x * surfaceX + noise.y * surfaceY;","  vec3 distordNormal = distordCoord + surfaceZ;","  if(dot(eyeDirection, surfaceZ) < 0.0)","    distordNormal = distordNormal * -1.0;","  vec3 diffuseLight = vec3(0.0);","  vec3 specularLight = vec3(0.0);","  sunLight(distordNormal, eyeDirection, 100.0, 2.0, 0.5, diffuseLight, specularLight);","  float distance = length(worldToEye);","  vec2 distortion = distordCoord.xy * distortionScale * sqrt(distance) * 0.07;"," vec3 mirrorDistord = mirrorCoord.xyz + vec3(distortion.x, distortion.y, 1.0);"," vec3 reflectionSample = texture2DProj(mirrorSampler, mirrorDistord).xyz;","  float theta = max(dot(eyeDirection, distordNormal), 0.0);","  float reflectance = 0.3 + (1.0 - 0.3) * pow((1.0 - theta), 3.0);","  vec3 scatter = max(0.0, dot(distordNormal, eyeDirection)) * waterColor;","  vec3 albedo = mix(sunColor * diffuseLight * 0.3 + scatter, (vec3(0.1) + reflectionSample * 0.9 + reflectionSample * specularLight), reflectance);"," vec3 outgoingLight = albedo;",THREE.ShaderChunk.fog_fragment," gl_FragColor = vec4( outgoingLight, alpha );","}"].join("\n")},THREE.Water=function(t,e,n,i){function r(t,e){return void 0!==t?t:e}THREE.Object3D.call(this),this.name="water_"+this.id,i=i||{},this.matrixNeedsUpdate=!0;var a=r(i.textureWidth,512),o=r(i.textureHeight,512);this.clipBias=r(i.clipBias,-1e-4),this.alpha=r(i.alpha,1),this.time=r(i.time,0),this.normalSampler=r(i.waterNormals,null),this.sunDirection=r(i.sunDirection,new THREE.Vector3(.70707,.70707,0)),this.sunColor=new THREE.Color(r(i.sunColor,16777215)),this.waterColor=new THREE.Color(r(i.waterColor,8355711)),this.eye=r(i.eye,new THREE.Vector3(0,0,0)),this.distortionScale=r(i.distortionScale,50),this.noiseScale=r(i.noiseScale,1),this.side=r(i.side,THREE.FrontSide),this.fog=r(i.fog,!1),this.renderer=t,this.scene=n,this.mirrorPlane=new THREE.Plane,this.normal=new THREE.Vector3(0,0,1),this.cameraWorldPosition=new THREE.Vector3,this.rotationMatrix=new THREE.Matrix4,this.lookAtPosition=new THREE.Vector3(0,0,(-1)),this.clipPlane=new THREE.Vector4,e instanceof THREE.PerspectiveCamera?this.camera=e:(this.camera=new THREE.PerspectiveCamera,console.log(this.name+": camera is not a Perspective Camera!")),this.textureMatrix=new THREE.Matrix4,this.mirrorCamera=this.camera.clone(),this.texture=new THREE.WebGLRenderTarget(a,o),this.tempTexture=new THREE.WebGLRenderTarget(a,o);var s=THREE.ShaderLib.water,c=THREE.UniformsUtils.clone(s.uniforms);this.material=new THREE.ShaderMaterial({fragmentShader:s.fragmentShader,vertexShader:s.vertexShader,uniforms:c,transparent:!0,side:this.side,fog:this.fog}),this.mesh=new THREE.Object3D,this.material.uniforms.mirrorSampler.value=this.texture,this.material.uniforms.textureMatrix.value=this.textureMatrix,this.material.uniforms.alpha.value=this.alpha,this.material.uniforms.time.value=this.time,this.material.uniforms.normalSampler.value=this.normalSampler,this.material.uniforms.sunColor.value=this.sunColor,
this.material.uniforms.waterColor.value=this.waterColor,this.material.uniforms.sunDirection.value=this.sunDirection,this.material.uniforms.distortionScale.value=this.distortionScale,this.material.uniforms.noiseScale.value=this.noiseScale,this.material.uniforms.eye.value=this.eye,THREE.Math.isPowerOfTwo(a)&&THREE.Math.isPowerOfTwo(o)||(this.texture.generateMipmaps=!1,this.tempTexture.generateMipmaps=!1)},THREE.Water.prototype=Object.create(THREE.Object3D.prototype),THREE.Water.prototype.renderWithMirror=function(t){this.updateTextureMatrix(),this.matrixNeedsUpdate=!1;var e=t.camera;t.camera=this.mirrorCamera,t.render(!0),this.render(),this.matrixNeedsUpdate=!0,t.camera=e,t.updateTextureMatrix()},THREE.Water.prototype.updateTextureMatrix=function(){function t(t){return t?t<0?-1:1:0}void 0!==this.parent&&(this.mesh=this.parent),this.updateMatrixWorld(),this.camera.updateMatrixWorld(),this.cameraWorldPosition.setFromMatrixPosition(this.camera.matrixWorld),this.rotationMatrix.extractRotation(this.matrixWorld),this.normal=new THREE.Vector3(0,0,1).applyEuler(this.mesh.rotation);var e=this.camera.position.clone().sub(this.mesh.position);if(this.normal.dot(e)<0){var n=new THREE.Vector3(0,0,1).applyEuler(this.mesh.rotation);this.normal.reflect(n)}var i=this.mesh.position.clone().sub(this.cameraWorldPosition);i.reflect(this.normal).negate(),i.add(this.mesh.position),this.rotationMatrix.extractRotation(this.camera.matrixWorld),this.lookAtPosition.set(0,0,-1),this.lookAtPosition.applyMatrix4(this.rotationMatrix),this.lookAtPosition.add(this.cameraWorldPosition);var r=this.mesh.position.clone().sub(this.lookAtPosition);r.reflect(this.normal).negate(),r.add(this.mesh.position),this.up.set(0,-1,0),this.up.applyMatrix4(this.rotationMatrix),this.up.reflect(this.normal).negate(),this.mirrorCamera.position.copy(i),this.mirrorCamera.up=this.up,this.mirrorCamera.lookAt(r),this.mirrorCamera.aspect=this.camera.aspect,this.mirrorCamera.updateProjectionMatrix(),this.mirrorCamera.updateMatrixWorld(),this.mirrorCamera.matrixWorldInverse.getInverse(this.mirrorCamera.matrixWorld),this.textureMatrix.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),this.textureMatrix.multiply(this.mirrorCamera.projectionMatrix),this.textureMatrix.multiply(this.mirrorCamera.matrixWorldInverse),this.mirrorPlane.setFromNormalAndCoplanarPoint(this.normal,this.mesh.position),this.mirrorPlane.applyMatrix4(this.mirrorCamera.matrixWorldInverse),this.clipPlane.set(this.mirrorPlane.normal.x,this.mirrorPlane.normal.y,this.mirrorPlane.normal.z,this.mirrorPlane.constant);var a=new THREE.Vector4,o=this.mirrorCamera.projectionMatrix;a.x=(t(this.clipPlane.x)+o.elements[8])/o.elements[0],a.y=(t(this.clipPlane.y)+o.elements[9])/o.elements[5],a.z=-1,a.w=(1+o.elements[10])/o.elements[14];var s=new THREE.Vector4;s=this.clipPlane.multiplyScalar(2/this.clipPlane.dot(a)),o.elements[2]=s.x,o.elements[6]=s.y,o.elements[10]=s.z+1-this.clipBias,o.elements[14]=s.w;var c=new THREE.Vector3;c.setFromMatrixPosition(this.camera.matrixWorld),this.eye=c,this.material.uniforms.eye.value=this.eye},THREE.Water.prototype.render=function(t){if(this.matrixNeedsUpdate&&this.updateTextureMatrix(),this.matrixNeedsUpdate=!0,void 0!==this.scene&&this.scene instanceof THREE.Scene){this.material.visible=!1;var e=void 0!==t&&t?this.tempTexture:this.texture;this.renderer.render(this.scene,this.mirrorCamera,e,!0),this.material.visible=!0,this.material.uniforms.mirrorSampler.value=e}},"undefined"==typeof requestAnimationFrame&&(requestAnimationFrame="undefined"!=typeof window&&(window.msRequestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.oRequestAnimationFrame)||function(t){return setTimeout(t,17)}),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.timer={})}(this,function(t){"use strict";function e(){h=u=0,d=1/0,n(o())}function n(t){if(!h){var n=t-Date.now();n>24?d>t&&(u&&clearTimeout(u),u=setTimeout(e,n),d=t):(u&&(u=clearTimeout(u),d=1/0),h=requestAnimationFrame(e))}}function i(t,e){this.callback=t,this.time=e,this.flush=!1,this.next=null}function r(t,e,r){r=null==r?Date.now():+r,null!=e&&(r+=+e);var a=new i(t,r);c?c.next=a:s=a,c=a,n(r)}function a(t,e,n){n=null==n?Date.now():+n,null!=e&&(n+=+e),l.callback=t,l.time=n}function o(t){t=null==t?Date.now():+t;var e=l;for(l=s;l;)t>=l.time&&(l.flush=l.callback(t-l.time,t)),l=l.next;l=e,t=1/0;for(var n,i=s;i;)i.flush?i=n?n.next=i.next:s=i.next:(i.time<t&&(t=i.time),i=(n=i).next);return c=n,t}var s,c,l,h,u,d=1/0;t.timer=r,t.timerReplace=a,t.timerFlush=o}),window.setTimeout(function(){document.body.classList.add("loaded")},1e3),document.getElementById("load").addEventListener("click",function(){document.body.classList.toggle("loaded")});for(var str=document.querySelector(".text").innerHTML,i=0;i<str.length;i++){var span=document.createElement("span");span.textContent=str[i],document.getElementById("title").appendChild(span);var delay=.15*i+4;span.style.transition="transform 0.3s ease-out "+delay+"s"}for(var strokes=document.querySelectorAll(".page-container#homepage-0 .st0"),i=0;i<strokes.length;i++){var width=1+Math.random();strokes[i].style.strokeWidth=width}var wHeight=window.innerHeight||document.documentElement.clientHeight||document.getElementsByTagName("body")[0].clientHeight,activePage="home",menuImg=document.getElementById("menu-img");s6=[1e3,0,1e3,750,0,750,0,700,0,510,0,410,0,0,1e3,0],s5=[1e3,0,1e3,750,73,750,92,636,20,452,0,322,0,0,1e3,0],s4=[1e3,0,1e3,750,309,750,233,527,83,265,82,263,125,0,1e3,0],s3=[1e3,0,1e3,750,500,750,354,588,301,263,281,220,150,0,1e3,0],s2=[1e3,52,1e3,750,659,698,500,497,569,375,635,116,700,50,1e3,22],s1=[1e3,52,1e3,750,856,544,692,497,765,252,796,122,900,100,1e3,52],s0=[1e3,300,1e3,480,976,435,957,375,970,330,980,320,990,310,1e3,300];var sInit=Snap("#menu-icon");sInit.attr({viewBox:"0 0 70 180"});var menuPoly=sInit.polygon([70,0,70,180,26,135,7,75,30,30]).attr({fill:"#333"}),burger1=sInit.polyline([20,70,60,70]).attr({stroke:"white",strokeWidth:2}),burger2=sInit.polyline([25,90,50,90]).attr({stroke:"white",strokeWidth:2}),burger3=sInit.polyline([30,110,55,110]).attr({stroke:"white",strokeWidth:2}),s=Snap("#menu");s.attr({preserveAspectRatio:"none",viewBox:"0 0 1000 750"});var paper=Snap(200,200),poly=s.polygon(s0).attr({fill:"#333"}),type=mina.linear,dur=140,frames=[{animation:{points:s0},dur:dur},{animation:{points:s1},dur:dur},{animation:{points:s2},dur:dur},{animation:{points:s3},dur:dur},{animation:{points:s4},dur:dur},{animation:{points:s5},dur:dur},{animation:{points:s6},dur:dur}];document.getElementById("menu-icon").addEventListener("click",function(){menuInProgress(!0),nextFrame(poly,frames,0),setTimeout(function(){menuInProgress(!1)},10*dur)}),document.getElementById("menu-container-close").addEventListener("click",function(){menuInProgress(!0),lastFrame(poly,frames,5),activateMenuItems(),setTimeout(function(){menuInProgress(!1)},10*dur)});for(var menuItems=document.querySelectorAll("#menu-list li a"),i=0;i<menuItems.length;i++)menuItems[i].addEventListener("click",onMenuPress);window.addEventListener("resize",function(){wHeight=window.innerHeight||document.documentElement.clientHeight||document.getElementsByTagName("body")[0].clientHeight});var homepageScroller=document.getElementById("homepage-scroller"),homepage=0,homepageCount=4,homepageNext=document.getElementById("homepage-next"),homepagePrev=document.getElementById("homepage-prev");homepageNext.addEventListener("click",function(t){t.preventDefault(),0==homepage&&(console.log("float"),floatAway()),homepage<homepageCount-1&&(homepage++,gotoHomepage(homepage))}),homepagePrev.addEventListener("click",function(t){t.preventDefault(),homepage>0&&(homepage--,gotoHomepage(homepage))}),setHomepageControls(homepage);var blimpContainer,cameraBlimp,sceneBlimp,rendererBlimp,animation=null,now,blimpMouseX=0,blimpMouseY=0,windowHalfX=window.innerWidth/2,windowHalfY=window.innerHeight/2,root;initBlimp(),geoJelly("rgba(255,255,255,0.5)","rgba(255,255,255,0.5)","#gallery-canvas");var slider=document.getElementById("slider"),slides=document.querySelectorAll(".slide"),currentSlide=0,selectedSlide=0,slideCount=slides.length;console.log("slideCount: "+slideCount);for(var nav=document.querySelectorAll(".nav"),i=0;i<nav.length;i++)nav[i].addEventListener("click",onNavPress);window.addEventListener("mousewheel",function(t){onMouseWheel(t)}),window.addEventListener("DOMMouseScroll",function(t){onMouseWheel(t)});var onMouseWheel=debounce(function(t){t=t?t:window.e;var e=t.detail?t.detail:t.wheelDelta;e>50&currentSlide>1?prevSlide():e<-50&currentSlide<slideCount&&nextSlide()},20);setNavControls(currentSlide||selectedSlide),document.querySelector(".gallery-container-toggle").addEventListener("click",function(t){toggleGallery(!1)});var container,camera,scene,renderer,clock=new THREE.Clock,mouseX=0,mouseY=0,windowHalfX=window.innerWidth/2,windowHalfY=window.innerHeight/2,points,uniforms,colors,positions,sizes,geometry1,cloudTexture,logoTexture,landAlpha,waterNormals,biplaneObj,blimp,ship,rocks,biplanes=[],texts=[],banners=[],lines=[],ships=[],galleryNames=["Grahamortho","Black Cordon Vineyards","another site","another site","another site","another site"],targetList=[],outlineList=[],raycaster,intersects=[],mouse,INTERSECTED,postprocessing={},postprocess=!1,galleryCount=6,font,loadedItems=0;!function(){load()}();var u="guestn",p="zl1381newbie",a="nicholas.guest@gmail.com",s="subject line",b="this is a test",f="nicholas.guest@gmail.com",str="api_user="+u+"&api_key="+p+"&to="+a+"&toname=Destination&subject="+a+"&text="+b+"&from="+f,sendButton=document.getElementById("send");